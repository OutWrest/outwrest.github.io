<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><link rel="preload" as="image" href="/avatar.png" fetchpriority="high"/><title>Exploring Adversarial Attacks on Convolutional Neural Networks - Part 1 - Outwrest</title><meta name="og:url" content="https://outw.rest"/><meta property="og:title" content="Exploring Adversarial Attacks on Convolutional Neural Networks - Part 1"/><meta name="description" content="Digging into simple CNN adversarial attacks shown in DiceCTF 2024 &amp; osu!gaming CTF 2024"/><meta name="og:description" content="Digging into simple CNN adversarial attacks shown in DiceCTF 2024 &amp; osu!gaming CTF 2024"/><meta property="og:image" content="https://outw.rest/og-image.png"/><meta name="next-head-count" content="9"/><link rel="preload" href="/_next/static/css/1cf999664b3a31e8.css" as="style"/><link rel="stylesheet" href="/_next/static/css/1cf999664b3a31e8.css" data-n-g=""/><link rel="preload" href="/_next/static/css/f2c285b6c43f087a.css" as="style"/><link rel="stylesheet" href="/_next/static/css/f2c285b6c43f087a.css" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script src="/_next/static/chunks/webpack-8fa1640cc84ba8fe.js" defer=""></script><script src="/_next/static/chunks/framework-2c79e2a64abdb08b.js" defer=""></script><script src="/_next/static/chunks/main-024cd5df6c702c6c.js" defer=""></script><script src="/_next/static/chunks/pages/_app-43f8f20d4439bbad.js" defer=""></script><script src="/_next/static/chunks/757-717bffe140b377ff.js" defer=""></script><script src="/_next/static/chunks/pages/posts/%5Bslug%5D-b4a15cb976cf18c1.js" defer=""></script><script src="/_next/static/K08MmqNKSNWSYTMvGcjzF/_buildManifest.js" defer=""></script><script src="/_next/static/K08MmqNKSNWSYTMvGcjzF/_ssgManifest.js" defer=""></script></head><body class="bg-gray-50 text-gray-800 dark:bg-gray-900 dark:text-gray-50"><div id="__next"><script>!function(){try{var d=document.documentElement,c=d.classList;c.remove('light','dark');var e=localStorage.getItem('theme');if('system'===e||(!e&&true)){var t='(prefers-color-scheme: dark)',m=window.matchMedia(t);if(m.media!==t||m.matches){d.style.colorScheme = 'dark';c.add('dark')}else{d.style.colorScheme = 'light';c.add('light')}}else if(e){c.add(e|| '')}if(e==='light'||e==='dark')d.style.colorScheme=e}catch(e){}}()</script><a href="#main" class="fixed p-2 top-0 left-0 -translate-y-full focus:translate-y-0">Skip to main content</a><div class="flex flex-col max-w-5xl mx-auto min-h-full px-4"><header class="py-8 flex justify-between items-center"><a class="font-bold" href="/"><span class="flex"><img alt="Outwrest" fetchpriority="high" width="48" height="48" decoding="async" data-nimg="1" class="rounded-md" style="color:transparent" src="/avatar.png"/></span></a><nav><ul class="flex space-x-8"><li><a class="text-gray-500 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-300" href="/posts">Posts</a></li><li><a class="text-gray-500 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-300" href="/about">About</a></li></ul></nav></header><main id="main"><header class="mb-8 pb-8 border-b border-gray-200 dark:border-gray-700"><time class="block mb-2 text-gray-500 dark:text-gray-400">July 13, 2024</time><h1 class="font-bold text-3xl">Exploring Adversarial Attacks on Convolutional Neural Networks - Part 1</h1><div class="mt-4"><div class="max-w-none prose prose-a:text-pink-600 dark:prose-invert"><p>Digging into simple CNN adversarial attacks shown in DiceCTF 2024 &amp; osu!gaming CTF 2024</p></div></div></header><div class="max-w-none prose prose-a:text-pink-600 dark:prose-invert"><div class="lead"><p>I want to be clear, I am not an expert, in either cybersecurity or data science.
I am interested in both fields so it becomes very fun exploring the intersection.</p><p>If you just want the code, <a target="_blank" rel="noopener noreferrer" href="https://github.com/OutWrest/blog-handouts/tree/main/exploring-attacks-1">click here</a>.</p></div>
<h1>Overview</h1>
<ul>
<li>Introduction</li>
<li><a href="#What%20Are%20Adversarial%20Attacks?">What Are Adversarial Attacks</a></li>
<li>Applying to recent CTF challenges</li>
<li>Conclusion</li>
</ul>
<h1>Introduction</h1>
<p>Adversarial attacks are not new, but they are not a usual category in CTF competitions.
With the past year or so, I started seeing more competitions including data science related challenges.
I want some spend time to explore some adversarial methods and apply them in examples that are easy to translate for competitions.</p>
<p>Before diving into the main topic, I want to mention that I will assume some understanding of machine learning basics.
<em>Maybe in the future</em> I can further explore these basics to build a ground-up understanding.</p>
<p>In this article we will explore white-box model adversarial image attacks and try minimize the difference between the pixels on initial image and the adversarial examples we will create.</p>
<h1>What are Adversarial Attacks?</h1>
<p>In machine learning, adversarial attacks are techiques that aim to deceive or compromoise an AI system.
The techiques can include different types of attacks that specially manipluate the system&#x27;s input, training data or even the inner workings of the model itself.
I will focus on the most on attacks that manipluate the AI system&#x27;s input to get it to an unintended output.
Though you can explore more about adversarial attacks <a target="_blank" rel="noopener noreferrer" href="https://en.wikipedia.org/wiki/Adversarial_machine_learning">here</a>.</p>
<p>No model is perfect. Machine learning tries to estimate output signals from the training data that is given to it.
Models predict an outcome, and in most settings, they usually do a pretty good job at it.
There are always inaccuracies but they can accumulate from the dataset, training methods/architecture or they are inherit to the problem itself.</p>
<p>With convolutional neural networks, especially for image-related problems, a model can become good at identifying shapes &amp; edges for classification.
Modern image models rely on many parameters (on the smaller end, resnet18 has ~11m parameters) and current research tries to apply these models to bigger and bigger problems.</p>
<p>Exploring adversarial attacks unveils the vulnerability of these seemingly robust models.
Despite their sophistication, they can be targeted to produce specific output with a specially crafted input.
In this article, we will go through several popular types of attacks and apply our learning to challenges from recent cybersecurity CTF competitions.</p>
<h1>Lets try it out</h1>
<p>Let&#x27;s consider the scenario of generating an adversarial example for an ImageNet-trained ResNet18 model.
We will try out some different methods to generate adversarial examples starting from an initial image <code class="language-math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord mathnormal">x</span></span></span></span></code>.</p>
<div class="flex items-center justify-center flex-col"><img class="block" src="/post-assets/exploring-attacks-1/init-imgs.png" alt="Three examples of model input to ResNet18 Model, an all white image, an all black image, and noise image"/><p class="mr-4 subtext" style="font-size:0.75rem">ImageNet-trained ResNet18 model&#x27;s output probabilities for a white, black and nosie image.</p></div>
<p>In all three of the solutions, I will only focus on the following cost function that optimizes for the cross-entropy loss over a specific target, <code class="language-math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>y</mi><mtext>target</mtext></msub></mrow><annotation encoding="application/x-tex">y_{\text{target}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7167em;vertical-align:-0.2861em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">target</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em"><span></span></span></span></span></span></span></span></span></span></code>.</p>
<div class="flex items-center justify-center"><div class="flex items-center justify-center rounded-md p-4 border w-11/12 not-prose border-0"><p><code class="language-math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="script">L</mi><mtext>targeted</mtext></msub><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><msub><mi>y</mi><mtext>target</mtext></msub><mo stretchy="false">)</mo><mo>=</mo><mtext>CE</mtext><mo stretchy="false">(</mo><msub><mi>y</mi><mtext>target</mtext></msub><mo separator="true">,</mo><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\mathcal{L}_{\text{targeted}}(x, y_{\text{target}}) = \text{CE}(y_{\text{target}}, f(x))</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0361em;vertical-align:-0.2861em"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">targeted</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">target</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1.0361em;vertical-align:-0.2861em"></span><span class="mord text"><span class="mord">CE</span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">target</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord mathnormal" style="margin-right:0.10764em">f</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">))</span></span></span></span></code></p></div></div>
<p>Where:</p>
<ul>
<li><code class="language-math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord mathnormal">x</span></span></span></span></code> denotes the model&#x27;s input, any image.</li>
<li><code class="language-math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>y</mi><mtext>target</mtext></msub></mrow><annotation encoding="application/x-tex">y_{\text{target}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7167em;vertical-align:-0.2861em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">target</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em"><span></span></span></span></span></span></span></span></span></span></code> is the target class that we want to generate an adversarial example for.</li>
<li><code class="language-math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>CE</mtext></mrow><annotation encoding="application/x-tex">\text{CE}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord text"><span class="mord">CE</span></span></span></span></span></code> is the <a target="_blank" rel="noopener noreferrer" href="https://en.wikipedia.org/wiki/Cross-entropy">Cross Entropy</a> loss function.</li>
<li><code class="language-math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">f(x)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal" style="margin-right:0.10764em">f</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span></code> denotes the model.</li>
</ul>
<p>If we need to, we can also optimize the <code class="language-math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>CE</mtext></mrow><annotation encoding="application/x-tex">\text{CE}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord text"><span class="mord">CE</span></span></span></span></span></code> loss by maximizing the loss of the true label of <code class="language-math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord mathnormal">x</span></span></span></span></code> and the model&#x27;s output.</p>
<div class="flex items-center justify-center"><div class="flex items-center justify-center rounded-md p-4 border w-11/12 not-prose border-0"><p><code class="language-math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="script">L</mi><mtext>untargeted</mtext></msub><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><msub><mi>y</mi><mtext>true</mtext></msub><mo stretchy="false">)</mo><mo>=</mo><mo>−</mo><mtext>CE</mtext><mo stretchy="false">(</mo><msub><mi>y</mi><mtext>true</mtext></msub><mo separator="true">,</mo><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\mathcal{L}_{\text{untargeted}}(x, y_{\text{true}}) = - \text{CE}(y_{\text{true}}, f(x))</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0361em;vertical-align:-0.2861em"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">untargeted</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">true</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord">−</span><span class="mord text"><span class="mord">CE</span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">true</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord mathnormal" style="margin-right:0.10764em">f</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">))</span></span></span></span></code></p></div></div>
<p>Where:</p>
<ul>
<li><code class="language-math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>y</mi><mtext>true</mtext></msub></mrow><annotation encoding="application/x-tex">y_{\text{true}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">true</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></code> is the label we want to optimize against.</li>
</ul>
<p>For the solutions, we will also try to keep the adversarial example <strong>close</strong> to the initial image.
This means that the difference pixels of the original and adversarial image are within a certain number of pixels.
We will do this by <strong>clamping</strong> the changes after generating an adversarial example or during each iteration.
Each solution can just easily remove this restriction, we are keeping it as it leads to the CTF problems easier.</p>
<p>Lastly, these solutions require input to start with, the initial <code class="language-math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>x</mi><mn>0</mn></msup></mrow><annotation encoding="application/x-tex">x^{0}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141em"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0</span></span></span></span></span></span></span></span></span></span></span></span></code>.
We will start with using the white image from the diagram above, and later transition the attack to use a picture of my bird below.</p>
<div class="flex items-center justify-center flex-col"><img src="/post-assets/exploring-attacks-1/burb-img.png" alt="Yellow parakeet"/><p class="mr-4 subtext" style="font-size:0.75rem">ImageNet-trained ResNet18 model&#x27;s output probabilities for the bird.</p></div>
<p>Let&#x27;s finally jump in the solutions.</p>
<h2>Iterative naive solution</h2>
<p>We can write out a simple solution to generate an adversarial image given an inital image <code class="language-math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord mathnormal">x</span></span></span></span></code>.
We can iteratively optimize for a better solution.</p>
<div class="flex items-center justify-center"><div class="flex items-center justify-center rounded-md p-4 border w-11/12 not-prose border-0"><p><code class="language-math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>x</mi><mrow><mo stretchy="false">(</mo><mi>k</mi><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></msup><mo>=</mo><msup><mi>x</mi><mrow><mo stretchy="false">(</mo><mi>k</mi><mo stretchy="false">)</mo></mrow></msup><mo>−</mo><mi>α</mi><mo>⋅</mo><msub><mi mathvariant="normal">∇</mi><msup><mi>x</mi><mrow><mo stretchy="false">(</mo><mi>k</mi><mo stretchy="false">)</mo></mrow></msup></msub><msub><mi mathvariant="script">L</mi><mtext>targeted</mtext></msub><mo stretchy="false">(</mo><mi>f</mi><mo stretchy="false">(</mo><msup><mi>x</mi><mrow><mo stretchy="false">(</mo><mi>k</mi><mo stretchy="false">)</mo></mrow></msup><mo stretchy="false">)</mo><mo separator="true">,</mo><msub><mi>y</mi><mtext>target</mtext></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">x^{(k+1)} = x^{(k)} - \alpha \cdot \nabla_{x^{(k)}} \mathcal{L}_{\text{targeted}}(f(x^{(k)}), y_{\text{target}})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.888em"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.888em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight" style="margin-right:0.03148em">k</span><span class="mbin mtight">+</span><span class="mord mtight">1</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.9713em;vertical-align:-0.0833em"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.888em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight" style="margin-right:0.03148em">k</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:0.4445em"></span><span class="mord mathnormal" style="margin-right:0.0037em">α</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:1.1741em;vertical-align:-0.2861em"></span><span class="mord"><span class="mord">∇</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em"><span style="top:-2.4694em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.822em"><span style="top:-2.822em;margin-right:0.0714em"><span class="pstrut" style="height:2.5357em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight" style="margin-right:0.03148em">k</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2306em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">targeted</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.10764em">f</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.888em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight" style="margin-right:0.03148em">k</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">target</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></code></p></div></div>
<p>Where:</p>
<ul>
<li><code class="language-math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>x</mi><mrow><mo stretchy="false">(</mo><mi>k</mi><mo stretchy="false">)</mo></mrow></msup></mrow><annotation encoding="application/x-tex">x^{(k)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.888em"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.888em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight" style="margin-right:0.03148em">k</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span></span></span></span></code> denotes the image at iteration <code class="language-math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em"></span><span class="mord mathnormal" style="margin-right:0.03148em">k</span></span></span></span></code>.</li>
<li><code class="language-math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>α</mi></mrow><annotation encoding="application/x-tex">\alpha</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord mathnormal" style="margin-right:0.0037em">α</span></span></span></span></code> is the step size at each iteration.</li>
<li><code class="language-math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="normal">∇</mi><msup><mi>x</mi><mrow><mo stretchy="false">(</mo><mi>k</mi><mo stretchy="false">)</mo></mrow></msup></msub><msub><mi mathvariant="script">L</mi><mtext>targeted</mtext></msub><mo stretchy="false">(</mo><mi>f</mi><mo stretchy="false">(</mo><msup><mi>x</mi><mrow><mo stretchy="false">(</mo><mi>k</mi><mo stretchy="false">)</mo></mrow></msup><mo stretchy="false">)</mo><mo separator="true">,</mo><msub><mi>y</mi><mtext>target</mtext></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\nabla_{x^{(k)}} \mathcal{L}_{\text{targeted}}(f(x^{(k)}), y_{\text{target}})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1741em;vertical-align:-0.2861em"></span><span class="mord"><span class="mord">∇</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em"><span style="top:-2.4694em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.822em"><span style="top:-2.822em;margin-right:0.0714em"><span class="pstrut" style="height:2.5357em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight" style="margin-right:0.03148em">k</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2306em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">targeted</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.10764em">f</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.888em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight" style="margin-right:0.03148em">k</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">target</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></code> represents the gradient of the cost function with respect to <code class="language-math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>x</mi><mrow><mo stretchy="false">(</mo><mi>k</mi><mo stretchy="false">)</mo></mrow></msup></mrow><annotation encoding="application/x-tex">x^{(k)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.888em"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.888em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight" style="margin-right:0.03148em">k</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span></span></span></span></code>.</li>
</ul>
<p>Using gradient descent, we can slowly come up with a solution that maximizes the probability of the target.</p>
<p>Lets try an example in python using pytorch and apply this simple iterative solution.
Starting from a completely white image, lets try to get the model to predict class index <code class="language-math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord">0</span></span></span></span></code>, which maps to &quot;tench.&quot;
Here is the python code to do this gradient descent:</p>
<pre class="language-python"><code class="language-python code-highlight"><span class="code-line">target_output <span class="token operator">=</span> torch<span class="token punctuation">.</span>tensor<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> dtype<span class="token operator">=</span>torch<span class="token punctuation">.</span><span class="token builtin">long</span><span class="token punctuation">)</span> <span class="token comment"># class 0 is &quot;tench&quot;</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token comment"># convert the white image to a tensor and normalize it to the same range as the model&#x27;s input (0-1)</span>
</span><span class="code-line">x <span class="token operator">=</span> torch<span class="token punctuation">.</span>tensor<span class="token punctuation">(</span>white_img<span class="token punctuation">,</span> dtype<span class="token operator">=</span>torch<span class="token punctuation">.</span>float32<span class="token punctuation">)</span><span class="token punctuation">.</span>permute<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>unsqueeze<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">255.0</span>
</span><span class="code-line">x<span class="token punctuation">.</span>requires_grad <span class="token operator">=</span> <span class="token boolean">True</span> <span class="token comment"># allow gradients to be calculated since we want to optimize the image</span>
</span><span class="code-line">
</span><span class="code-line">alpha <span class="token operator">=</span> <span class="token number">1.</span> <span class="token comment"># step size for the gradient descent</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">for</span> iteration <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
</span><span class="code-line">    output <span class="token operator">=</span> model<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line">    <span class="token comment"># our objective is to maximize the probability of the target class</span>
</span><span class="code-line">    loss <span class="token operator">=</span> F<span class="token punctuation">.</span>cross_entropy<span class="token punctuation">(</span>output<span class="token punctuation">,</span> target_output<span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line">    <span class="token comment"># calculate the gradient of the loss with respect to the input image</span>
</span><span class="code-line">    loss<span class="token punctuation">.</span>backward<span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line">    <span class="token comment"># apply gradient descent to the image, this step is usually done by the optimizer</span>
</span><span class="code-line">    <span class="token comment"># but we&#x27;re doing it manually here, by taking the gradient of the image and updating it</span>
</span><span class="code-line">    x<span class="token punctuation">.</span>data <span class="token operator">=</span> x<span class="token punctuation">.</span>data <span class="token operator">-</span> alpha <span class="token operator">*</span> x<span class="token punctuation">.</span>grad
</span><span class="code-line">
</span><span class="code-line">    <span class="token comment"># zero the gradient for the next iteration</span>
</span><span class="code-line">    x<span class="token punctuation">.</span>grad<span class="token punctuation">.</span>zero_<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># probably not needed</span>
</span><span class="code-line">
</span><span class="code-line">    <span class="token comment"># clamp the image to the valid pixel range [0, 1]</span>
</span><span class="code-line">    x<span class="token punctuation">.</span>data <span class="token operator">=</span> torch<span class="token punctuation">.</span>clamp<span class="token punctuation">(</span>x<span class="token punctuation">.</span>data<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
</span></code></pre>
<p class="mr-4 subtext" style="font-size:0.75rem">full code: <a href="https://github.com/OutWrest/blog-handouts/blob/main/exploring-attacks-1/attacks-introduction.ipynb">https://github.com/OutWrest/blog-handouts/blob/main/exploring-attacks-1/attacks-introduction.ipynb</a></p>
<p>Output:</p>
<pre class="language-bash"><code class="language-bash code-highlight"><span class="code-line">Iter: <span class="token number">0</span>  <span class="token operator">|</span> Loss:  <span class="token number">7.5425</span> <span class="token operator">|</span> Pred: <span class="token string">&quot;window shade&quot;</span> <span class="token punctuation">(</span><span class="token number">5.05</span>% confidence<span class="token punctuation">)</span>
</span><span class="code-line">Iter: <span class="token number">1</span>  <span class="token operator">|</span> Loss:  <span class="token number">9.2704</span> <span class="token operator">|</span> Pred: <span class="token string">&quot;dishrag&quot;</span> <span class="token punctuation">(</span><span class="token number">3.04</span>% confidence<span class="token punctuation">)</span>
</span><span class="code-line">Iter: <span class="token number">2</span>  <span class="token operator">|</span> Loss:  <span class="token number">10.1515</span> <span class="token operator">|</span> Pred: <span class="token string">&quot;nematode&quot;</span> <span class="token punctuation">(</span><span class="token number">1.45</span>% confidence<span class="token punctuation">)</span>
</span><span class="code-line">Iter: <span class="token number">3</span>  <span class="token operator">|</span> Loss:  <span class="token number">7.6952</span> <span class="token operator">|</span> Pred: <span class="token string">&quot;brain coral&quot;</span> <span class="token punctuation">(</span><span class="token number">2.15</span>% confidence<span class="token punctuation">)</span>
</span><span class="code-line">Iter: <span class="token number">4</span>  <span class="token operator">|</span> Loss:  <span class="token number">5.4389</span> <span class="token operator">|</span> Pred: <span class="token string">&quot;American alligator&quot;</span> <span class="token punctuation">(</span><span class="token number">1.96</span>% confidence<span class="token punctuation">)</span>
</span><span class="code-line">Iter: <span class="token number">5</span>  <span class="token operator">|</span> Loss:  <span class="token number">4.7709</span> <span class="token operator">|</span> Pred: <span class="token string">&quot;American alligator&quot;</span> <span class="token punctuation">(</span><span class="token number">5.01</span>% confidence<span class="token punctuation">)</span>
</span><span class="code-line">Iter: <span class="token number">6</span>  <span class="token operator">|</span> Loss:  <span class="token number">3.2306</span> <span class="token operator">|</span> Pred: <span class="token string">&quot;tench&quot;</span> <span class="token punctuation">(</span><span class="token number">10.06</span>% confidence<span class="token punctuation">)</span>
</span><span class="code-line">Iter: <span class="token number">7</span>  <span class="token operator">|</span> Loss:  <span class="token number">2.2304</span> <span class="token operator">|</span> Pred: <span class="token string">&quot;brain coral&quot;</span> <span class="token punctuation">(</span><span class="token number">17.83</span>% confidence<span class="token punctuation">)</span>
</span><span class="code-line">Iter: <span class="token number">8</span>  <span class="token operator">|</span> Loss:  <span class="token number">2.4371</span> <span class="token operator">|</span> Pred: <span class="token string">&quot;tench&quot;</span> <span class="token punctuation">(</span><span class="token number">35.66</span>% confidence<span class="token punctuation">)</span>
</span><span class="code-line">Iter: <span class="token number">9</span>  <span class="token operator">|</span> Loss:  <span class="token number">1.0132</span> <span class="token operator">|</span> Pred: <span class="token string">&quot;tench&quot;</span> <span class="token punctuation">(</span><span class="token number">96.03</span>% confidence<span class="token punctuation">)</span>
</span><span class="code-line">Iter: <span class="token number">10</span> <span class="token operator">|</span> Loss:  <span class="token number">0.0390</span> <span class="token operator">|</span> Pred: <span class="token string">&quot;tench&quot;</span> <span class="token punctuation">(</span><span class="token number">99.90</span>% confidence<span class="token punctuation">)</span>
</span><span class="code-line">Iter: <span class="token number">11</span> <span class="token operator">|</span> Loss:  <span class="token number">0.0015</span> <span class="token operator">|</span> Pred: <span class="token string">&quot;tench&quot;</span> <span class="token punctuation">(</span><span class="token number">99.92</span>% confidence<span class="token punctuation">)</span>
</span><span class="code-line">Iter: <span class="token number">12</span> <span class="token operator">|</span> Loss:  <span class="token number">0.0013</span> <span class="token operator">|</span> Pred: <span class="token string">&quot;tench&quot;</span> <span class="token punctuation">(</span><span class="token number">99.93</span>% confidence<span class="token punctuation">)</span>
</span><span class="code-line">Iter: <span class="token number">13</span> <span class="token operator">|</span> Loss:  <span class="token number">0.0012</span> <span class="token operator">|</span> Pred: <span class="token string">&quot;tench&quot;</span> <span class="token punctuation">(</span><span class="token number">99.93</span>% confidence<span class="token punctuation">)</span>
</span><span class="code-line">Iter: <span class="token number">14</span> <span class="token operator">|</span> Loss:  <span class="token number">0.0011</span> <span class="token operator">|</span> Pred: <span class="token string">&quot;tench&quot;</span> <span class="token punctuation">(</span><span class="token number">99.94</span>% confidence<span class="token punctuation">)</span>
</span></code></pre>
<p>&quot;tench&quot; maps to our target index of <code class="language-math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord">0</span></span></span></span></code>, <strong>succes!</strong></p>
<p>Lets see how the adversarial example looks.</p>
<div class="flex items-center justify-center flex-col"><img class="block" src="/post-assets/exploring-attacks-1/white-img-adv-1.png" alt="White image classified as tench"/><p class="mr-4 subtext" style="font-size:0.75rem">The output adversarial example.</p></div>
<p>Starting from a completely white image - we are able to produce an adversarial image with any class we pick.
The adversarial example is not visually recognizable as a &quot;tench&quot; but the model predicts it with high confidence.</p>
<h3>How different is the adversarial example to our original image?</h3>
<p>To calculate the difference of the original image adversarial example, we track three different metrics.
We will keep track of the max, mean, and min pixel difference of the two images.</p>
<p>The code to do this is very simple:</p>
<pre class="language-python"><code class="language-python code-highlight"><span class="code-line">diff <span class="token operator">=</span> np<span class="token punctuation">.</span><span class="token builtin">abs</span><span class="token punctuation">(</span>white_img <span class="token operator">-</span> current_img<span class="token punctuation">)</span>
</span><span class="code-line">max_diff<span class="token punctuation">,</span> mean_diff<span class="token punctuation">,</span> min_diff <span class="token operator">=</span> diff<span class="token punctuation">.</span><span class="token builtin">max</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> diff<span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> diff<span class="token punctuation">.</span><span class="token builtin">min</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span></code></pre>
<p>Here is the pixel difference from our initial solution:</p>
<pre class="language-bash"><code class="language-bash code-highlight"><span class="code-line">Max  difference:  <span class="token number">209.00</span>
</span><span class="code-line">Mean difference:  <span class="token number">14.36</span>
</span><span class="code-line">Min  difference:  <span class="token number">0.00</span>
</span></code></pre>
<p>Let&#x27;s try to create another adversarial using the same method but lets try to minimize our <em>changes</em> to the image.
We will clamp the image so that the changes are within a certain range.
I will arbitrarily pick that our adversarial example should <strong>within <code class="language-math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>10</mn></mrow><annotation encoding="application/x-tex">10</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord">10</span></span></span></span></code> pixels</strong>.
This is common theme that shows up in CTF challeges, so lets try this out here.</p>
<h3>Iterative naive solution (with clamping)</h3>
<p>Let&#x27;s define a new function <code class="language-math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>clip</mtext></mrow><annotation encoding="application/x-tex">\text{clip}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em"></span><span class="mord text"><span class="mord">clip</span></span></span></span></span></code> that can simplify clamping.</p>
<div class="flex items-center justify-center"><div class="flex items-center justify-center rounded-md p-4 border w-11/12 not-prose border-0"><p><code class="language-math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>clip</mtext><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><mi>ϵ</mi><mo stretchy="false">)</mo><mo>=</mo><mtext>clamp</mtext><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><mi>x</mi><mo>−</mo><mi>ϵ</mi><mo separator="true">,</mo><mi>x</mi><mo>+</mo><mi>ϵ</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\text{clip}(x,\epsilon) = \text{clamp}(x, x - \epsilon, x + \epsilon)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord text"><span class="mord">clip</span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord mathnormal">ϵ</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord text"><span class="mord">clamp</span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:0.7778em;vertical-align:-0.1944em"></span><span class="mord mathnormal">ϵ</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal">ϵ</span><span class="mclose">)</span></span></span></span></code></p></div></div>
<p>Where:</p>
<ul>
<li><code class="language-math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>clamp</mtext><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><mtext>min_value</mtext><mo separator="true">,</mo><mtext>max_value</mtext><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\text{clamp}(x, \text{min\_value}, \text{max\_value})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.06em;vertical-align:-0.31em"></span><span class="mord text"><span class="mord">clamp</span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord text"><span class="mord">min_value</span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord text"><span class="mord">max_value</span></span><span class="mclose">)</span></span></span></span></code> is function that clamps the value of <code class="language-math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord mathnormal">x</span></span></span></span></code> between <code class="language-math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>min_value</mtext></mrow><annotation encoding="application/x-tex">\text{min\_value}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0044em;vertical-align:-0.31em"></span><span class="mord text"><span class="mord">min_value</span></span></span></span></span></code> and <code class="language-math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>max_value</mtext></mrow><annotation encoding="application/x-tex">\text{max\_value}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0044em;vertical-align:-0.31em"></span><span class="mord text"><span class="mord">max_value</span></span></span></span></span></code>.</li>
<li><code class="language-math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ϵ</mi></mrow><annotation encoding="application/x-tex">\epsilon</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord mathnormal">ϵ</span></span></span></span></code> is the maximum allowed change.</li>
</ul>
<p>We easily add a restriction to our equation to clip <code class="language-math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>x</mi><mrow><mo stretchy="false">(</mo><mi>k</mi><mo stretchy="false">)</mo></mrow></msup></mrow><annotation encoding="application/x-tex">x^{(k)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.888em"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.888em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight" style="margin-right:0.03148em">k</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span></span></span></span></code> to be within <code class="language-math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>10</mn></mrow><annotation encoding="application/x-tex">10</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord">10</span></span></span></span></code> pixels of <code class="language-math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>x</mi><mn>0</mn></msup></mrow><annotation encoding="application/x-tex">x^{0}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141em"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0</span></span></span></span></span></span></span></span></span></span></span></span></code>.</p>
<div class="flex items-center justify-center"><div class="flex items-center justify-center rounded-md p-4 border w-11/12 not-prose border-0"><p><code class="language-math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>x</mi><mrow><mo stretchy="false">(</mo><mi>k</mi><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></msup><mo>=</mo><mtext>clip</mtext><mo stretchy="false">(</mo><msup><mi>x</mi><mrow><mo stretchy="false">(</mo><mi>k</mi><mo stretchy="false">)</mo></mrow></msup><mo>−</mo><mi>α</mi><mo>⋅</mo><msub><mi mathvariant="normal">∇</mi><msup><mi>x</mi><mrow><mo stretchy="false">(</mo><mi>k</mi><mo stretchy="false">)</mo></mrow></msup></msub><msub><mi mathvariant="script">L</mi><mtext>targeted</mtext></msub><mo stretchy="false">(</mo><mi>f</mi><mo stretchy="false">(</mo><msup><mi>x</mi><mrow><mo stretchy="false">(</mo><mi>k</mi><mo stretchy="false">)</mo></mrow></msup><mo stretchy="false">)</mo><mo separator="true">,</mo><msub><mi>y</mi><mtext>target</mtext></msub><mo stretchy="false">)</mo><mo separator="true">,</mo><mi>ϵ</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">x^{(k+1)} = \text{clip}(x^{(k)} - \alpha \cdot \nabla_{x^{(k)}} \mathcal{L}_{\text{targeted}}(f(x^{(k)}), y_{\text{target}}), \epsilon)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.888em"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.888em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight" style="margin-right:0.03148em">k</span><span class="mbin mtight">+</span><span class="mord mtight">1</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1.138em;vertical-align:-0.25em"></span><span class="mord text"><span class="mord">clip</span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.888em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight" style="margin-right:0.03148em">k</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:0.4445em"></span><span class="mord mathnormal" style="margin-right:0.0037em">α</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:1.1741em;vertical-align:-0.2861em"></span><span class="mord"><span class="mord">∇</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em"><span style="top:-2.4694em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.822em"><span style="top:-2.822em;margin-right:0.0714em"><span class="pstrut" style="height:2.5357em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight" style="margin-right:0.03148em">k</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2306em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">targeted</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.10764em">f</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.888em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight" style="margin-right:0.03148em">k</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">target</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord mathnormal">ϵ</span><span class="mclose">)</span></span></span></span></code></p></div></div>
<p>In the arbitrary restriction, we should set <code class="language-math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ϵ</mi><mo>=</mo><mn>10</mn></mrow><annotation encoding="application/x-tex">\epsilon = 10</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord mathnormal">ϵ</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord">10</span></span></span></span></code>.
Let&#x27;s write the code out to include this restriction.
We will also track the pixel differences during each iteration.</p>
<pre class="language-python"><code class="language-python code-highlight"><span class="code-line">target_output <span class="token operator">=</span> torch<span class="token punctuation">.</span>tensor<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> dtype<span class="token operator">=</span>torch<span class="token punctuation">.</span><span class="token builtin">long</span><span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line">white_img_tensor <span class="token operator">=</span> torch<span class="token punctuation">.</span>tensor<span class="token punctuation">(</span>white_img<span class="token punctuation">,</span> dtype<span class="token operator">=</span>torch<span class="token punctuation">.</span>float32<span class="token punctuation">)</span><span class="token punctuation">.</span>permute<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>unsqueeze<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">255.0</span>
</span><span class="code-line">
</span><span class="code-line">x <span class="token operator">=</span> torch<span class="token punctuation">.</span>tensor<span class="token punctuation">(</span>white_img<span class="token punctuation">,</span> dtype<span class="token operator">=</span>torch<span class="token punctuation">.</span>float32<span class="token punctuation">)</span><span class="token punctuation">.</span>permute<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>unsqueeze<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">255.0</span>
</span><span class="code-line">x<span class="token punctuation">.</span>requires_grad <span class="token operator">=</span> <span class="token boolean">True</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token comment"># reduced from 1 to 0.1</span>
</span><span class="code-line">alpha <span class="token operator">=</span> <span class="token number">0.1</span>
</span><span class="code-line">
</span><span class="code-line">epsilon <span class="token operator">=</span> <span class="token number">10.</span> <span class="token operator">/</span> <span class="token number">255.</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">for</span> iteration <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">25</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
</span><span class="code-line">    output <span class="token operator">=</span> model<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line">    loss <span class="token operator">=</span> F<span class="token punctuation">.</span>cross_entropy<span class="token punctuation">(</span>output<span class="token punctuation">,</span> target_output<span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line">    model<span class="token punctuation">.</span>zero_grad<span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">    loss<span class="token punctuation">.</span>backward<span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line">    x<span class="token punctuation">.</span>data <span class="token operator">=</span> x<span class="token punctuation">.</span>data <span class="token operator">-</span> alpha <span class="token operator">*</span> x<span class="token punctuation">.</span>grad
</span><span class="code-line">
</span><span class="code-line">    x<span class="token punctuation">.</span>grad<span class="token punctuation">.</span>zero_<span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">    x<span class="token punctuation">.</span>data <span class="token operator">=</span> torch<span class="token punctuation">.</span>clamp<span class="token punctuation">(</span>x<span class="token punctuation">.</span>data<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line">    <span class="token comment"># clamp within epsilon</span>
</span><span class="code-line">    x<span class="token punctuation">.</span>data <span class="token operator">=</span> torch<span class="token punctuation">.</span>clamp<span class="token punctuation">(</span>x<span class="token punctuation">.</span>data<span class="token punctuation">,</span> white_img_tensor <span class="token operator">-</span> epsilon<span class="token punctuation">,</span> white_img_tensor <span class="token operator">+</span> epsilon<span class="token punctuation">)</span>
</span></code></pre>
<p class="mr-4 subtext" style="font-size:0.75rem">full code: <a href="https://github.com/OutWrest/blog-handouts/blob/main/exploring-attacks-1/attacks-introduction.ipynb">https://github.com/OutWrest/blog-handouts/blob/main/exploring-attacks-1/attacks-introduction.ipynb</a></p>
<p>Output:</p>
<pre class="language-bash"><code class="language-bash code-highlight"><span class="code-line">Iter: <span class="token number">0</span>  <span class="token operator">|</span> Loss:  <span class="token number">7.5425</span> <span class="token operator">|</span> min/max/mean: <span class="token number">0.00</span>/4.00/0.51 <span class="token operator">|</span> Pred: <span class="token string">&quot;corkscrew&quot;</span> <span class="token punctuation">(</span><span class="token number">1.76</span>% confidence<span class="token punctuation">)</span>
</span><span class="code-line">Iter: <span class="token number">1</span>  <span class="token operator">|</span> Loss:  <span class="token number">7.4247</span> <span class="token operator">|</span> min/max/mean: <span class="token number">0.00</span>/10.00/0.67 <span class="token operator">|</span> Pred: <span class="token string">&quot;corkscrew&quot;</span> <span class="token punctuation">(</span><span class="token number">1.45</span>% confidence<span class="token punctuation">)</span>
</span><span class="code-line">Iter: <span class="token number">2</span>  <span class="token operator">|</span> Loss:  <span class="token number">7.8976</span> <span class="token operator">|</span> min/max/mean: <span class="token number">0.00</span>/10.00/0.88 <span class="token operator">|</span> Pred: <span class="token string">&quot;ski&quot;</span> <span class="token punctuation">(</span><span class="token number">1.38</span>% confidence<span class="token punctuation">)</span>
</span><span class="code-line">Iter: <span class="token number">3</span>  <span class="token operator">|</span> Loss:  <span class="token number">7.8823</span> <span class="token operator">|</span> min/max/mean: <span class="token number">0.00</span>/10.00/1.11 <span class="token operator">|</span> Pred: <span class="token string">&quot;ski&quot;</span> <span class="token punctuation">(</span><span class="token number">1.74</span>% confidence<span class="token punctuation">)</span>
</span><span class="code-line">Iter: <span class="token number">4</span>  <span class="token operator">|</span> Loss:  <span class="token number">7.5663</span> <span class="token operator">|</span> min/max/mean: <span class="token number">0.00</span>/10.00/1.34 <span class="token operator">|</span> Pred: <span class="token string">&quot;ski&quot;</span> <span class="token punctuation">(</span><span class="token number">2.05</span>% confidence<span class="token punctuation">)</span>
</span><span class="code-line">Iter: <span class="token number">5</span>  <span class="token operator">|</span> Loss:  <span class="token number">6.6579</span> <span class="token operator">|</span> min/max/mean: <span class="token number">0.00</span>/10.00/1.57 <span class="token operator">|</span> Pred: <span class="token string">&quot;snowmobile&quot;</span> <span class="token punctuation">(</span><span class="token number">2.57</span>% confidence<span class="token punctuation">)</span>
</span><span class="code-line">Iter: <span class="token number">6</span>  <span class="token operator">|</span> Loss:  <span class="token number">6.3951</span> <span class="token operator">|</span> min/max/mean: <span class="token number">0.00</span>/10.00/1.82 <span class="token operator">|</span> Pred: <span class="token string">&quot;envelope&quot;</span> <span class="token punctuation">(</span><span class="token number">3.24</span>% confidence<span class="token punctuation">)</span>
</span><span class="code-line">Iter: <span class="token number">7</span>  <span class="token operator">|</span> Loss:  <span class="token number">6.9340</span> <span class="token operator">|</span> min/max/mean: <span class="token number">0.00</span>/10.00/2.11 <span class="token operator">|</span> Pred: <span class="token string">&quot;spider web&quot;</span> <span class="token punctuation">(</span><span class="token number">1.73</span>% confidence<span class="token punctuation">)</span>
</span><span class="code-line">Iter: <span class="token number">8</span>  <span class="token operator">|</span> Loss:  <span class="token number">6.3351</span> <span class="token operator">|</span> min/max/mean: <span class="token number">0.00</span>/10.00/2.31 <span class="token operator">|</span> Pred: <span class="token string">&quot;whistle&quot;</span> <span class="token punctuation">(</span><span class="token number">4.70</span>% confidence<span class="token punctuation">)</span>
</span><span class="code-line">Iter: <span class="token number">9</span>  <span class="token operator">|</span> Loss:  <span class="token number">5.5793</span> <span class="token operator">|</span> min/max/mean: <span class="token number">0.00</span>/10.00/2.48 <span class="token operator">|</span> Pred: <span class="token string">&quot;spider web&quot;</span> <span class="token punctuation">(</span><span class="token number">6.55</span>% confidence<span class="token punctuation">)</span>
</span><span class="code-line">Iter: <span class="token number">10</span> <span class="token operator">|</span> Loss:  <span class="token number">5.4742</span> <span class="token operator">|</span> min/max/mean: <span class="token number">0.00</span>/10.00/2.64 <span class="token operator">|</span> Pred: <span class="token string">&quot;tray&quot;</span> <span class="token punctuation">(</span><span class="token number">10.74</span>% confidence<span class="token punctuation">)</span>
</span><span class="code-line">Iter: <span class="token number">11</span> <span class="token operator">|</span> Loss:  <span class="token number">5.0233</span> <span class="token operator">|</span> min/max/mean: <span class="token number">0.00</span>/10.00/2.82 <span class="token operator">|</span> Pred: <span class="token string">&quot;spider web&quot;</span> <span class="token punctuation">(</span><span class="token number">5.89</span>% confidence<span class="token punctuation">)</span>
</span><span class="code-line">Iter: <span class="token number">12</span> <span class="token operator">|</span> Loss:  <span class="token number">4.9147</span> <span class="token operator">|</span> min/max/mean: <span class="token number">0.00</span>/10.00/2.95 <span class="token operator">|</span> Pred: <span class="token string">&quot;tray&quot;</span> <span class="token punctuation">(</span><span class="token number">4.78</span>% confidence<span class="token punctuation">)</span>
</span><span class="code-line">Iter: <span class="token number">13</span> <span class="token operator">|</span> Loss:  <span class="token number">3.1300</span> <span class="token operator">|</span> min/max/mean: <span class="token number">0.00</span>/10.00/3.08 <span class="token operator">|</span> Pred: <span class="token string">&quot;envelope&quot;</span> <span class="token punctuation">(</span><span class="token number">3.82</span>% confidence<span class="token punctuation">)</span>
</span><span class="code-line">Iter: <span class="token number">14</span> <span class="token operator">|</span> Loss:  <span class="token number">4.8309</span> <span class="token operator">|</span> min/max/mean: <span class="token number">0.00</span>/10.00/3.23 <span class="token operator">|</span> Pred: <span class="token string">&quot;tench&quot;</span> <span class="token punctuation">(</span><span class="token number">5.76</span>% confidence<span class="token punctuation">)</span>
</span><span class="code-line">Iter: <span class="token number">15</span> <span class="token operator">|</span> Loss:  <span class="token number">2.7523</span> <span class="token operator">|</span> min/max/mean: <span class="token number">0.00</span>/10.00/3.34 <span class="token operator">|</span> Pred: <span class="token string">&quot;brain coral&quot;</span> <span class="token punctuation">(</span><span class="token number">8.50</span>% confidence<span class="token punctuation">)</span>
</span><span class="code-line">Iter: <span class="token number">16</span> <span class="token operator">|</span> Loss:  <span class="token number">3.3318</span> <span class="token operator">|</span> min/max/mean: <span class="token number">0.00</span>/10.00/3.46 <span class="token operator">|</span> Pred: <span class="token string">&quot;tench&quot;</span> <span class="token punctuation">(</span><span class="token number">4.90</span>% confidence<span class="token punctuation">)</span>
</span><span class="code-line">Iter: <span class="token number">17</span> <span class="token operator">|</span> Loss:  <span class="token number">2.8901</span> <span class="token operator">|</span> min/max/mean: <span class="token number">0.00</span>/10.00/3.57 <span class="token operator">|</span> Pred: <span class="token string">&quot;brain coral&quot;</span> <span class="token punctuation">(</span><span class="token number">10.10</span>% confidence<span class="token punctuation">)</span>
</span><span class="code-line">Iter: <span class="token number">18</span> <span class="token operator">|</span> Loss:  <span class="token number">3.0373</span> <span class="token operator">|</span> min/max/mean: <span class="token number">0.00</span>/10.00/3.71 <span class="token operator">|</span> Pred: <span class="token string">&quot;broom&quot;</span> <span class="token punctuation">(</span><span class="token number">4.58</span>% confidence<span class="token punctuation">)</span>
</span><span class="code-line">Iter: <span class="token number">19</span> <span class="token operator">|</span> Loss:  <span class="token number">3.7803</span> <span class="token operator">|</span> min/max/mean: <span class="token number">0.00</span>/10.00/3.83 <span class="token operator">|</span> Pred: <span class="token string">&quot;tench&quot;</span> <span class="token punctuation">(</span><span class="token number">30.13</span>% confidence<span class="token punctuation">)</span>
</span><span class="code-line">Iter: <span class="token number">20</span> <span class="token operator">|</span> Loss:  <span class="token number">1.1454</span> <span class="token operator">|</span> min/max/mean: <span class="token number">0.00</span>/10.00/3.90 <span class="token operator">|</span> Pred: <span class="token string">&quot;tench&quot;</span> <span class="token punctuation">(</span><span class="token number">50.96</span>% confidence<span class="token punctuation">)</span>
</span><span class="code-line">Iter: <span class="token number">21</span> <span class="token operator">|</span> Loss:  <span class="token number">0.5941</span> <span class="token operator">|</span> min/max/mean: <span class="token number">0.00</span>/10.00/3.95 <span class="token operator">|</span> Pred: <span class="token string">&quot;tench&quot;</span> <span class="token punctuation">(</span><span class="token number">74.24</span>% confidence<span class="token punctuation">)</span>
</span><span class="code-line">Iter: <span class="token number">22</span> <span class="token operator">|</span> Loss:  <span class="token number">0.2818</span> <span class="token operator">|</span> min/max/mean: <span class="token number">0.00</span>/10.00/3.99 <span class="token operator">|</span> Pred: <span class="token string">&quot;tench&quot;</span> <span class="token punctuation">(</span><span class="token number">99.14</span>% confidence<span class="token punctuation">)</span>
</span><span class="code-line">Iter: <span class="token number">23</span> <span class="token operator">|</span> Loss:  <span class="token number">0.0085</span> <span class="token operator">|</span> min/max/mean: <span class="token number">0.00</span>/10.00/4.03 <span class="token operator">|</span> Pred: <span class="token string">&quot;tench&quot;</span> <span class="token punctuation">(</span><span class="token number">99.76</span>% confidence<span class="token punctuation">)</span>
</span><span class="code-line">Iter: <span class="token number">24</span> <span class="token operator">|</span> Loss:  <span class="token number">0.0051</span> <span class="token operator">|</span> min/max/mean: <span class="token number">0.00</span>/10.00/4.03 <span class="token operator">|</span> Pred: <span class="token string">&quot;tench&quot;</span> <span class="token punctuation">(</span><span class="token number">99.81</span>% confidence<span class="token punctuation">)</span>
</span></code></pre>
<p>We needed to do more interations than previous example. but we seem to still be able to create an adversarial example.</p>
<div class="flex items-center justify-center flex-col"><img class="block" src="/post-assets/exploring-attacks-1/white-img-adv-2.png" alt="White image classified as tench"/><p class="mr-4 subtext" style="font-size:0.75rem">The output adversarial example with clamping.</p></div>
<h3>Applying solution to an actual image</h3>
<p>Using the burb example shown earlier in the article, let&#x27;s try to create an adversarial example that would classified as a <code>assault rifle</code> (index <code class="language-math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>413</mn></mrow><annotation encoding="application/x-tex">413</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord">413</span></span></span></span></code>).
We will also use a lower <code class="language-math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ϵ</mi></mrow><annotation encoding="application/x-tex">\epsilon</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord mathnormal">ϵ</span></span></span></span></code>, the perturbations should be within <code class="language-math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord">1</span></span></span></span></code> pixel of the original image.</p>
<pre class="language-python"><code class="language-python code-highlight"><span class="code-line">target_output <span class="token operator">=</span> torch<span class="token punctuation">.</span>tensor<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">413</span><span class="token punctuation">]</span><span class="token punctuation">,</span> dtype<span class="token operator">=</span>torch<span class="token punctuation">.</span><span class="token builtin">long</span><span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line">burb_img_tensor <span class="token operator">=</span> torch<span class="token punctuation">.</span>tensor<span class="token punctuation">(</span>burb_img<span class="token punctuation">,</span> dtype<span class="token operator">=</span>torch<span class="token punctuation">.</span>float32<span class="token punctuation">)</span><span class="token punctuation">.</span>permute<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>unsqueeze<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">255.0</span>
</span><span class="code-line">
</span><span class="code-line">x <span class="token operator">=</span> torch<span class="token punctuation">.</span>tensor<span class="token punctuation">(</span>burb_img<span class="token punctuation">,</span> dtype<span class="token operator">=</span>torch<span class="token punctuation">.</span>float32<span class="token punctuation">)</span><span class="token punctuation">.</span>permute<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>unsqueeze<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">255.0</span>
</span><span class="code-line">x<span class="token punctuation">.</span>requires_grad <span class="token operator">=</span> <span class="token boolean">True</span>
</span><span class="code-line">
</span><span class="code-line">alpha <span class="token operator">=</span> <span class="token number">0.1</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token comment"># lets lower the epsilon to a lower pixel difference</span>
</span><span class="code-line">epsilon <span class="token operator">=</span> <span class="token number">1.</span> <span class="token operator">/</span> <span class="token number">255.</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">for</span> iteration <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
</span><span class="code-line">    output <span class="token operator">=</span> model<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line">    loss <span class="token operator">=</span> F<span class="token punctuation">.</span>cross_entropy<span class="token punctuation">(</span>output<span class="token punctuation">,</span> target_output<span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line">    model<span class="token punctuation">.</span>zero_grad<span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">    loss<span class="token punctuation">.</span>backward<span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line">    x<span class="token punctuation">.</span>data <span class="token operator">=</span> x<span class="token punctuation">.</span>data <span class="token operator">-</span> alpha <span class="token operator">*</span> x<span class="token punctuation">.</span>grad
</span><span class="code-line">
</span><span class="code-line">    x<span class="token punctuation">.</span>grad<span class="token punctuation">.</span>zero_<span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">    x<span class="token punctuation">.</span>data <span class="token operator">=</span> torch<span class="token punctuation">.</span>clamp<span class="token punctuation">(</span>x<span class="token punctuation">.</span>data<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
</span><span class="code-line">    x<span class="token punctuation">.</span>data <span class="token operator">=</span> torch<span class="token punctuation">.</span>clamp<span class="token punctuation">(</span>x<span class="token punctuation">.</span>data<span class="token punctuation">,</span> burb_img_tensor <span class="token operator">-</span> epsilon<span class="token punctuation">,</span> burb_img_tensor <span class="token operator">+</span> epsilon<span class="token punctuation">)</span>
</span></code></pre>
<p class="mr-4 subtext" style="font-size:0.75rem">full code: <a href="https://github.com/OutWrest/blog-handouts/blob/main/exploring-attacks-1/attacks-introduction.ipynb">https://github.com/OutWrest/blog-handouts/blob/main/exploring-attacks-1/attacks-introduction.ipynb</a></p>
<p>Output:</p>
<pre class="language-bash"><code class="language-bash code-highlight"><span class="code-line">Iter: <span class="token number">0</span>  <span class="token operator">|</span> Loss:  <span class="token number">13.438</span> <span class="token operator">|</span> min/max/mean: <span class="token number">0.00</span>/2.00/0.76 <span class="token operator">|</span> Pred: <span class="token string">&quot;puffer&quot;</span> <span class="token punctuation">(</span><span class="token number">5.17</span>% confidence<span class="token punctuation">)</span>
</span><span class="code-line">Iter: <span class="token number">1</span>  <span class="token operator">|</span> Loss:  <span class="token number">8.1450</span> <span class="token operator">|</span> min/max/mean: <span class="token number">0.00</span>/2.00/0.70 <span class="token operator">|</span> Pred: <span class="token string">&quot;goose&quot;</span> <span class="token punctuation">(</span><span class="token number">6.03</span>% confidence<span class="token punctuation">)</span>
</span><span class="code-line">Iter: <span class="token number">2</span>  <span class="token operator">|</span> Loss:  <span class="token number">4.7022</span> <span class="token operator">|</span> min/max/mean: <span class="token number">0.00</span>/2.00/0.73 <span class="token operator">|</span> Pred: <span class="token string">&quot;assault rifle&quot;</span> <span class="token punctuation">(</span><span class="token number">4.97</span>% confidence<span class="token punctuation">)</span>
</span><span class="code-line">Iter: <span class="token number">3</span>  <span class="token operator">|</span> Loss:  <span class="token number">2.8506</span> <span class="token operator">|</span> min/max/mean: <span class="token number">0.00</span>/2.00/0.75 <span class="token operator">|</span> Pred: <span class="token string">&quot;assault rifle&quot;</span> <span class="token punctuation">(</span><span class="token number">15.59</span>% confidence<span class="token punctuation">)</span>
</span><span class="code-line">Iter: <span class="token number">4</span>  <span class="token operator">|</span> Loss:  <span class="token number">1.6048</span> <span class="token operator">|</span> min/max/mean: <span class="token number">0.00</span>/2.00/0.77 <span class="token operator">|</span> Pred: <span class="token string">&quot;assault rifle&quot;</span> <span class="token punctuation">(</span><span class="token number">24.72</span>% confidence<span class="token punctuation">)</span>
</span><span class="code-line">Iter: <span class="token number">5</span>  <span class="token operator">|</span> Loss:  <span class="token number">1.1955</span> <span class="token operator">|</span> min/max/mean: <span class="token number">0.00</span>/2.00/0.77 <span class="token operator">|</span> Pred: <span class="token string">&quot;assault rifle&quot;</span> <span class="token punctuation">(</span><span class="token number">64.57</span>% confidence<span class="token punctuation">)</span>
</span><span class="code-line">Iter: <span class="token number">6</span>  <span class="token operator">|</span> Loss:  <span class="token number">0.3494</span> <span class="token operator">|</span> min/max/mean: <span class="token number">0.00</span>/2.00/0.71 <span class="token operator">|</span> Pred: <span class="token string">&quot;assault rifle&quot;</span> <span class="token punctuation">(</span><span class="token number">88.91</span>% confidence<span class="token punctuation">)</span>
</span><span class="code-line">Iter: <span class="token number">7</span>  <span class="token operator">|</span> Loss:  <span class="token number">0.0869</span> <span class="token operator">|</span> min/max/mean: <span class="token number">0.00</span>/2.00/0.66 <span class="token operator">|</span> Pred: <span class="token string">&quot;assault rifle&quot;</span> <span class="token punctuation">(</span><span class="token number">88.80</span>% confidence<span class="token punctuation">)</span>
</span><span class="code-line">Iter: <span class="token number">8</span>  <span class="token operator">|</span> Loss:  <span class="token number">0.0470</span> <span class="token operator">|</span> min/max/mean: <span class="token number">0.00</span>/2.00/0.66 <span class="token operator">|</span> Pred: <span class="token string">&quot;assault rifle&quot;</span> <span class="token punctuation">(</span><span class="token number">90.01</span>% confidence<span class="token punctuation">)</span>
</span><span class="code-line">Iter: <span class="token number">9</span>  <span class="token operator">|</span> Loss:  <span class="token number">0.0376</span> <span class="token operator">|</span> min/max/mean: <span class="token number">0.00</span>/2.00/0.66 <span class="token operator">|</span> Pred: <span class="token string">&quot;assault rifle&quot;</span> <span class="token punctuation">(</span><span class="token number">91.72</span>% confidence<span class="token punctuation">)</span>
</span></code></pre>
<p>Even with a very low <code class="language-math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ϵ</mi></mrow><annotation encoding="application/x-tex">\epsilon</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord mathnormal">ϵ</span></span></span></span></code>, we are still able to generate a high confidence image that is able to classified into <code>assault rifle</code>.
Let&#x27;s see what the new image looks like.</p>
<div class="flex items-center justify-center flex-col"><img class="block" src="/post-assets/exploring-attacks-1/burb-img-adv-1.png" alt="Burb image classified as assault rifle"/><p class="mr-4 subtext" style="font-size:0.75rem">The output adversarial example on burb image.</p></div>
<p>Following the graident directly is not the best to generate adversarial examples, let&#x27;s try to implement other methods that are widely used.</p>
<h2>Fast Gradient Signed Method (FGSM) Solution</h2>
<p>The Fast Gradient Signed Method (FGSM) is a popular technique for generating adversarial examples.
It works by calculating the gradient of the loss function with respect to the input image and then perturbing the input image in the <strong>direction</strong> of the gradient.
The amount of perturbation is controlled by a parameter <code class="language-math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ϵ</mi></mrow><annotation encoding="application/x-tex">\epsilon</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord mathnormal">ϵ</span></span></span></span></code>.</p>
<p>The adversarial example <code class="language-math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mtext>adv</mtext></msub></mrow><annotation encoding="application/x-tex">x_{\text{adv}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">adv</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></code> is generated as follows:</p>
<div class="flex items-center justify-center"><div class="flex items-center justify-center rounded-md p-4 border w-11/12 not-prose border-0"><p><code class="language-math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mtext>adv</mtext></msub><mo>=</mo><mi>x</mi><mo>+</mo><mi>ϵ</mi><mo>⋅</mo><mtext>sign</mtext><mo stretchy="false">(</mo><msub><mi mathvariant="normal">∇</mi><mi>x</mi></msub><mi>J</mi><mo stretchy="false">(</mo><mi>θ</mi><mo separator="true">,</mo><mi>x</mi><mo separator="true">,</mo><msub><mi>y</mi><mtext>target</mtext></msub><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">x_{\text{adv}} = x + \epsilon \cdot \text{sign}(\nabla_x J(\theta, x, y_{\text{target}}))</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">adv</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:0.4445em"></span><span class="mord mathnormal">ϵ</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:1.0361em;vertical-align:-0.2861em"></span><span class="mord text"><span class="mord">sign</span></span><span class="mopen">(</span><span class="mord"><span class="mord">∇</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">x</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.09618em">J</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02778em">θ</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">target</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em"><span></span></span></span></span></span></span><span class="mclose">))</span></span></span></span></code></p></div></div>
<p>Where:</p>
<ul>
<li><code class="language-math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord mathnormal">x</span></span></span></span></code> is the original input image</li>
<li><code class="language-math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ϵ</mi></mrow><annotation encoding="application/x-tex">\epsilon</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord mathnormal">ϵ</span></span></span></span></code> is the perturbation magnitude (<em>how much to change the original image</em>).</li>
<li><code class="language-math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="normal">∇</mi><mi>x</mi></msub><mi>J</mi><mo stretchy="false">(</mo><mi>θ</mi><mo separator="true">,</mo><mi>x</mi><mo separator="true">,</mo><msub><mi>y</mi><mtext>target</mtext></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\nabla_x J(\theta, x, y_{\text{target}})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0361em;vertical-align:-0.2861em"></span><span class="mord"><span class="mord">∇</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">x</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.09618em">J</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02778em">θ</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">target</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></code> is the gradient of the loss function <code class="language-math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>J</mi></mrow><annotation encoding="application/x-tex">J</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.09618em">J</span></span></span></span></code> with respect to <code class="language-math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord mathnormal">x</span></span></span></span></code>.</li>
<li><code class="language-math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>sign</mtext><mo stretchy="false">(</mo><mo>⋅</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\text{sign}(\cdot)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord text"><span class="mord">sign</span></span><span class="mopen">(</span><span class="mord">⋅</span><span class="mclose">)</span></span></span></span></code> denotes the sign function.</li>
</ul>
<p>Let&#x27;s try to use FSGM on the same example problem that we&#x27;ve been working on using the burb image as the initial image.</p>
<pre class="language-python"><code class="language-python code-highlight"><span class="code-line">target_output <span class="token operator">=</span> torch<span class="token punctuation">.</span>tensor<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> dtype<span class="token operator">=</span>torch<span class="token punctuation">.</span><span class="token builtin">long</span><span class="token punctuation">)</span> <span class="token comment"># we will target index 0, which is &quot;tench, Tinca tinca&quot;</span>
</span><span class="code-line">
</span><span class="code-line">burb_img_tensor <span class="token operator">=</span> torch<span class="token punctuation">.</span>tensor<span class="token punctuation">(</span>burb_img<span class="token punctuation">,</span> dtype<span class="token operator">=</span>torch<span class="token punctuation">.</span>float32<span class="token punctuation">)</span><span class="token punctuation">.</span>permute<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>unsqueeze<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">255.0</span>
</span><span class="code-line">
</span><span class="code-line">x <span class="token operator">=</span> torch<span class="token punctuation">.</span>tensor<span class="token punctuation">(</span>burb_img<span class="token punctuation">,</span> dtype<span class="token operator">=</span>torch<span class="token punctuation">.</span>float32<span class="token punctuation">)</span><span class="token punctuation">.</span>permute<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>unsqueeze<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">255.0</span>
</span><span class="code-line">x<span class="token punctuation">.</span>requires_grad <span class="token operator">=</span> <span class="token boolean">True</span>
</span><span class="code-line">
</span><span class="code-line">epsilon <span class="token operator">=</span> <span class="token number">2.</span> <span class="token operator">/</span> <span class="token number">255.</span>
</span><span class="code-line">
</span><span class="code-line">output <span class="token operator">=</span> model<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
</span><span class="code-line">loss <span class="token operator">=</span> <span class="token operator">-</span>F<span class="token punctuation">.</span>cross_entropy<span class="token punctuation">(</span>output<span class="token punctuation">,</span> target_output<span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line">model<span class="token punctuation">.</span>zero_grad<span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">loss<span class="token punctuation">.</span>backward<span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line">grad <span class="token operator">=</span> x<span class="token punctuation">.</span>grad<span class="token punctuation">.</span>data
</span><span class="code-line">
</span><span class="code-line">x_adv <span class="token operator">=</span> x <span class="token operator">+</span> epsilon <span class="token operator">*</span> grad<span class="token punctuation">.</span>sign<span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">x_adv <span class="token operator">=</span> torch<span class="token punctuation">.</span>clamp<span class="token punctuation">(</span>x_adv<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
</span></code></pre>
<p class="mr-4 subtext" style="font-size:0.75rem">full code: <a href="https://github.com/OutWrest/blog-handouts/blob/main/exploring-attacks-1/attacks-introduction.ipynb">https://github.com/OutWrest/blog-handouts/blob/main/exploring-attacks-1/attacks-introduction.ipynb</a></p>
<p>Output:</p>
<pre class="language-bash"><code class="language-bash code-highlight"><span class="code-line">Loss: <span class="token parameter variable">-9.0888</span> <span class="token operator">|</span> min/max/mean: <span class="token number">0.00</span>/3.00/2.00 <span class="token operator">|</span> Pred: <span class="token string">&quot;tench&quot;</span> <span class="token punctuation">(</span><span class="token number">29.52</span>% confidence<span class="token punctuation">)</span>
</span></code></pre>
<p>In FSGM, we only generate a single example through the calculation and we do not iterate on our adversarial example.</p>
<div class="flex items-center justify-center flex-col"><img class="block" src="/post-assets/exploring-attacks-1/burb-img-adv-fsgm.png" alt="Burb image classified as tench"/><p class="mr-4 subtext" style="font-size:0.75rem">The output adversarial example on burb image using FSGM.</p></div>
<p>Since FGSM is sensative to epsilon and input image.
Depending on input image &amp; target class, it may be that FSGM is the best solution but it is a good start.
In our case, we are trying to optimize for very low perturbation to get a model to classify an image into targeted category.
While it was able to generate a solution for this case, it did not produce an example with high confidence.</p>
<h2>Projected Gradient Descent (PGD) Solution</h2>
<p>The Projected Gradient Descent (PGD) method is an iterative extension of FGSM.
Instead of applying the perturbation only once, PGD iteratively perturbs the input image in small steps.
This iterative process helps to find more effective adversarial examples while keeping the perturbations within a specified limit.</p>
<div class="flex items-center justify-center"><div class="flex items-center justify-center rounded-md p-4 border w-11/12 not-prose border-0"><p><code class="language-math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>x</mi><mrow><mo stretchy="false">(</mo><mi>k</mi><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></msup><mo>=</mo><mtext>clip</mtext><mo stretchy="false">(</mo><msup><mi>x</mi><mrow><mo stretchy="false">(</mo><mi>k</mi><mo stretchy="false">)</mo></mrow></msup><mo>−</mo><mi>α</mi><mo>⋅</mo><mtext>sign</mtext><mo stretchy="false">(</mo><msub><mi mathvariant="normal">∇</mi><mi>x</mi></msub><mi>J</mi><mo stretchy="false">(</mo><mi>θ</mi><mo separator="true">,</mo><mi>x</mi><mo separator="true">,</mo><msub><mi>y</mi><mtext>target</mtext></msub><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo separator="true">,</mo><mi>ϵ</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">x^{(k+1)} = \text{clip}(x^{(k)} - \alpha \cdot \text{sign}(\nabla_x J(\theta, x, y_{\text{target}})), \epsilon)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.888em"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.888em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight" style="margin-right:0.03148em">k</span><span class="mbin mtight">+</span><span class="mord mtight">1</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1.138em;vertical-align:-0.25em"></span><span class="mord text"><span class="mord">clip</span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.888em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight" style="margin-right:0.03148em">k</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:0.4445em"></span><span class="mord mathnormal" style="margin-right:0.0037em">α</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:1.0361em;vertical-align:-0.2861em"></span><span class="mord text"><span class="mord">sign</span></span><span class="mopen">(</span><span class="mord"><span class="mord">∇</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">x</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.09618em">J</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02778em">θ</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">target</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em"><span></span></span></span></span></span></span><span class="mclose">))</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord mathnormal">ϵ</span><span class="mclose">)</span></span></span></span></code></p></div></div>
<p>Where:</p>
<ul>
<li><code class="language-math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>α</mi></mrow><annotation encoding="application/x-tex">\alpha</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord mathnormal" style="margin-right:0.0037em">α</span></span></span></span></code> is the step size.</li>
<li><code class="language-math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ϵ</mi></mrow><annotation encoding="application/x-tex">\epsilon</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord mathnormal">ϵ</span></span></span></span></code> is the maximimal allowed perturbation.</li>
</ul>
<p>Again, let&#x27;s apply PGD to the same problem.</p>
<pre class="language-python"><code class="language-python code-highlight"><span class="code-line"><span class="token comment"># we will target index 413, which is &quot;assault rifle, assault gun&quot;</span>
</span><span class="code-line">target_output <span class="token operator">=</span> torch<span class="token punctuation">.</span>tensor<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">413</span><span class="token punctuation">]</span><span class="token punctuation">,</span> dtype<span class="token operator">=</span>torch<span class="token punctuation">.</span><span class="token builtin">long</span><span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line">burb_img_tensor <span class="token operator">=</span> torch<span class="token punctuation">.</span>tensor<span class="token punctuation">(</span>burb_img<span class="token punctuation">,</span> dtype<span class="token operator">=</span>torch<span class="token punctuation">.</span>float32<span class="token punctuation">)</span><span class="token punctuation">.</span>permute<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>unsqueeze<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">255.0</span>
</span><span class="code-line">
</span><span class="code-line">x <span class="token operator">=</span> torch<span class="token punctuation">.</span>tensor<span class="token punctuation">(</span>burb_img<span class="token punctuation">,</span> dtype<span class="token operator">=</span>torch<span class="token punctuation">.</span>float32<span class="token punctuation">)</span><span class="token punctuation">.</span>permute<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>unsqueeze<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">255.0</span>
</span><span class="code-line">x<span class="token punctuation">.</span>requires_grad <span class="token operator">=</span> <span class="token boolean">True</span>
</span><span class="code-line">
</span><span class="code-line">epsilon <span class="token operator">=</span>   <span class="token number">5.</span> <span class="token operator">/</span> <span class="token number">255.</span> <span class="token comment"># we will allow a maximum of 5 pixel difference</span>
</span><span class="code-line">alpha <span class="token operator">=</span>     <span class="token number">1.</span> <span class="token operator">/</span> <span class="token number">255.</span> <span class="token comment"># step size at each iteration (how many pixels to move each iteration)</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">for</span> iteration <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
</span><span class="code-line">    output <span class="token operator">=</span> model<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
</span><span class="code-line">    loss <span class="token operator">=</span> F<span class="token punctuation">.</span>cross_entropy<span class="token punctuation">(</span>output<span class="token punctuation">,</span> target_output<span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line">    model<span class="token punctuation">.</span>zero_grad<span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">    loss<span class="token punctuation">.</span>backward<span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line">    x<span class="token punctuation">.</span>data <span class="token operator">=</span> x<span class="token punctuation">.</span>data <span class="token operator">-</span> alpha <span class="token operator">*</span> x<span class="token punctuation">.</span>grad<span class="token punctuation">.</span>sign<span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">    x<span class="token punctuation">.</span>data <span class="token operator">=</span> torch<span class="token punctuation">.</span>clamp<span class="token punctuation">(</span>x<span class="token punctuation">.</span>data<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
</span><span class="code-line">    x<span class="token punctuation">.</span>data <span class="token operator">=</span> torch<span class="token punctuation">.</span>clamp<span class="token punctuation">(</span>x<span class="token punctuation">.</span>data<span class="token punctuation">,</span> burb_img_tensor <span class="token operator">-</span> epsilon<span class="token punctuation">,</span> burb_img_tensor <span class="token operator">+</span> epsilon<span class="token punctuation">)</span>
</span></code></pre>
<p class="mr-4 subtext" style="font-size:0.75rem">full code: <a href="https://github.com/OutWrest/blog-handouts/blob/main/exploring-attacks-1/attacks-introduction.ipynb">https://github.com/OutWrest/blog-handouts/blob/main/exploring-attacks-1/attacks-introduction.ipynb</a></p>
<p>Output:</p>
<pre class="language-bash"><code class="language-bash code-highlight"><span class="code-line">Iter: <span class="token number">0</span>  <span class="token operator">|</span> Loss:  <span class="token number">13.438</span> <span class="token operator">|</span> min/max/mean: <span class="token number">0.00</span>/2.00/1.00 <span class="token operator">|</span> Pred: <span class="token string">&quot;puffer&quot;</span> <span class="token punctuation">(</span><span class="token number">5.08</span>% confidence<span class="token punctuation">)</span>
</span><span class="code-line">Iter: <span class="token number">1</span>  <span class="token operator">|</span> Loss:  <span class="token number">8.0757</span> <span class="token operator">|</span> min/max/mean: <span class="token number">0.00</span>/3.00/1.75 <span class="token operator">|</span> Pred: <span class="token string">&quot;muzzle&quot;</span> <span class="token punctuation">(</span><span class="token number">3.38</span>% confidence<span class="token punctuation">)</span>
</span><span class="code-line">Iter: <span class="token number">2</span>  <span class="token operator">|</span> Loss:  <span class="token number">4.8234</span> <span class="token operator">|</span> min/max/mean: <span class="token number">0.00</span>/3.00/2.55 <span class="token operator">|</span> Pred: <span class="token string">&quot;assault rifle&quot;</span> <span class="token punctuation">(</span><span class="token number">15.30</span>% confidence<span class="token punctuation">)</span>
</span><span class="code-line">Iter: <span class="token number">3</span>  <span class="token operator">|</span> Loss:  <span class="token number">1.8669</span> <span class="token operator">|</span> min/max/mean: <span class="token number">0.00</span>/4.00/3.22 <span class="token operator">|</span> Pred: <span class="token string">&quot;assault rifle&quot;</span> <span class="token punctuation">(</span><span class="token number">68.43</span>% confidence<span class="token punctuation">)</span>
</span><span class="code-line">Iter: <span class="token number">4</span>  <span class="token operator">|</span> Loss:  <span class="token number">0.3802</span> <span class="token operator">|</span> min/max/mean: <span class="token number">0.00</span>/5.00/4.04 <span class="token operator">|</span> Pred: <span class="token string">&quot;assault rifle&quot;</span> <span class="token punctuation">(</span><span class="token number">84.15</span>% confidence<span class="token punctuation">)</span>
</span><span class="code-line">Iter: <span class="token number">5</span>  <span class="token operator">|</span> Loss:  <span class="token number">0.1732</span> <span class="token operator">|</span> min/max/mean: <span class="token number">0.00</span>/6.00/4.18 <span class="token operator">|</span> Pred: <span class="token string">&quot;assault rifle&quot;</span> <span class="token punctuation">(</span><span class="token number">90.14</span>% confidence<span class="token punctuation">)</span>
</span><span class="code-line">Iter: <span class="token number">6</span>  <span class="token operator">|</span> Loss:  <span class="token number">0.1038</span> <span class="token operator">|</span> min/max/mean: <span class="token number">0.00</span>/6.00/4.42 <span class="token operator">|</span> Pred: <span class="token string">&quot;assault rifle&quot;</span> <span class="token punctuation">(</span><span class="token number">92.51</span>% confidence<span class="token punctuation">)</span>
</span><span class="code-line">Iter: <span class="token number">7</span>  <span class="token operator">|</span> Loss:  <span class="token number">0.0781</span> <span class="token operator">|</span> min/max/mean: <span class="token number">0.00</span>/6.00/4.55 <span class="token operator">|</span> Pred: <span class="token string">&quot;assault rifle&quot;</span> <span class="token punctuation">(</span><span class="token number">94.01</span>% confidence<span class="token punctuation">)</span>
</span><span class="code-line">Iter: <span class="token number">8</span>  <span class="token operator">|</span> Loss:  <span class="token number">0.0620</span> <span class="token operator">|</span> min/max/mean: <span class="token number">0.00</span>/6.00/4.69 <span class="token operator">|</span> Pred: <span class="token string">&quot;assault rifle&quot;</span> <span class="token punctuation">(</span><span class="token number">95.16</span>% confidence<span class="token punctuation">)</span>
</span><span class="code-line">Iter: <span class="token number">9</span>  <span class="token operator">|</span> Loss:  <span class="token number">0.0498</span> <span class="token operator">|</span> min/max/mean: <span class="token number">0.00</span>/6.00/4.75 <span class="token operator">|</span> Pred: <span class="token string">&quot;assault rifle&quot;</span> <span class="token punctuation">(</span><span class="token number">96.24</span>% confidence<span class="token punctuation">)</span>
</span></code></pre>
<p>With PGD we are able to generate a targeted image at a higher confidence than using a simple gradient descent method.</p>
<div class="flex items-center justify-center flex-col"><img class="block" src="/post-assets/exploring-attacks-1/burb-img-adv-pgd.png" alt="Burb image classified as assault rifle"/><p class="mr-4 subtext" style="font-size:0.75rem">The output adversarial example on burb image using PGD.</p></div>
<p>Notice how this perturbation image is closer to FGSM than the simple iterative method.
The bottom left of this PGD perturbation image shows the pixel different around the bottom left following certain edges, but around the middle it gets sparse.</p>
<p>Let&#x27;s move forward and try to these techiques to recent CTF challenges.</p>
<h1>Applying to recent CTF challenges</h1>
<p>In the following two CTF challenges, we will try both the techniques that worked well for us in the previous sections.
The navie gradient descent and PGD (following the sign of the gradient).
FSGM will be able to generate an adversarial example but will not be able to solve the challenge alone in these cases.</p>
<br/>
<div class="flex items-center justify-center"><div class="rounded-md p-4 border w-11/12 bg-gray-100 dark:bg-gray-800 dark:border-gray-700"><div class="flex justify-between"><div><h2 class="font-bold text-xl mb-2 mt-0">misc / <!-- -->what-a-jpeg-is</h2><p class="text-gray-700 text-base mt-0">ireland</p></div><div class="text-right"><p class="font-semibold mb-2 mt-0">6 solves / 396 points</p><a class="text-gray-700 text-base mt-0" target="_blank" rel="noopener noreferrer" href="https://ctftime.org/event/2217/">DiceCTF 2024 Quals</a></div></div><div class="mt-0"><div class="max-w-none prose prose-a:text-pink-600 dark:prose-invert"><p>I just want a picture of a god-dang Madagascar cat</p><pre class="bg-gray-900">nc mc.ax 31373</pre></div></div></div></div>
<br/>
<p>Let&#x27;s start by looking at the code (partially shown):</p>
<pre class="language-python"><code class="language-python code-highlight"><span class="code-line"><span class="token keyword">def</span> <span class="token function">pytorch_jpeg_compress</span><span class="token punctuation">(</span>img_tensors<span class="token punctuation">)</span><span class="token punctuation">:</span>
</span><span class="code-line">    out_tensors <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
</span><span class="code-line">    <span class="token keyword">for</span> img_tensor <span class="token keyword">in</span> img_tensors<span class="token punctuation">:</span>
</span><span class="code-line">        quality <span class="token operator">=</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">90</span><span class="token punctuation">)</span>
</span><span class="code-line">        img <span class="token operator">=</span> Image<span class="token punctuation">.</span>fromarray<span class="token punctuation">(</span>
</span><span class="code-line">            <span class="token punctuation">(</span>
</span><span class="code-line">                np<span class="token punctuation">.</span>clip<span class="token punctuation">(</span>img_tensor<span class="token punctuation">.</span>cpu<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>numpy<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>swapaxes<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>swapaxes<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">255</span>
</span><span class="code-line">            <span class="token punctuation">)</span><span class="token punctuation">.</span>astype<span class="token punctuation">(</span>np<span class="token punctuation">.</span>uint8<span class="token punctuation">)</span>
</span><span class="code-line">        <span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line">        <span class="token keyword">with</span> io<span class="token punctuation">.</span>BytesIO<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
</span><span class="code-line">            img<span class="token punctuation">.</span>save<span class="token punctuation">(</span>f<span class="token punctuation">,</span> <span class="token string">&quot;JPEG&quot;</span><span class="token punctuation">,</span> quality<span class="token operator">=</span>quality<span class="token punctuation">)</span>
</span><span class="code-line">            img <span class="token operator">=</span> Image<span class="token punctuation">.</span><span class="token builtin">open</span><span class="token punctuation">(</span>io<span class="token punctuation">.</span>BytesIO<span class="token punctuation">(</span>f<span class="token punctuation">.</span>getvalue<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line">        out_tensor <span class="token operator">=</span> torch<span class="token punctuation">.</span>tensor<span class="token punctuation">(</span>
</span><span class="code-line">            np<span class="token punctuation">.</span>array<span class="token punctuation">(</span>img<span class="token punctuation">)</span><span class="token punctuation">.</span>swapaxes<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>swapaxes<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">255</span><span class="token punctuation">,</span>
</span><span class="code-line">            device<span class="token operator">=</span>img_tensor<span class="token punctuation">.</span>device<span class="token punctuation">,</span>
</span><span class="code-line">            dtype<span class="token operator">=</span>torch<span class="token punctuation">.</span>float32<span class="token punctuation">,</span>
</span><span class="code-line">        <span class="token punctuation">)</span>
</span><span class="code-line">        out_tensors<span class="token punctuation">.</span>append<span class="token punctuation">(</span>out_tensor<span class="token punctuation">)</span>
</span><span class="code-line">    out_tensors <span class="token operator">=</span> torch<span class="token punctuation">.</span>stack<span class="token punctuation">(</span>out_tensors<span class="token punctuation">)</span>
</span><span class="code-line">    <span class="token keyword">return</span> out_tensors
</span><span class="code-line">
</span><span class="code-line">model <span class="token operator">=</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
</span><span class="code-line">np_original <span class="token operator">=</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
</span><span class="code-line">
</span><span class="code-line">openmybook <span class="token operator">=</span> T<span class="token punctuation">.</span>ToTensor<span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">normalize <span class="token operator">=</span> T<span class="token punctuation">.</span>Normalize<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0.485</span><span class="token punctuation">,</span> <span class="token number">0.456</span><span class="token punctuation">,</span> <span class="token number">0.406</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">0.229</span><span class="token punctuation">,</span> <span class="token number">0.224</span><span class="token punctuation">,</span> <span class="token number">0.225</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</span><span class="code-line">reading_glasses <span class="token operator">=</span> T<span class="token punctuation">.</span>RandomResizedCrop<span class="token punctuation">(</span><span class="token number">384</span><span class="token punctuation">,</span> antialias<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">for</span> target_id <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">383</span><span class="token punctuation">,</span> <span class="token number">388</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
</span><span class="code-line">    breed <span class="token operator">=</span> model<span class="token punctuation">.</span>config<span class="token punctuation">.</span>id2label<span class="token punctuation">[</span>target_id<span class="token punctuation">]</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">&quot;,&quot;</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
</span><span class="code-line">    inp <span class="token operator">=</span> <span class="token builtin">input</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;I love cats! My favorite breed is </span><span class="token interpolation"><span class="token punctuation">{</span>breed<span class="token punctuation">}</span></span><span class="token string">. Can you show me a picture of one?\n&quot;</span></span><span class="token punctuation">)</span>
</span><span class="code-line">    <span class="token keyword">try</span><span class="token punctuation">:</span>
</span><span class="code-line">        np_breed <span class="token operator">=</span> np<span class="token punctuation">.</span>frombuffer<span class="token punctuation">(</span>base64<span class="token punctuation">.</span>standard_b64decode<span class="token punctuation">(</span>inp<span class="token punctuation">)</span><span class="token punctuation">,</span> dtype<span class="token operator">=</span>np<span class="token punctuation">.</span>uint8<span class="token punctuation">)</span>
</span><span class="code-line">        np_breed <span class="token operator">=</span> np_breed<span class="token punctuation">.</span>reshape<span class="token punctuation">(</span>np_original<span class="token punctuation">.</span>shape<span class="token punctuation">)</span>
</span><span class="code-line">        <span class="token keyword">assert</span> np<span class="token punctuation">.</span><span class="token builtin">max</span><span class="token punctuation">(</span>np<span class="token punctuation">.</span><span class="token builtin">abs</span><span class="token punctuation">(</span>np_original<span class="token punctuation">.</span>astype<span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token operator">-</span> np_breed<span class="token punctuation">.</span>astype<span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">10</span>
</span><span class="code-line">    <span class="token keyword">except</span><span class="token punctuation">:</span>
</span><span class="code-line">        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;Sorry I only like cats that look exactly like my cat!&quot;</span><span class="token punctuation">,</span> flush<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
</span><span class="code-line">        sys<span class="token punctuation">.</span>exit<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line">    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
</span><span class="code-line">
</span><span class="code-line">        image <span class="token operator">=</span> Image<span class="token punctuation">.</span>fromarray<span class="token punctuation">(</span>np_breed<span class="token punctuation">.</span>astype<span class="token punctuation">(</span>np<span class="token punctuation">.</span>uint8<span class="token punctuation">)</span><span class="token punctuation">)</span>
</span><span class="code-line">        x <span class="token operator">=</span> openmybook<span class="token punctuation">(</span>image<span class="token punctuation">)</span> <span class="token comment"># ToTensor</span>
</span><span class="code-line">        x <span class="token operator">=</span> x<span class="token punctuation">.</span>unsqueeze<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
</span><span class="code-line">        x <span class="token operator">=</span> pytorch_jpeg_compress<span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token comment"># RandomCompress</span>
</span><span class="code-line">        x <span class="token operator">=</span> normalize<span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token comment"># ImageNet normalization</span>
</span><span class="code-line">        x <span class="token operator">=</span> reading_glasses<span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token comment"># RandomResizedCrop</span>
</span><span class="code-line">
</span><span class="code-line">        <span class="token keyword">with</span> torch<span class="token punctuation">.</span>no_grad<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
</span><span class="code-line">            logits <span class="token operator">=</span> model<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">.</span>logits
</span><span class="code-line">
</span><span class="code-line">        <span class="token keyword">if</span> torch<span class="token punctuation">.</span>argmax<span class="token punctuation">(</span>logits<span class="token punctuation">)</span><span class="token punctuation">.</span>item<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> target_id<span class="token punctuation">:</span>
</span><span class="code-line">            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;That doesn&#x27;t look like a </span><span class="token interpolation"><span class="token punctuation">{</span>breed<span class="token punctuation">}</span></span><span class="token string">!&quot;</span></span><span class="token punctuation">)</span>
</span><span class="code-line">            sys<span class="token punctuation">.</span>exit<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">&quot;flag.txt&quot;</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
</span><span class="code-line">    <span class="token keyword">print</span><span class="token punctuation">(</span>f<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</span></code></pre>
<p class="mr-4 subtext" style="font-size:0.75rem">full code: <a href="https://github.com/dicegang/dicectf-quals-2024-challenges/blob/main/misc/what-a-jpeg-is/challenge/challenge.py">https://github.com/dicegang/dicectf-quals-2024-challenges/blob/main/misc/what-a-jpeg-is/challenge/challenge.py</a></p>
<p>A couple of things to note:</p>
<ul>
<li>The adversarial example needs to be within <strong><code class="language-math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>9</mn></mrow><annotation encoding="application/x-tex">9</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord">9</span></span></span></span></code> pixels</strong> of the original image.</li>
<li>The adversarial example needs to be robust to <strong>JPEG compression</strong>, <strong>random crops</strong>, and <strong>resizing</strong>.</li>
<li>We need to generate 5 <strong>confident</strong> adversarial examples in a row (we can&#x27;t just get lucky on one).</li>
</ul>
<p>We already know how we can generate a <strong>confident</strong> adversarial example through iterative training, methods like FSGM won&#x27;t work for us here.
Generating robust examples will be the real challenge.</p>
<p>We can apply the same augmentations during each iteration loop and apply the gradients slowly until we each the final image. This will create a both a confident and robust adversarial example. The only problem here is that JPEG lossy image encoding is non-differentiable, we can&#x27;t simply use it out of the box for backward propagation.</p>
<p>After some research it looks like there&#x27;s already some papers that tackle the same problem:</p>
<ul>
<li><a href="https://arxiv.org/abs/2309.06978">Reich, Christoph, et al. &quot;Differentiable jpeg: The devil is in the details.&quot; 2024.</a> <a href="https://github.com/necla-ml/Diff-JPEG">(Code)</a></li>
<li><a href="https://machine-learning-and-security.github.io/papers/mlsec17_paper_54.pdf">Shin, Richard, and Dawn Song. &quot;Jpeg-resistant adversarial images.&quot; 2017.</a> <a href="https://github.com/mlomnitz/DiffJPEG">(Code)</a></li>
</ul>
<p>When I was doing the challenge, I only found the 2017 paper and their codea but the challenge probably could be solved with either (I actually later found out that since quality isn&#x27;t drastic, it is possible to solve by ignoring the JPEG compression entirely).</p>
<p>Let&#x27;s try to do both iterative methods (simple gradient following and following the sign of the gradient).</p>
<pre class="language-python"><code class="language-python code-highlight"><span class="code-line">n_iterations <span class="token operator">=</span> <span class="token number">100</span>
</span><span class="code-line">target_output <span class="token operator">=</span> torch<span class="token punctuation">.</span>tensor<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">383</span><span class="token punctuation">]</span><span class="token punctuation">,</span> dtype<span class="token operator">=</span>torch<span class="token punctuation">.</span><span class="token builtin">long</span><span class="token punctuation">,</span> device<span class="token operator">=</span>device<span class="token punctuation">)</span> <span class="token comment"># do the same for 383 - 388</span>
</span><span class="code-line">eps <span class="token operator">=</span> <span class="token number">8.</span> <span class="token operator">/</span> <span class="token number">255.</span> <span class="token comment"># perturbation size, set lower than needed for rounding errors</span>
</span><span class="code-line">bs <span class="token operator">=</span> <span class="token number">8</span> <span class="token comment"># batch size - not really needed, but stabilizes training and improves convergence &amp; consistency of adversarial examples</span>
</span><span class="code-line">
</span><span class="code-line">x <span class="token operator">=</span> img_original_tensor<span class="token punctuation">.</span>clone<span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">x<span class="token punctuation">.</span>requires_grad <span class="token operator">=</span> <span class="token boolean">True</span>
</span><span class="code-line"><span class="token comment"># helps as each forward pass is different, helps stabilize training</span>
</span><span class="code-line"><span class="token keyword">def</span> <span class="token function">forward</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">:</span>
</span><span class="code-line">    x <span class="token operator">=</span> differentiable_jpeg<span class="token punctuation">(</span>x<span class="token punctuation">,</span> random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">90</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># check the full code</span>
</span><span class="code-line">    x <span class="token operator">=</span> normalize<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
</span><span class="code-line">    x <span class="token operator">=</span> random_crop<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
</span><span class="code-line">    x <span class="token operator">=</span> model<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">.</span>logits
</span><span class="code-line">    <span class="token keyword">return</span> x
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">for</span> iteration <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>n_iterations<span class="token punctuation">)</span><span class="token punctuation">:</span>
</span><span class="code-line">    optimizer<span class="token punctuation">.</span>zero_grad<span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">    
</span><span class="code-line">    logits <span class="token operator">=</span> forward<span class="token punctuation">(</span>torch<span class="token punctuation">.</span>cat<span class="token punctuation">(</span><span class="token punctuation">[</span>x<span class="token punctuation">]</span> <span class="token operator">*</span> bs<span class="token punctuation">,</span> dim<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</span><span class="code-line">    loss <span class="token operator">=</span> loss_func<span class="token punctuation">(</span>logits<span class="token punctuation">,</span> torch<span class="token punctuation">.</span>cat<span class="token punctuation">(</span><span class="token punctuation">[</span>target_output<span class="token punctuation">]</span> <span class="token operator">*</span> bs<span class="token punctuation">,</span> dim<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</span><span class="code-line">    loss<span class="token punctuation">.</span>backward<span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line">    optimizer<span class="token punctuation">.</span>step<span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line">    x<span class="token punctuation">.</span>data <span class="token operator">=</span> torch<span class="token punctuation">.</span>clamp<span class="token punctuation">(</span>x<span class="token punctuation">.</span>data<span class="token punctuation">,</span> img_original_tensor <span class="token operator">-</span> eps<span class="token punctuation">,</span> img_original_tensor <span class="token operator">+</span> eps<span class="token punctuation">)</span>
</span></code></pre>
<p class="mr-4 subtext" style="font-size:0.75rem">full code: <a href="https://github.com/OutWrest/blog-handouts/blob/main/exploring-attacks-1/what-jpeg-is-DiceCTF-2024.ipynb">https://github.com/OutWrest/blog-handouts/blob/main/exploring-attacks-1/what-jpeg-is-DiceCTF-2024.ipynb</a></p>
<p>Output:</p>
<pre class="language-bash"><code class="language-bash code-highlight"><span class="code-line">Iter: <span class="token number">0</span>    <span class="token operator">|</span> Loss:  <span class="token number">8.5492</span> <span class="token operator">|</span> Pred: <span class="token number">281</span> <span class="token punctuation">(</span><span class="token number">54.20</span>%<span class="token punctuation">)</span> <span class="token operator">|</span> min/mean/max diff: <span class="token number">0.00</span>/1.44/3.00
</span><span class="code-line">Iter: <span class="token number">10</span>   <span class="token operator">|</span> Loss:  <span class="token number">0.2835</span> <span class="token operator">|</span> Pred: <span class="token number">383</span> <span class="token punctuation">(</span><span class="token number">75.32</span>%<span class="token punctuation">)</span> <span class="token operator">|</span> min/mean/max diff: <span class="token number">0.00</span>/5.35/9.00
</span><span class="code-line">Iter: <span class="token number">20</span>   <span class="token operator">|</span> Loss:  <span class="token number">0.1862</span> <span class="token operator">|</span> Pred: <span class="token number">383</span> <span class="token punctuation">(</span><span class="token number">83.01</span>%<span class="token punctuation">)</span> <span class="token operator">|</span> min/mean/max diff: <span class="token number">0.00</span>/6.11/9.00
</span><span class="code-line">Iter: <span class="token number">30</span>   <span class="token operator">|</span> Loss:  <span class="token number">0.1670</span> <span class="token operator">|</span> Pred: <span class="token number">383</span> <span class="token punctuation">(</span><span class="token number">84.62</span>%<span class="token punctuation">)</span> <span class="token operator">|</span> min/mean/max diff: <span class="token number">0.00</span>/6.17/9.00
</span><span class="code-line">Iter: <span class="token number">40</span>   <span class="token operator">|</span> Loss:  <span class="token number">0.4805</span> <span class="token operator">|</span> Pred: <span class="token number">383</span> <span class="token punctuation">(</span><span class="token number">61.85</span>%<span class="token punctuation">)</span> <span class="token operator">|</span> min/mean/max diff: <span class="token number">0.00</span>/6.03/9.00
</span><span class="code-line">Iter: <span class="token number">50</span>   <span class="token operator">|</span> Loss:  <span class="token number">0.1488</span> <span class="token operator">|</span> Pred: <span class="token number">383</span> <span class="token punctuation">(</span><span class="token number">86.17</span>%<span class="token punctuation">)</span> <span class="token operator">|</span> min/mean/max diff: <span class="token number">0.00</span>/6.14/9.00
</span><span class="code-line">Iter: <span class="token number">60</span>   <span class="token operator">|</span> Loss:  <span class="token number">0.0966</span> <span class="token operator">|</span> Pred: <span class="token number">383</span> <span class="token punctuation">(</span><span class="token number">90.80</span>%<span class="token punctuation">)</span> <span class="token operator">|</span> min/mean/max diff: <span class="token number">0.00</span>/6.15/9.00
</span><span class="code-line">Iter: <span class="token number">70</span>   <span class="token operator">|</span> Loss:  <span class="token number">0.1279</span> <span class="token operator">|</span> Pred: <span class="token number">383</span> <span class="token punctuation">(</span><span class="token number">88.00</span>%<span class="token punctuation">)</span> <span class="token operator">|</span> min/mean/max diff: <span class="token number">0.00</span>/6.10/9.00
</span><span class="code-line">Iter: <span class="token number">80</span>   <span class="token operator">|</span> Loss:  <span class="token number">0.0514</span> <span class="token operator">|</span> Pred: <span class="token number">383</span> <span class="token punctuation">(</span><span class="token number">94.99</span>%<span class="token punctuation">)</span> <span class="token operator">|</span> min/mean/max diff: <span class="token number">0.00</span>/6.08/9.00
</span><span class="code-line">Iter: <span class="token number">90</span>   <span class="token operator">|</span> Loss:  <span class="token number">0.0598</span> <span class="token operator">|</span> Pred: <span class="token number">383</span> <span class="token punctuation">(</span><span class="token number">94.19</span>%<span class="token punctuation">)</span> <span class="token operator">|</span> min/mean/max diff: <span class="token number">0.00</span>/6.09/9.00
</span></code></pre>
<div class="flex items-center justify-center flex-col"><img class="block" src="/post-assets/exploring-attacks-1/what-is-jpeg-is-DiceCTF-2024-simple.png" alt="Three images that showcase the adversarial attack."/><p class="mr-4 subtext" style="font-size:0.75rem">The output adversarial example on provided image using a simple iterative method.</p></div>
<p>With only <code class="language-math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>100</mn></mrow><annotation encoding="application/x-tex">100</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord">100</span></span></span></span></code> iterations, we easily were able to start making confident adversarial examples.
Let&#x27;s try out PGD and see if we able to get better results.</p>
<pre class="language-python"><code class="language-python code-highlight"><span class="code-line">n_iterations <span class="token operator">=</span> <span class="token number">100</span>
</span><span class="code-line">target_output <span class="token operator">=</span> torch<span class="token punctuation">.</span>tensor<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">383</span><span class="token punctuation">]</span><span class="token punctuation">,</span> dtype<span class="token operator">=</span>torch<span class="token punctuation">.</span><span class="token builtin">long</span><span class="token punctuation">,</span> device<span class="token operator">=</span>device<span class="token punctuation">)</span> <span class="token comment"># do the same for 383 - 388</span>
</span><span class="code-line">eps <span class="token operator">=</span> <span class="token number">8.</span> <span class="token operator">/</span> <span class="token number">255.</span> <span class="token comment"># perturbation size, set lower than needed for rounding errors</span>
</span><span class="code-line">bs <span class="token operator">=</span> <span class="token number">8</span> <span class="token comment"># batch size - not really needed, but stabilizes training and improves convergence &amp; consistency of adversarial examples</span>
</span><span class="code-line">alpha <span class="token operator">=</span> <span class="token number">.5</span> <span class="token operator">/</span> <span class="token number">255.</span> <span class="token comment"># step size</span>
</span><span class="code-line">
</span><span class="code-line">x <span class="token operator">=</span> img_original_tensor<span class="token punctuation">.</span>clone<span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">x<span class="token punctuation">.</span>requires_grad <span class="token operator">=</span> <span class="token boolean">True</span>
</span><span class="code-line">
</span><span class="code-line">loss_func <span class="token operator">=</span> torch<span class="token punctuation">.</span>nn<span class="token punctuation">.</span>CrossEntropyLoss<span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">def</span> <span class="token function">forward</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">:</span>
</span><span class="code-line">    x <span class="token operator">=</span> differentiable_jpeg<span class="token punctuation">(</span>x<span class="token punctuation">,</span> random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">90</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</span><span class="code-line">    x <span class="token operator">=</span> normalize<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
</span><span class="code-line">    x <span class="token operator">=</span> random_crop<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
</span><span class="code-line">    x <span class="token operator">=</span> model<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">.</span>logits
</span><span class="code-line">    <span class="token keyword">return</span> x
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">for</span> iteration <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>n_iterations<span class="token punctuation">)</span><span class="token punctuation">:</span>
</span><span class="code-line">    optimizer<span class="token punctuation">.</span>zero_grad<span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">    
</span><span class="code-line">    logits <span class="token operator">=</span> forward<span class="token punctuation">(</span>torch<span class="token punctuation">.</span>cat<span class="token punctuation">(</span><span class="token punctuation">[</span>x<span class="token punctuation">]</span> <span class="token operator">*</span> bs<span class="token punctuation">,</span> dim<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># helps as each forward pass is different, helps stabilize training</span>
</span><span class="code-line">    loss <span class="token operator">=</span> loss_func<span class="token punctuation">(</span>logits<span class="token punctuation">,</span> torch<span class="token punctuation">.</span>cat<span class="token punctuation">(</span><span class="token punctuation">[</span>target_output<span class="token punctuation">]</span> <span class="token operator">*</span> bs<span class="token punctuation">,</span> dim<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</span><span class="code-line">    
</span><span class="code-line">    grad <span class="token operator">=</span> torch<span class="token punctuation">.</span>autograd<span class="token punctuation">.</span>grad<span class="token punctuation">(</span>loss<span class="token punctuation">,</span> x<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
</span><span class="code-line">    
</span><span class="code-line">    x<span class="token punctuation">.</span>data <span class="token operator">=</span> x<span class="token punctuation">.</span>data <span class="token operator">-</span> alpha <span class="token operator">*</span> torch<span class="token punctuation">.</span>sign<span class="token punctuation">(</span>grad<span class="token punctuation">)</span>
</span><span class="code-line">    x<span class="token punctuation">.</span>data <span class="token operator">=</span> torch<span class="token punctuation">.</span>clamp<span class="token punctuation">(</span>x<span class="token punctuation">.</span>data<span class="token punctuation">,</span> img_original_tensor <span class="token operator">-</span> eps<span class="token punctuation">,</span> img_original_tensor <span class="token operator">+</span> eps<span class="token punctuation">)</span>
</span></code></pre>
<p class="mr-4 subtext" style="font-size:0.75rem">full code: <a href="https://github.com/OutWrest/blog-handouts/blob/main/exploring-attacks-1/what-jpeg-is-DiceCTF-2024.ipynb">https://github.com/OutWrest/blog-handouts/blob/main/exploring-attacks-1/what-jpeg-is-DiceCTF-2024.ipynb</a></p>
<p>Output:</p>
<pre class="language-bash"><code class="language-bash code-highlight"><span class="code-line">Iter: <span class="token number">0</span>    <span class="token operator">|</span> Loss:  <span class="token number">9.8105</span> <span class="token operator">|</span> Pred: <span class="token number">281</span> <span class="token punctuation">(</span><span class="token number">48.51</span>%<span class="token punctuation">)</span> <span class="token operator">|</span> min/mean/max diff: <span class="token number">0.00</span>/0.06/1.00
</span><span class="code-line">Iter: <span class="token number">10</span>   <span class="token operator">|</span> Loss:  <span class="token number">4.3521</span> <span class="token operator">|</span> Pred: <span class="token number">281</span> <span class="token punctuation">(</span><span class="token number">40.86</span>%<span class="token punctuation">)</span> <span class="token operator">|</span> min/mean/max diff: <span class="token number">0.00</span>/0.87/5.00
</span><span class="code-line">Iter: <span class="token number">20</span>   <span class="token operator">|</span> Loss:  <span class="token number">5.0837</span> <span class="token operator">|</span> Pred: <span class="token number">281</span> <span class="token punctuation">(</span><span class="token number">35.09</span>%<span class="token punctuation">)</span> <span class="token operator">|</span> min/mean/max diff: <span class="token number">0.00</span>/1.42/8.00
</span><span class="code-line">Iter: <span class="token number">30</span>   <span class="token operator">|</span> Loss:  <span class="token number">0.6920</span> <span class="token operator">|</span> Pred: <span class="token number">383</span> <span class="token punctuation">(</span><span class="token number">50.06</span>%<span class="token punctuation">)</span> <span class="token operator">|</span> min/mean/max diff: <span class="token number">0.00</span>/1.82/9.00
</span><span class="code-line">Iter: <span class="token number">40</span>   <span class="token operator">|</span> Loss:  <span class="token number">0.1363</span> <span class="token operator">|</span> Pred: <span class="token number">383</span> <span class="token punctuation">(</span><span class="token number">87.25</span>%<span class="token punctuation">)</span> <span class="token operator">|</span> min/mean/max diff: <span class="token number">0.00</span>/2.05/9.00
</span><span class="code-line">Iter: <span class="token number">50</span>   <span class="token operator">|</span> Loss:  <span class="token number">0.0625</span> <span class="token operator">|</span> Pred: <span class="token number">383</span> <span class="token punctuation">(</span><span class="token number">93.94</span>%<span class="token punctuation">)</span> <span class="token operator">|</span> min/mean/max diff: <span class="token number">0.00</span>/2.22/9.00
</span><span class="code-line">Iter: <span class="token number">60</span>   <span class="token operator">|</span> Loss:  <span class="token number">0.0259</span> <span class="token operator">|</span> Pred: <span class="token number">383</span> <span class="token punctuation">(</span><span class="token number">97.44</span>%<span class="token punctuation">)</span> <span class="token operator">|</span> min/mean/max diff: <span class="token number">0.00</span>/2.46/9.00
</span><span class="code-line">Iter: <span class="token number">70</span>   <span class="token operator">|</span> Loss:  <span class="token number">5.2534</span> <span class="token operator">|</span> Pred: <span class="token number">281</span> <span class="token punctuation">(</span><span class="token number">27.16</span>%<span class="token punctuation">)</span> <span class="token operator">|</span> min/mean/max diff: <span class="token number">0.00</span>/2.70/9.00
</span><span class="code-line">Iter: <span class="token number">80</span>   <span class="token operator">|</span> Loss:  <span class="token number">0.0133</span> <span class="token operator">|</span> Pred: <span class="token number">383</span> <span class="token punctuation">(</span><span class="token number">98.68</span>%<span class="token punctuation">)</span> <span class="token operator">|</span> min/mean/max diff: <span class="token number">0.00</span>/2.89/9.00
</span><span class="code-line">Iter: <span class="token number">90</span>   <span class="token operator">|</span> Loss:  <span class="token number">0.0045</span> <span class="token operator">|</span> Pred: <span class="token number">383</span> <span class="token punctuation">(</span><span class="token number">99.55</span>%<span class="token punctuation">)</span> <span class="token operator">|</span> min/mean/max diff: <span class="token number">0.00</span>/3.13/9.00
</span></code></pre>
<p>PDG is able generate more confident examples at a lesser perturbation difference. Please check out the full code listed above, it should be all reproducible.</p>
<div class="flex items-center justify-center flex-col"><img class="block" src="/post-assets/exploring-attacks-1/what-is-jpeg-is-DiceCTF-2024-pgd.png" alt="Three images that showcase the adversarial attack."/><p class="mr-4 subtext" style="font-size:0.75rem">The output adversarial example on provided image using PGD.</p></div>
<p>To solve the rest the challenge, we just need to do this 5 more times and try them out remote machine.
I do not have the full solve code here but you can easily extend the scripts I have provided to do so.</p>
<br/>
<div class="flex items-center justify-center"><div class="rounded-md p-4 border w-11/12 bg-gray-100 dark:bg-gray-800 dark:border-gray-700"><div class="flex justify-between"><div><h2 class="font-bold text-xl mb-2 mt-0">misc / <!-- -->i-hate-anime-girls</h2><p class="text-gray-700 text-base mt-0">segal</p></div><div class="text-right"><p class="font-semibold mb-2 mt-0">6 solves / 396 points</p><a class="text-gray-700 text-base mt-0" target="_blank" rel="noopener noreferrer" href="https://ctftime.org/event/2165/">osu!gaming CTF 2024</a></div></div><div class="mt-0"><div class="max-w-none prose prose-a:text-pink-600 dark:prose-invert"><p>osu! players love their anime girls. But I HATE anime girls. So much so that I trained a neural network to filter my map backgrounds.
But tbh, I really want to pp farm hitorigoto and my map filter won&#x27;t let me. Can you fool it?</p><pre class="bg-gray-900">nc chal.osugaming.lol 7274</pre></div></div></div></div>
<br/>
<p>This challenge comes with 3 different files, <code>hitorigoto.png</code>, <code>model.pt</code>, and <code>server.py</code>. Let&#x27;s explore the code first to figure out how to get the flag.</p>
<pre class="language-python"><code class="language-python code-highlight"><span class="code-line">model <span class="token operator">=</span> resnet18<span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">model<span class="token punctuation">.</span>fc <span class="token operator">=</span> nn<span class="token punctuation">.</span>Linear<span class="token punctuation">(</span>model<span class="token punctuation">.</span>fc<span class="token punctuation">.</span>in_features<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
</span><span class="code-line">model<span class="token punctuation">.</span>load_state_dict<span class="token punctuation">(</span>torch<span class="token punctuation">.</span>load<span class="token punctuation">(</span><span class="token string">&quot;model.pt&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line">resize <span class="token operator">=</span> T<span class="token punctuation">.</span>Resize<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">224</span><span class="token punctuation">,</span> <span class="token number">224</span><span class="token punctuation">)</span><span class="token punctuation">,</span> antialias<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span>
</span><span class="code-line">to_tensor <span class="token operator">=</span> T<span class="token punctuation">.</span>ToTensor<span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">normalize <span class="token operator">=</span> T<span class="token punctuation">.</span>Normalize<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0.485</span><span class="token punctuation">,</span> <span class="token number">0.456</span><span class="token punctuation">,</span> <span class="token number">0.406</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">0.229</span><span class="token punctuation">,</span> <span class="token number">0.224</span><span class="token punctuation">,</span> <span class="token number">0.225</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line">original <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span>Image<span class="token punctuation">.</span><span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">&quot;hitorigoto.png&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line">inp <span class="token operator">=</span> <span class="token builtin">input</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;Enter a base64 encoded image.\n&quot;</span></span><span class="token punctuation">)</span>
</span><span class="code-line"><span class="token keyword">try</span><span class="token punctuation">:</span>
</span><span class="code-line">    img <span class="token operator">=</span> np<span class="token punctuation">.</span>frombuffer<span class="token punctuation">(</span>base64<span class="token punctuation">.</span>standard_b64decode<span class="token punctuation">(</span>inp<span class="token punctuation">)</span><span class="token punctuation">,</span> dtype<span class="token operator">=</span>np<span class="token punctuation">.</span>uint8<span class="token punctuation">)</span>
</span><span class="code-line">    img <span class="token operator">=</span> img<span class="token punctuation">.</span>reshape<span class="token punctuation">(</span>original<span class="token punctuation">.</span>shape<span class="token punctuation">)</span>
</span><span class="code-line">    <span class="token keyword">assert</span> np<span class="token punctuation">.</span><span class="token builtin">max</span><span class="token punctuation">(</span>np<span class="token punctuation">.</span><span class="token builtin">abs</span><span class="token punctuation">(</span>original<span class="token punctuation">.</span>astype<span class="token punctuation">(</span>np<span class="token punctuation">.</span>int32<span class="token punctuation">)</span> <span class="token operator">-</span> img<span class="token punctuation">.</span>astype<span class="token punctuation">(</span>np<span class="token punctuation">.</span>int32<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&lt;=</span> <span class="token number">8</span>
</span><span class="code-line"><span class="token keyword">except</span><span class="token punctuation">:</span>
</span><span class="code-line">    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;That doesn&#x27;t look like hitorigoto!&quot;</span><span class="token punctuation">)</span>
</span><span class="code-line">    sys<span class="token punctuation">.</span>exit<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line">image <span class="token operator">=</span> Image<span class="token punctuation">.</span>fromarray<span class="token punctuation">(</span>img<span class="token punctuation">)</span>
</span><span class="code-line">x <span class="token operator">=</span> normalize<span class="token punctuation">(</span>resize<span class="token punctuation">(</span>to_tensor<span class="token punctuation">(</span>image<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>unsqueeze<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</span><span class="code-line"><span class="token keyword">with</span> torch<span class="token punctuation">.</span>no_grad<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
</span><span class="code-line">    y <span class="token operator">=</span> torch<span class="token punctuation">.</span>sigmoid<span class="token punctuation">(</span>model<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">if</span> y <span class="token operator">&lt;</span> <span class="token number">0.5</span><span class="token punctuation">:</span>
</span><span class="code-line">    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;That&#x27;s obviously an anime girl.&quot;</span><span class="token punctuation">)</span>
</span><span class="code-line">    sys<span class="token punctuation">.</span>exit<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
</span><span class="code-line"><span class="token keyword">elif</span> y <span class="token operator">&lt;</span> <span class="token number">0.825</span><span class="token punctuation">:</span>
</span><span class="code-line">    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;I&#x27;m not fully convinced that&#x27;s not an anime girl.&quot;</span><span class="token punctuation">)</span>
</span><span class="code-line">    sys<span class="token punctuation">.</span>exit<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">&quot;flag.txt&quot;</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
</span><span class="code-line">    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;Surely that&#x27;s not an anime girl.&quot;</span><span class="token punctuation">)</span>
</span><span class="code-line">    <span class="token keyword">print</span><span class="token punctuation">(</span>f<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</span></code></pre>
<p class="mr-4 subtext" style="font-size:0.75rem">full code: <a href="https://drive.google.com/file/d/1qqJ2xrlrvppz50bjAzmfhpX66Y-UkqnM/view">https://drive.google.com/file/d/1qqJ2xrlrvppz50bjAzmfhpX66Y-UkqnM/view</a></p>
<p>The whole point of this challenge seems to be able to create a confident (&gt;82.5% confidence) adversarial example from the given image that is able to be resistant against the resizing.
We already know how to do this, but this challenge posed a problem for me initially. I was getting very inconsistent results.
I found out the challenge author left <code>.eval()</code> in the code.
This left the current model in training mode. For us, this just means that it will be harder to generate adversarial example because the batch normalization layers won&#x27;t be applied to our input.</p>
<p>Let&#x27;s try the same two methods in the previous challenge on this one.</p>
<pre class="language-python"><code class="language-python code-highlight"><span class="code-line">n_iterations <span class="token operator">=</span> <span class="token number">1250</span>
</span><span class="code-line">eps <span class="token operator">=</span> <span class="token number">7.</span> <span class="token operator">/</span> <span class="token number">255.</span>
</span><span class="code-line">bs <span class="token operator">=</span> <span class="token number">32</span> <span class="token comment"># not needed</span>
</span><span class="code-line">
</span><span class="code-line">x <span class="token operator">=</span> img_original_tensor<span class="token punctuation">.</span>clone<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>detach<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>requires_grad_<span class="token punctuation">(</span><span class="token boolean">True</span><span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token comment"># made use of lr_scheduler to reduce the learning rate when the loss stops decreasing</span>
</span><span class="code-line"><span class="token comment"># this helps model converge as this problem is hard to optimize</span>
</span><span class="code-line">optimizer <span class="token operator">=</span> torch<span class="token punctuation">.</span>optim<span class="token punctuation">.</span>Adam<span class="token punctuation">(</span><span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token punctuation">,</span> lr<span class="token operator">=</span><span class="token number">5e-1</span><span class="token punctuation">)</span> <span class="token comment"># we will only optimize the input image</span>
</span><span class="code-line">lr_scheduler <span class="token operator">=</span> torch<span class="token punctuation">.</span>optim<span class="token punctuation">.</span>lr_scheduler<span class="token punctuation">.</span>ReduceLROnPlateau<span class="token punctuation">(</span>optimizer<span class="token punctuation">,</span> patience<span class="token operator">=</span><span class="token number">50</span><span class="token punctuation">,</span> verbose<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> factor<span class="token operator">=</span><span class="token number">0.5</span><span class="token punctuation">)</span>
</span><span class="code-line">loss_func <span class="token operator">=</span> nn<span class="token punctuation">.</span>BCEWithLogitsLoss<span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">def</span> <span class="token function">forward</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">:</span>
</span><span class="code-line">    x <span class="token operator">=</span> resize<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
</span><span class="code-line">    x <span class="token operator">=</span> normalize<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
</span><span class="code-line">    x <span class="token operator">=</span> model<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
</span><span class="code-line">    <span class="token keyword">return</span> x
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">for</span> iteration <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>n_iterations<span class="token punctuation">)</span><span class="token punctuation">:</span>
</span><span class="code-line">    optimizer<span class="token punctuation">.</span>zero_grad<span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line">    logits <span class="token operator">=</span> forward<span class="token punctuation">(</span>torch<span class="token punctuation">.</span>cat<span class="token punctuation">(</span><span class="token punctuation">[</span>x<span class="token punctuation">]</span> <span class="token operator">*</span> bs<span class="token punctuation">,</span> dim<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># bs not needed</span>
</span><span class="code-line">    loss <span class="token operator">=</span> loss_func<span class="token punctuation">(</span>logits<span class="token punctuation">,</span> torch<span class="token punctuation">.</span>ones_like<span class="token punctuation">(</span>logits<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># maximize the output of the model</span>
</span><span class="code-line">    loss<span class="token punctuation">.</span>backward<span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line">    optimizer<span class="token punctuation">.</span>step<span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line">    lr_scheduler<span class="token punctuation">.</span>step<span class="token punctuation">(</span>loss<span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line">    x<span class="token punctuation">.</span>data <span class="token operator">=</span> torch<span class="token punctuation">.</span>clamp<span class="token punctuation">(</span>x<span class="token punctuation">.</span>data<span class="token punctuation">,</span> img_original_tensor <span class="token operator">-</span> eps<span class="token punctuation">,</span> img_original_tensor <span class="token operator">+</span> eps<span class="token punctuation">)</span>
</span></code></pre>
<p class="mr-4 subtext" style="font-size:0.75rem">full code: <a href="https://github.com/OutWrest/blog-handouts/blob/main/exploring-attacks-1/i-hate-anime-girls-osugaming-2024.ipynb">https://github.com/OutWrest/blog-handouts/blob/main/exploring-attacks-1/i-hate-anime-girls-osugaming-2024.ipynb</a></p>
<p>Output:</p>
<pre class="language-bash"><code class="language-bash code-highlight"><span class="code-line">Iter: <span class="token number">0</span>    <span class="token operator">|</span> Loss:  <span class="token number">2.0104</span> <span class="token operator">|</span> Pred:  <span class="token number">0.1339</span> <span class="token operator">|</span> min/mean/max diff: <span class="token number">0.00</span>/4.80/8.00
</span><span class="code-line">Iter: <span class="token number">62</span>   <span class="token operator">|</span> Loss:  <span class="token number">0.8145</span> <span class="token operator">|</span> Pred:  <span class="token number">0.4429</span> <span class="token operator">|</span> min/mean/max diff: <span class="token number">0.00</span>/4.46/8.00
</span><span class="code-line">Iter: <span class="token number">124</span>  <span class="token operator">|</span> Loss:  <span class="token number">0.7141</span> <span class="token operator">|</span> Pred:  <span class="token number">0.4896</span> <span class="token operator">|</span> min/mean/max diff: <span class="token number">0.00</span>/4.50/8.00
</span><span class="code-line">Iter: <span class="token number">186</span>  <span class="token operator">|</span> Loss:  <span class="token number">0.4650</span> <span class="token operator">|</span> Pred:  <span class="token number">0.6282</span> <span class="token operator">|</span> min/mean/max diff: <span class="token number">0.00</span>/4.40/8.00
</span><span class="code-line">Iter: <span class="token number">248</span>  <span class="token operator">|</span> Loss:  <span class="token number">0.4427</span> <span class="token operator">|</span> Pred:  <span class="token number">0.6423</span> <span class="token operator">|</span> min/mean/max diff: <span class="token number">0.00</span>/4.45/8.00
</span><span class="code-line">Iter: <span class="token number">310</span>  <span class="token operator">|</span> Loss:  <span class="token number">0.3205</span> <span class="token operator">|</span> Pred:  <span class="token number">0.7258</span> <span class="token operator">|</span> min/mean/max diff: <span class="token number">0.00</span>/4.26/8.00
</span><span class="code-line">Iter: <span class="token number">372</span>  <span class="token operator">|</span> Loss:  <span class="token number">0.3281</span> <span class="token operator">|</span> Pred:  <span class="token number">0.7203</span> <span class="token operator">|</span> min/mean/max diff: <span class="token number">0.00</span>/4.12/8.00
</span><span class="code-line">Iter: <span class="token number">434</span>  <span class="token operator">|</span> Loss:  <span class="token number">0.2920</span> <span class="token operator">|</span> Pred:  <span class="token number">0.7468</span> <span class="token operator">|</span> min/mean/max diff: <span class="token number">0.00</span>/3.94/8.00
</span><span class="code-line">Iter: <span class="token number">496</span>  <span class="token operator">|</span> Loss:  <span class="token number">0.2534</span> <span class="token operator">|</span> Pred:  <span class="token number">0.7762</span> <span class="token operator">|</span> min/mean/max diff: <span class="token number">0.00</span>/3.69/8.00
</span><span class="code-line">Iter: <span class="token number">558</span>  <span class="token operator">|</span> Loss:  <span class="token number">0.1844</span> <span class="token operator">|</span> Pred:  <span class="token number">0.8316</span> <span class="token operator">|</span> min/mean/max diff: <span class="token number">0.00</span>/3.61/8.00
</span><span class="code-line">Iter: <span class="token number">620</span>  <span class="token operator">|</span> Loss:  <span class="token number">0.1768</span> <span class="token operator">|</span> Pred:  <span class="token number">0.8380</span> <span class="token operator">|</span> min/mean/max diff: <span class="token number">0.00</span>/3.63/8.00
</span><span class="code-line">Iter: <span class="token number">682</span>  <span class="token operator">|</span> Loss:  <span class="token number">0.1810</span> <span class="token operator">|</span> Pred:  <span class="token number">0.8344</span> <span class="token operator">|</span> min/mean/max diff: <span class="token number">0.00</span>/3.67/8.00
</span><span class="code-line">Iter: <span class="token number">744</span>  <span class="token operator">|</span> Loss:  <span class="token number">0.1501</span> <span class="token operator">|</span> Pred:  <span class="token number">0.8606</span> <span class="token operator">|</span> min/mean/max diff: <span class="token number">0.00</span>/3.66/8.00
</span><span class="code-line">Iter: <span class="token number">806</span>  <span class="token operator">|</span> Loss:  <span class="token number">0.1472</span> <span class="token operator">|</span> Pred:  <span class="token number">0.8631</span> <span class="token operator">|</span> min/mean/max diff: <span class="token number">0.00</span>/3.66/8.00
</span><span class="code-line">Iter: <span class="token number">868</span>  <span class="token operator">|</span> Loss:  <span class="token number">0.1463</span> <span class="token operator">|</span> Pred:  <span class="token number">0.8639</span> <span class="token operator">|</span> min/mean/max diff: <span class="token number">0.00</span>/3.68/7.00
</span><span class="code-line">Iter: <span class="token number">930</span>  <span class="token operator">|</span> Loss:  <span class="token number">0.1309</span> <span class="token operator">|</span> Pred:  <span class="token number">0.8773</span> <span class="token operator">|</span> min/mean/max diff: <span class="token number">0.00</span>/3.68/8.00
</span><span class="code-line">Iter: <span class="token number">992</span>  <span class="token operator">|</span> Loss:  <span class="token number">0.1298</span> <span class="token operator">|</span> Pred:  <span class="token number">0.8783</span> <span class="token operator">|</span> min/mean/max diff: <span class="token number">0.00</span>/3.67/8.00
</span><span class="code-line">Iter: <span class="token number">1054</span> <span class="token operator">|</span> Loss:  <span class="token number">0.1285</span> <span class="token operator">|</span> Pred:  <span class="token number">0.8794</span> <span class="token operator">|</span> min/mean/max diff: <span class="token number">0.00</span>/3.68/8.00
</span><span class="code-line">Iter: <span class="token number">1116</span> <span class="token operator">|</span> Loss:  <span class="token number">0.1282</span> <span class="token operator">|</span> Pred:  <span class="token number">0.8796</span> <span class="token operator">|</span> min/mean/max diff: <span class="token number">0.00</span>/3.70/8.00
</span><span class="code-line">Iter: <span class="token number">1178</span> <span class="token operator">|</span> Loss:  <span class="token number">0.1210</span> <span class="token operator">|</span> Pred:  <span class="token number">0.8860</span> <span class="token operator">|</span> min/mean/max diff: <span class="token number">0.00</span>/3.70/7.00
</span><span class="code-line">Iter: <span class="token number">1240</span> <span class="token operator">|</span> Loss:  <span class="token number">0.1207</span> <span class="token operator">|</span> Pred:  <span class="token number">0.8863</span> <span class="token operator">|</span> min/mean/max diff: <span class="token number">0.00</span>/3.70/7.00
</span></code></pre>
<p>We had to use some tricks to generate an examples that is able to be confident enough for the flag.
I had to apply a learning rate scheduler that would reduce the step size by half if it doesn&#x27;t improve after 50 iterations.</p>
<div class="flex items-center justify-center flex-col"><img class="block" src="/post-assets/exploring-attacks-1/i-hate-anime-girls-osugaming-2024-simple.png" alt="Three images that showcase the adversarial attack."/><p class="mr-4 subtext" style="font-size:0.75rem">The output adversarial example on provided image using a simple iterative method.</p></div>
<p>The difference map shows something very interesting with vertical lines spread throughout. I think this is an artifact of optimizing before the resizing operation.
Let&#x27;s try the PGD and see if it does better.</p>
<pre class="language-python"><code class="language-python code-highlight"><span class="code-line">n_iterations <span class="token operator">=</span> <span class="token number">2000</span>
</span><span class="code-line">eps <span class="token operator">=</span> <span class="token number">7.</span> <span class="token operator">/</span> <span class="token number">255.</span>
</span><span class="code-line">bs <span class="token operator">=</span> <span class="token number">32</span> <span class="token comment"># not needed</span>
</span><span class="code-line">alpha <span class="token operator">=</span> <span class="token number">.1</span>
</span><span class="code-line">
</span><span class="code-line">iters_since_improvement <span class="token operator">=</span> <span class="token number">0</span>
</span><span class="code-line">max_iters_since_improvement <span class="token operator">=</span> <span class="token number">100</span>
</span><span class="code-line">best_loss <span class="token operator">=</span> <span class="token builtin">float</span><span class="token punctuation">(</span><span class="token string">&#x27;inf&#x27;</span><span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line">x <span class="token operator">=</span> img_original_tensor<span class="token punctuation">.</span>clone<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>detach<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>requires_grad_<span class="token punctuation">(</span><span class="token boolean">True</span><span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line">loss_func <span class="token operator">=</span> nn<span class="token punctuation">.</span>BCEWithLogitsLoss<span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">def</span> <span class="token function">forward</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">:</span>
</span><span class="code-line">    x <span class="token operator">=</span> resize<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
</span><span class="code-line">    x <span class="token operator">=</span> normalize<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
</span><span class="code-line">    x <span class="token operator">=</span> model<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
</span><span class="code-line">    <span class="token keyword">return</span> x
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">for</span> iteration <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>n_iterations<span class="token punctuation">)</span><span class="token punctuation">:</span>
</span><span class="code-line">    model<span class="token punctuation">.</span>zero_grad<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># this is the fix for the author&#x27;s mistake</span>
</span><span class="code-line">
</span><span class="code-line">    logits <span class="token operator">=</span> forward<span class="token punctuation">(</span>torch<span class="token punctuation">.</span>cat<span class="token punctuation">(</span><span class="token punctuation">[</span>x<span class="token punctuation">]</span> <span class="token operator">*</span> bs<span class="token punctuation">,</span> dim<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># bs not needed</span>
</span><span class="code-line">    loss <span class="token operator">=</span> loss_func<span class="token punctuation">(</span>logits<span class="token punctuation">,</span> torch<span class="token punctuation">.</span>ones_like<span class="token punctuation">(</span>logits<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># maximize the output of the model</span>
</span><span class="code-line">
</span><span class="code-line">    grad <span class="token operator">=</span> torch<span class="token punctuation">.</span>autograd<span class="token punctuation">.</span>grad<span class="token punctuation">(</span>loss<span class="token punctuation">,</span> x<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
</span><span class="code-line">    x<span class="token punctuation">.</span>data <span class="token operator">=</span> x<span class="token punctuation">.</span>data <span class="token operator">-</span> alpha <span class="token operator">*</span> torch<span class="token punctuation">.</span>sign<span class="token punctuation">(</span>grad<span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line">    x<span class="token punctuation">.</span>data <span class="token operator">=</span> torch<span class="token punctuation">.</span>clamp<span class="token punctuation">(</span>x<span class="token punctuation">.</span>data<span class="token punctuation">,</span> img_original_tensor <span class="token operator">-</span> eps<span class="token punctuation">,</span> img_original_tensor <span class="token operator">+</span> eps<span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line">    <span class="token keyword">if</span> loss<span class="token punctuation">.</span>item<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> best_loss <span class="token operator">-</span> <span class="token number">0.05</span><span class="token punctuation">:</span>
</span><span class="code-line">        best_loss <span class="token operator">=</span> loss<span class="token punctuation">.</span>item<span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">        iters_since_improvement <span class="token operator">=</span> <span class="token number">0</span>
</span><span class="code-line">    <span class="token keyword">else</span><span class="token punctuation">:</span>
</span><span class="code-line">        iters_since_improvement <span class="token operator">+=</span> <span class="token number">1</span>
</span><span class="code-line">        <span class="token keyword">if</span> iters_since_improvement <span class="token operator">&gt;=</span> max_iters_since_improvement<span class="token punctuation">:</span>
</span><span class="code-line">            alpha <span class="token operator">/=</span> <span class="token number">1.5</span>
</span><span class="code-line">            iters_since_improvement <span class="token operator">=</span> <span class="token number">0</span>
</span><span class="code-line">            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;Reducing alpha to </span><span class="token interpolation"><span class="token punctuation">{</span>alpha<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>
</span></code></pre>
<p class="mr-4 subtext" style="font-size:0.75rem">full code: <a href="https://github.com/OutWrest/blog-handouts/blob/main/exploring-attacks-1/i-hate-anime-girls-osugaming-2024.ipynb">https://github.com/OutWrest/blog-handouts/blob/main/exploring-attacks-1/i-hate-anime-girls-osugaming-2024.ipynb</a></p>
<p>Output:</p>
<pre class="language-bash"><code class="language-bash code-highlight"><span class="code-line">Iter: <span class="token number">0</span>    <span class="token operator">|</span> Loss:  <span class="token number">2.0104</span> <span class="token operator">|</span> Pred:  <span class="token number">0.1339</span> <span class="token operator">|</span> min/mean/max diff: <span class="token number">0.00</span>/4.80/8.00
</span><span class="code-line">Iter: <span class="token number">100</span>  <span class="token operator">|</span> Loss:  <span class="token number">2.0053</span> <span class="token operator">|</span> Pred:  <span class="token number">0.1346</span> <span class="token operator">|</span> min/mean/max diff: <span class="token number">0.00</span>/4.80/8.00
</span><span class="code-line">Reducing alpha to <span class="token number">0.06666666666666667</span>
</span><span class="code-line">Iter: <span class="token number">200</span>  <span class="token operator">|</span> Loss:  <span class="token number">1.9217</span> <span class="token operator">|</span> Pred:  <span class="token number">0.1464</span> <span class="token operator">|</span> min/mean/max diff: <span class="token number">0.00</span>/4.79/8.00
</span><span class="code-line">Reducing alpha to <span class="token number">0.044444444444444446</span>
</span><span class="code-line">Iter: <span class="token number">300</span>  <span class="token operator">|</span> Loss:  <span class="token number">1.8906</span> <span class="token operator">|</span> Pred:  <span class="token number">0.1510</span> <span class="token operator">|</span> min/mean/max diff: <span class="token number">0.00</span>/4.23/8.00
</span><span class="code-line">Reducing alpha to <span class="token number">0.02962962962962963</span>
</span><span class="code-line">Iter: <span class="token number">400</span>  <span class="token operator">|</span> Loss:  <span class="token number">1.8724</span> <span class="token operator">|</span> Pred:  <span class="token number">0.1538</span> <span class="token operator">|</span> min/mean/max diff: <span class="token number">0.00</span>/3.31/7.00
</span><span class="code-line">Iter: <span class="token number">500</span>  <span class="token operator">|</span> Loss:  <span class="token number">1.5570</span> <span class="token operator">|</span> Pred:  <span class="token number">0.2108</span> <span class="token operator">|</span> min/mean/max diff: <span class="token number">0.00</span>/3.32/8.00
</span><span class="code-line">Reducing alpha to <span class="token number">0.019753086419753086</span>
</span><span class="code-line">Iter: <span class="token number">600</span>  <span class="token operator">|</span> Loss:  <span class="token number">1.4528</span> <span class="token operator">|</span> Pred:  <span class="token number">0.2339</span> <span class="token operator">|</span> min/mean/max diff: <span class="token number">0.00</span>/3.20/8.00
</span><span class="code-line">Iter: <span class="token number">700</span>  <span class="token operator">|</span> Loss:  <span class="token number">1.5776</span> <span class="token operator">|</span> Pred:  <span class="token number">0.2065</span> <span class="token operator">|</span> min/mean/max diff: <span class="token number">0.00</span>/3.20/8.00
</span><span class="code-line">Reducing alpha to <span class="token number">0.01316872427983539</span>
</span><span class="code-line">Iter: <span class="token number">800</span>  <span class="token operator">|</span> Loss:  <span class="token number">1.2085</span> <span class="token operator">|</span> Pred:  <span class="token number">0.2986</span> <span class="token operator">|</span> min/mean/max diff: <span class="token number">0.00</span>/2.97/8.00
</span><span class="code-line">Reducing alpha to <span class="token number">0.008779149519890261</span>
</span><span class="code-line">Iter: <span class="token number">900</span>  <span class="token operator">|</span> Loss:  <span class="token number">0.9222</span> <span class="token operator">|</span> Pred:  <span class="token number">0.3976</span> <span class="token operator">|</span> min/mean/max diff: <span class="token number">0.00</span>/2.87/8.00
</span><span class="code-line">Reducing alpha to <span class="token number">0.005852766346593507</span>
</span><span class="code-line">Iter: <span class="token number">1000</span> <span class="token operator">|</span> Loss:  <span class="token number">0.6689</span> <span class="token operator">|</span> Pred:  <span class="token number">0.5123</span> <span class="token operator">|</span> min/mean/max diff: <span class="token number">0.00</span>/2.97/8.00
</span><span class="code-line">Iter: <span class="token number">1100</span> <span class="token operator">|</span> Loss:  <span class="token number">0.5700</span> <span class="token operator">|</span> Pred:  <span class="token number">0.5655</span> <span class="token operator">|</span> min/mean/max diff: <span class="token number">0.00</span>/3.03/8.00
</span><span class="code-line">Reducing alpha to <span class="token number">0.003901844231062338</span>
</span><span class="code-line">Iter: <span class="token number">1200</span> <span class="token operator">|</span> Loss:  <span class="token number">0.4041</span> <span class="token operator">|</span> Pred:  <span class="token number">0.6676</span> <span class="token operator">|</span> min/mean/max diff: <span class="token number">0.00</span>/3.21/8.00
</span><span class="code-line">Reducing alpha to <span class="token number">0.002601229487374892</span>
</span><span class="code-line">Iter: <span class="token number">1300</span> <span class="token operator">|</span> Loss:  <span class="token number">0.4183</span> <span class="token operator">|</span> Pred:  <span class="token number">0.6581</span> <span class="token operator">|</span> min/mean/max diff: <span class="token number">0.00</span>/3.25/7.00
</span><span class="code-line">Iter: <span class="token number">1400</span> <span class="token operator">|</span> Loss:  <span class="token number">0.3224</span> <span class="token operator">|</span> Pred:  <span class="token number">0.7244</span> <span class="token operator">|</span> min/mean/max diff: <span class="token number">0.00</span>/3.19/7.00
</span><span class="code-line">Reducing alpha to <span class="token number">0.0017341529915832611</span>
</span><span class="code-line">Iter: <span class="token number">1500</span> <span class="token operator">|</span> Loss:  <span class="token number">0.2673</span> <span class="token operator">|</span> Pred:  <span class="token number">0.7654</span> <span class="token operator">|</span> min/mean/max diff: <span class="token number">0.00</span>/3.22/7.00
</span><span class="code-line">Reducing alpha to <span class="token number">0.0011561019943888407</span>
</span><span class="code-line">Iter: <span class="token number">1600</span> <span class="token operator">|</span> Loss:  <span class="token number">0.2352</span> <span class="token operator">|</span> Pred:  <span class="token number">0.7904</span> <span class="token operator">|</span> min/mean/max diff: <span class="token number">0.00</span>/3.25/7.00
</span><span class="code-line">Reducing alpha to <span class="token number">0.0007707346629258938</span>
</span><span class="code-line">Iter: <span class="token number">1700</span> <span class="token operator">|</span> Loss:  <span class="token number">0.2144</span> <span class="token operator">|</span> Pred:  <span class="token number">0.8070</span> <span class="token operator">|</span> min/mean/max diff: <span class="token number">0.00</span>/3.28/7.00
</span><span class="code-line">Reducing alpha to <span class="token number">0.0005138231086172625</span>
</span><span class="code-line">Iter: <span class="token number">1800</span> <span class="token operator">|</span> Loss:  <span class="token number">0.2014</span> <span class="token operator">|</span> Pred:  <span class="token number">0.8176</span> <span class="token operator">|</span> min/mean/max diff: <span class="token number">0.00</span>/3.29/7.00
</span><span class="code-line">Reducing alpha to <span class="token number">0.000342548739078175</span>
</span><span class="code-line">Iter: <span class="token number">1900</span> <span class="token operator">|</span> Loss:  <span class="token number">0.1925</span> <span class="token operator">|</span> Pred:  <span class="token number">0.8249</span> <span class="token operator">|</span> min/mean/max diff: <span class="token number">0.00</span>/3.30/7.00
</span><span class="code-line">Reducing alpha to <span class="token number">0.00022836582605211667</span>
</span></code></pre>
<p>I wasn&#x27;t able to generate another example that does better than the previous method in terms of confidence using PGD.
But it should be enough to be used to solve the challenge.</p>
<div class="flex items-center justify-center flex-col"><img class="block" src="/post-assets/exploring-attacks-1/i-hate-anime-girls-osugaming-2024-pgd.png" alt="Three images that showcase the adversarial attack."/><p class="mr-4 subtext" style="font-size:0.75rem">The output adversarial example on provided image using PGD.</p></div>
<h1>Conclusion</h1>
<p>In this exploration of a few different adversarial attacks on CNNs, we learned about some widely used practical techiques, specifically in context of solving CTF challenges.
I really hope that conveyed these ideas clearly and I would strongly encourage you to go through the code repository linked to get a clearer idea about how to apply these methods.</p>
<p>While brief, I wanted to show some real examples from CTF challenges that used similar ideas.
I think we&#x27;ll probably see more CTFs creating AI/ML focused challenges.
Feel free to reach out to me through discord if you have any questions.</p></div></main><footer class="mt-auto py-8"><ul class="flex justify-center space-x-4"><li><a href="https://github.com/OutWrest" class="w-8 h-8 grid place-items-center rounded-md bg-gray-900 text-gray-50 dark:bg-gray-800 dark:text-gray-50" title="github"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-4 h-4"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22"></path></svg></a></li></ul><div class="mt-8 flex justify-center"></div></footer></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"frontMatter":{"title":"Exploring Adversarial Attacks on Convolutional Neural Networks - Part 1","description":"Digging into simple CNN adversarial attacks shown in DiceCTF 2024 \u0026 osu!gaming CTF 2024","date":"2024-07-13","tags":["ai","vision","ctf","misc"],"slug":"exploring-attacks-1"},"mdx":{"compiledSource":"/*@jsxRuntime automatic @jsxImportSource react*/\nconst {Fragment: _Fragment, jsx: _jsx, jsxs: _jsxs} = arguments[0];\nconst {useMDXComponents: _provideComponents} = arguments[0];\nfunction _createMdxContent(props) {\n  const _components = Object.assign({\n    p: \"p\",\n    h1: \"h1\",\n    ul: \"ul\",\n    li: \"li\",\n    a: \"a\",\n    em: \"em\",\n    code: \"code\",\n    span: \"span\",\n    math: \"math\",\n    semantics: \"semantics\",\n    mrow: \"mrow\",\n    mi: \"mi\",\n    annotation: \"annotation\",\n    msub: \"msub\",\n    mtext: \"mtext\",\n    mo: \"mo\",\n    strong: \"strong\",\n    msup: \"msup\",\n    mn: \"mn\",\n    h2: \"h2\",\n    pre: \"pre\",\n    h3: \"h3\"\n  }, _provideComponents(), props.components), {Math, Challenge} = _components;\n  if (!Challenge) _missingMdxReference(\"Challenge\", true);\n  if (!Math) _missingMdxReference(\"Math\", true);\n  return _jsxs(_Fragment, {\n    children: [_jsxs(\"div\", {\n      className: \"lead\",\n      children: [_jsx(_components.p, {\n        children: \"I want to be clear, I am not an expert, in either cybersecurity or data science.\\nI am interested in both fields so it becomes very fun exploring the intersection.\"\n      }), _jsxs(_components.p, {\n        children: [\"If you just want the code, \", _jsx(\"a\", {\n          target: \"_blank\",\n          rel: \"noopener noreferrer\",\n          href: \"https://github.com/OutWrest/blog-handouts/tree/main/exploring-attacks-1\",\n          children: \"click here\"\n        }), \".\"]\n      })]\n    }), \"\\n\", _jsx(_components.h1, {\n      children: \"Overview\"\n    }), \"\\n\", _jsxs(_components.ul, {\n      children: [\"\\n\", _jsx(_components.li, {\n        children: \"Introduction\"\n      }), \"\\n\", _jsx(_components.li, {\n        children: _jsx(_components.a, {\n          href: \"#What%20Are%20Adversarial%20Attacks?\",\n          children: \"What Are Adversarial Attacks\"\n        })\n      }), \"\\n\", _jsx(_components.li, {\n        children: \"Applying to recent CTF challenges\"\n      }), \"\\n\", _jsx(_components.li, {\n        children: \"Conclusion\"\n      }), \"\\n\"]\n    }), \"\\n\", _jsx(_components.h1, {\n      children: \"Introduction\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Adversarial attacks are not new, but they are not a usual category in CTF competitions.\\nWith the past year or so, I started seeing more competitions including data science related challenges.\\nI want some spend time to explore some adversarial methods and apply them in examples that are easy to translate for competitions.\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"Before diving into the main topic, I want to mention that I will assume some understanding of machine learning basics.\\n\", _jsx(_components.em, {\n        children: \"Maybe in the future\"\n      }), \" I can further explore these basics to build a ground-up understanding.\"]\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"In this article we will explore white-box model adversarial image attacks and try minimize the difference between the pixels on initial image and the adversarial examples we will create.\"\n    }), \"\\n\", _jsx(_components.h1, {\n      children: \"What are Adversarial Attacks?\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"In machine learning, adversarial attacks are techiques that aim to deceive or compromoise an AI system.\\nThe techiques can include different types of attacks that specially manipluate the system's input, training data or even the inner workings of the model itself.\\nI will focus on the most on attacks that manipluate the AI system's input to get it to an unintended output.\\nThough you can explore more about adversarial attacks \", _jsx(\"a\", {\n        target: \"_blank\",\n        rel: \"noopener noreferrer\",\n        href: \"https://en.wikipedia.org/wiki/Adversarial_machine_learning\",\n        children: \"here\"\n      }), \".\"]\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"No model is perfect. Machine learning tries to estimate output signals from the training data that is given to it.\\nModels predict an outcome, and in most settings, they usually do a pretty good job at it.\\nThere are always inaccuracies but they can accumulate from the dataset, training methods/architecture or they are inherit to the problem itself.\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"With convolutional neural networks, especially for image-related problems, a model can become good at identifying shapes \u0026 edges for classification.\\nModern image models rely on many parameters (on the smaller end, resnet18 has ~11m parameters) and current research tries to apply these models to bigger and bigger problems.\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Exploring adversarial attacks unveils the vulnerability of these seemingly robust models.\\nDespite their sophistication, they can be targeted to produce specific output with a specially crafted input.\\nIn this article, we will go through several popular types of attacks and apply our learning to challenges from recent cybersecurity CTF competitions.\"\n    }), \"\\n\", _jsx(_components.h1, {\n      children: \"Lets try it out\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"Let's consider the scenario of generating an adversarial example for an ImageNet-trained ResNet18 model.\\nWe will try out some different methods to generate adversarial examples starting from an initial image \", _jsx(_components.code, {\n        className: \"language-math math-inline\",\n        children: _jsxs(_components.span, {\n          className: \"katex\",\n          children: [_jsx(_components.span, {\n            className: \"katex-mathml\",\n            children: _jsx(_components.math, {\n              xmlns: \"http://www.w3.org/1998/Math/MathML\",\n              children: _jsxs(_components.semantics, {\n                children: [_jsx(_components.mrow, {\n                  children: _jsx(_components.mi, {\n                    children: \"x\"\n                  })\n                }), _jsx(_components.annotation, {\n                  encoding: \"application/x-tex\",\n                  children: \"x\"\n                })]\n              })\n            })\n          }), _jsx(_components.span, {\n            className: \"katex-html\",\n            \"aria-hidden\": \"true\",\n            children: _jsxs(_components.span, {\n              className: \"base\",\n              children: [_jsx(_components.span, {\n                className: \"strut\",\n                style: {\n                  height: \"0.4306em\"\n                }\n              }), _jsx(_components.span, {\n                className: \"mord mathnormal\",\n                children: \"x\"\n              })]\n            })\n          })]\n        })\n      }), \".\"]\n    }), \"\\n\", _jsxs(\"div\", {\n      className: \"flex items-center justify-center flex-col\",\n      children: [_jsx(\"img\", {\n        className: \"block\",\n        src: \"/post-assets/exploring-attacks-1/init-imgs.png\",\n        alt: \"Three examples of model input to ResNet18 Model, an all white image, an all black image, and noise image\"\n      }), _jsx(\"p\", {\n        className: \"mr-4 subtext\",\n        style: {\n          fontSize: '0.75rem'\n        },\n        children: \"ImageNet-trained ResNet18 model's output probabilities for a white, black and nosie image.\"\n      })]\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"In all three of the solutions, I will only focus on the following cost function that optimizes for the cross-entropy loss over a specific target, \", _jsx(_components.code, {\n        className: \"language-math math-inline\",\n        children: _jsxs(_components.span, {\n          className: \"katex\",\n          children: [_jsx(_components.span, {\n            className: \"katex-mathml\",\n            children: _jsx(_components.math, {\n              xmlns: \"http://www.w3.org/1998/Math/MathML\",\n              children: _jsxs(_components.semantics, {\n                children: [_jsx(_components.mrow, {\n                  children: _jsxs(_components.msub, {\n                    children: [_jsx(_components.mi, {\n                      children: \"y\"\n                    }), _jsx(_components.mtext, {\n                      children: \"target\"\n                    })]\n                  })\n                }), _jsx(_components.annotation, {\n                  encoding: \"application/x-tex\",\n                  children: \"y_{\\\\text{target}}\"\n                })]\n              })\n            })\n          }), _jsx(_components.span, {\n            className: \"katex-html\",\n            \"aria-hidden\": \"true\",\n            children: _jsxs(_components.span, {\n              className: \"base\",\n              children: [_jsx(_components.span, {\n                className: \"strut\",\n                style: {\n                  height: \"0.7167em\",\n                  verticalAlign: \"-0.2861em\"\n                }\n              }), _jsxs(_components.span, {\n                className: \"mord\",\n                children: [_jsx(_components.span, {\n                  className: \"mord mathnormal\",\n                  style: {\n                    marginRight: \"0.03588em\"\n                  },\n                  children: \"y\"\n                }), _jsx(_components.span, {\n                  className: \"msupsub\",\n                  children: _jsxs(_components.span, {\n                    className: \"vlist-t vlist-t2\",\n                    children: [_jsxs(_components.span, {\n                      className: \"vlist-r\",\n                      children: [_jsx(_components.span, {\n                        className: \"vlist\",\n                        style: {\n                          height: \"0.2806em\"\n                        },\n                        children: _jsxs(_components.span, {\n                          style: {\n                            top: \"-2.55em\",\n                            marginLeft: \"-0.0359em\",\n                            marginRight: \"0.05em\"\n                          },\n                          children: [_jsx(_components.span, {\n                            className: \"pstrut\",\n                            style: {\n                              height: \"2.7em\"\n                            }\n                          }), _jsx(_components.span, {\n                            className: \"sizing reset-size6 size3 mtight\",\n                            children: _jsx(_components.span, {\n                              className: \"mord mtight\",\n                              children: _jsx(_components.span, {\n                                className: \"mord text mtight\",\n                                children: _jsx(_components.span, {\n                                  className: \"mord mtight\",\n                                  children: \"target\"\n                                })\n                              })\n                            })\n                          })]\n                        })\n                      }), _jsx(_components.span, {\n                        className: \"vlist-s\",\n                        children: \"​\"\n                      })]\n                    }), _jsx(_components.span, {\n                      className: \"vlist-r\",\n                      children: _jsx(_components.span, {\n                        className: \"vlist\",\n                        style: {\n                          height: \"0.2861em\"\n                        },\n                        children: _jsx(_components.span, {})\n                      })\n                    })]\n                  })\n                })]\n              })]\n            })\n          })]\n        })\n      }), \".\"]\n    }), \"\\n\", _jsx(Math, {\n      children: _jsx(_components.p, {\n        children: _jsx(_components.code, {\n          className: \"language-math math-inline\",\n          children: _jsxs(_components.span, {\n            className: \"katex\",\n            children: [_jsx(_components.span, {\n              className: \"katex-mathml\",\n              children: _jsx(_components.math, {\n                xmlns: \"http://www.w3.org/1998/Math/MathML\",\n                children: _jsxs(_components.semantics, {\n                  children: [_jsxs(_components.mrow, {\n                    children: [_jsxs(_components.msub, {\n                      children: [_jsx(_components.mi, {\n                        mathvariant: \"script\",\n                        children: \"L\"\n                      }), _jsx(_components.mtext, {\n                        children: \"targeted\"\n                      })]\n                    }), _jsx(_components.mo, {\n                      stretchy: \"false\",\n                      children: \"(\"\n                    }), _jsx(_components.mi, {\n                      children: \"x\"\n                    }), _jsx(_components.mo, {\n                      separator: \"true\",\n                      children: \",\"\n                    }), _jsxs(_components.msub, {\n                      children: [_jsx(_components.mi, {\n                        children: \"y\"\n                      }), _jsx(_components.mtext, {\n                        children: \"target\"\n                      })]\n                    }), _jsx(_components.mo, {\n                      stretchy: \"false\",\n                      children: \")\"\n                    }), _jsx(_components.mo, {\n                      children: \"=\"\n                    }), _jsx(_components.mtext, {\n                      children: \"CE\"\n                    }), _jsx(_components.mo, {\n                      stretchy: \"false\",\n                      children: \"(\"\n                    }), _jsxs(_components.msub, {\n                      children: [_jsx(_components.mi, {\n                        children: \"y\"\n                      }), _jsx(_components.mtext, {\n                        children: \"target\"\n                      })]\n                    }), _jsx(_components.mo, {\n                      separator: \"true\",\n                      children: \",\"\n                    }), _jsx(_components.mi, {\n                      children: \"f\"\n                    }), _jsx(_components.mo, {\n                      stretchy: \"false\",\n                      children: \"(\"\n                    }), _jsx(_components.mi, {\n                      children: \"x\"\n                    }), _jsx(_components.mo, {\n                      stretchy: \"false\",\n                      children: \")\"\n                    }), _jsx(_components.mo, {\n                      stretchy: \"false\",\n                      children: \")\"\n                    })]\n                  }), _jsx(_components.annotation, {\n                    encoding: \"application/x-tex\",\n                    children: \"\\\\mathcal{L}_{\\\\text{targeted}}(x, y_{\\\\text{target}}) = \\\\text{CE}(y_{\\\\text{target}}, f(x))\"\n                  })]\n                })\n              })\n            }), _jsxs(_components.span, {\n              className: \"katex-html\",\n              \"aria-hidden\": \"true\",\n              children: [_jsxs(_components.span, {\n                className: \"base\",\n                children: [_jsx(_components.span, {\n                  className: \"strut\",\n                  style: {\n                    height: \"1.0361em\",\n                    verticalAlign: \"-0.2861em\"\n                  }\n                }), _jsxs(_components.span, {\n                  className: \"mord\",\n                  children: [_jsx(_components.span, {\n                    className: \"mord mathcal\",\n                    children: \"L\"\n                  }), _jsx(_components.span, {\n                    className: \"msupsub\",\n                    children: _jsxs(_components.span, {\n                      className: \"vlist-t vlist-t2\",\n                      children: [_jsxs(_components.span, {\n                        className: \"vlist-r\",\n                        children: [_jsx(_components.span, {\n                          className: \"vlist\",\n                          style: {\n                            height: \"0.3361em\"\n                          },\n                          children: _jsxs(_components.span, {\n                            style: {\n                              top: \"-2.55em\",\n                              marginLeft: \"0em\",\n                              marginRight: \"0.05em\"\n                            },\n                            children: [_jsx(_components.span, {\n                              className: \"pstrut\",\n                              style: {\n                                height: \"2.7em\"\n                              }\n                            }), _jsx(_components.span, {\n                              className: \"sizing reset-size6 size3 mtight\",\n                              children: _jsx(_components.span, {\n                                className: \"mord mtight\",\n                                children: _jsx(_components.span, {\n                                  className: \"mord text mtight\",\n                                  children: _jsx(_components.span, {\n                                    className: \"mord mtight\",\n                                    children: \"targeted\"\n                                  })\n                                })\n                              })\n                            })]\n                          })\n                        }), _jsx(_components.span, {\n                          className: \"vlist-s\",\n                          children: \"​\"\n                        })]\n                      }), _jsx(_components.span, {\n                        className: \"vlist-r\",\n                        children: _jsx(_components.span, {\n                          className: \"vlist\",\n                          style: {\n                            height: \"0.2861em\"\n                          },\n                          children: _jsx(_components.span, {})\n                        })\n                      })]\n                    })\n                  })]\n                }), _jsx(_components.span, {\n                  className: \"mopen\",\n                  children: \"(\"\n                }), _jsx(_components.span, {\n                  className: \"mord mathnormal\",\n                  children: \"x\"\n                }), _jsx(_components.span, {\n                  className: \"mpunct\",\n                  children: \",\"\n                }), _jsx(_components.span, {\n                  className: \"mspace\",\n                  style: {\n                    marginRight: \"0.1667em\"\n                  }\n                }), _jsxs(_components.span, {\n                  className: \"mord\",\n                  children: [_jsx(_components.span, {\n                    className: \"mord mathnormal\",\n                    style: {\n                      marginRight: \"0.03588em\"\n                    },\n                    children: \"y\"\n                  }), _jsx(_components.span, {\n                    className: \"msupsub\",\n                    children: _jsxs(_components.span, {\n                      className: \"vlist-t vlist-t2\",\n                      children: [_jsxs(_components.span, {\n                        className: \"vlist-r\",\n                        children: [_jsx(_components.span, {\n                          className: \"vlist\",\n                          style: {\n                            height: \"0.2806em\"\n                          },\n                          children: _jsxs(_components.span, {\n                            style: {\n                              top: \"-2.55em\",\n                              marginLeft: \"-0.0359em\",\n                              marginRight: \"0.05em\"\n                            },\n                            children: [_jsx(_components.span, {\n                              className: \"pstrut\",\n                              style: {\n                                height: \"2.7em\"\n                              }\n                            }), _jsx(_components.span, {\n                              className: \"sizing reset-size6 size3 mtight\",\n                              children: _jsx(_components.span, {\n                                className: \"mord mtight\",\n                                children: _jsx(_components.span, {\n                                  className: \"mord text mtight\",\n                                  children: _jsx(_components.span, {\n                                    className: \"mord mtight\",\n                                    children: \"target\"\n                                  })\n                                })\n                              })\n                            })]\n                          })\n                        }), _jsx(_components.span, {\n                          className: \"vlist-s\",\n                          children: \"​\"\n                        })]\n                      }), _jsx(_components.span, {\n                        className: \"vlist-r\",\n                        children: _jsx(_components.span, {\n                          className: \"vlist\",\n                          style: {\n                            height: \"0.2861em\"\n                          },\n                          children: _jsx(_components.span, {})\n                        })\n                      })]\n                    })\n                  })]\n                }), _jsx(_components.span, {\n                  className: \"mclose\",\n                  children: \")\"\n                }), _jsx(_components.span, {\n                  className: \"mspace\",\n                  style: {\n                    marginRight: \"0.2778em\"\n                  }\n                }), _jsx(_components.span, {\n                  className: \"mrel\",\n                  children: \"=\"\n                }), _jsx(_components.span, {\n                  className: \"mspace\",\n                  style: {\n                    marginRight: \"0.2778em\"\n                  }\n                })]\n              }), _jsxs(_components.span, {\n                className: \"base\",\n                children: [_jsx(_components.span, {\n                  className: \"strut\",\n                  style: {\n                    height: \"1.0361em\",\n                    verticalAlign: \"-0.2861em\"\n                  }\n                }), _jsx(_components.span, {\n                  className: \"mord text\",\n                  children: _jsx(_components.span, {\n                    className: \"mord\",\n                    children: \"CE\"\n                  })\n                }), _jsx(_components.span, {\n                  className: \"mopen\",\n                  children: \"(\"\n                }), _jsxs(_components.span, {\n                  className: \"mord\",\n                  children: [_jsx(_components.span, {\n                    className: \"mord mathnormal\",\n                    style: {\n                      marginRight: \"0.03588em\"\n                    },\n                    children: \"y\"\n                  }), _jsx(_components.span, {\n                    className: \"msupsub\",\n                    children: _jsxs(_components.span, {\n                      className: \"vlist-t vlist-t2\",\n                      children: [_jsxs(_components.span, {\n                        className: \"vlist-r\",\n                        children: [_jsx(_components.span, {\n                          className: \"vlist\",\n                          style: {\n                            height: \"0.2806em\"\n                          },\n                          children: _jsxs(_components.span, {\n                            style: {\n                              top: \"-2.55em\",\n                              marginLeft: \"-0.0359em\",\n                              marginRight: \"0.05em\"\n                            },\n                            children: [_jsx(_components.span, {\n                              className: \"pstrut\",\n                              style: {\n                                height: \"2.7em\"\n                              }\n                            }), _jsx(_components.span, {\n                              className: \"sizing reset-size6 size3 mtight\",\n                              children: _jsx(_components.span, {\n                                className: \"mord mtight\",\n                                children: _jsx(_components.span, {\n                                  className: \"mord text mtight\",\n                                  children: _jsx(_components.span, {\n                                    className: \"mord mtight\",\n                                    children: \"target\"\n                                  })\n                                })\n                              })\n                            })]\n                          })\n                        }), _jsx(_components.span, {\n                          className: \"vlist-s\",\n                          children: \"​\"\n                        })]\n                      }), _jsx(_components.span, {\n                        className: \"vlist-r\",\n                        children: _jsx(_components.span, {\n                          className: \"vlist\",\n                          style: {\n                            height: \"0.2861em\"\n                          },\n                          children: _jsx(_components.span, {})\n                        })\n                      })]\n                    })\n                  })]\n                }), _jsx(_components.span, {\n                  className: \"mpunct\",\n                  children: \",\"\n                }), _jsx(_components.span, {\n                  className: \"mspace\",\n                  style: {\n                    marginRight: \"0.1667em\"\n                  }\n                }), _jsx(_components.span, {\n                  className: \"mord mathnormal\",\n                  style: {\n                    marginRight: \"0.10764em\"\n                  },\n                  children: \"f\"\n                }), _jsx(_components.span, {\n                  className: \"mopen\",\n                  children: \"(\"\n                }), _jsx(_components.span, {\n                  className: \"mord mathnormal\",\n                  children: \"x\"\n                }), _jsx(_components.span, {\n                  className: \"mclose\",\n                  children: \"))\"\n                })]\n              })]\n            })]\n          })\n        })\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Where:\"\n    }), \"\\n\", _jsxs(_components.ul, {\n      children: [\"\\n\", _jsxs(_components.li, {\n        children: [_jsx(_components.code, {\n          className: \"language-math math-inline\",\n          children: _jsxs(_components.span, {\n            className: \"katex\",\n            children: [_jsx(_components.span, {\n              className: \"katex-mathml\",\n              children: _jsx(_components.math, {\n                xmlns: \"http://www.w3.org/1998/Math/MathML\",\n                children: _jsxs(_components.semantics, {\n                  children: [_jsx(_components.mrow, {\n                    children: _jsx(_components.mi, {\n                      children: \"x\"\n                    })\n                  }), _jsx(_components.annotation, {\n                    encoding: \"application/x-tex\",\n                    children: \"x\"\n                  })]\n                })\n              })\n            }), _jsx(_components.span, {\n              className: \"katex-html\",\n              \"aria-hidden\": \"true\",\n              children: _jsxs(_components.span, {\n                className: \"base\",\n                children: [_jsx(_components.span, {\n                  className: \"strut\",\n                  style: {\n                    height: \"0.4306em\"\n                  }\n                }), _jsx(_components.span, {\n                  className: \"mord mathnormal\",\n                  children: \"x\"\n                })]\n              })\n            })]\n          })\n        }), \" denotes the model's input, any image.\"]\n      }), \"\\n\", _jsxs(_components.li, {\n        children: [_jsx(_components.code, {\n          className: \"language-math math-inline\",\n          children: _jsxs(_components.span, {\n            className: \"katex\",\n            children: [_jsx(_components.span, {\n              className: \"katex-mathml\",\n              children: _jsx(_components.math, {\n                xmlns: \"http://www.w3.org/1998/Math/MathML\",\n                children: _jsxs(_components.semantics, {\n                  children: [_jsx(_components.mrow, {\n                    children: _jsxs(_components.msub, {\n                      children: [_jsx(_components.mi, {\n                        children: \"y\"\n                      }), _jsx(_components.mtext, {\n                        children: \"target\"\n                      })]\n                    })\n                  }), _jsx(_components.annotation, {\n                    encoding: \"application/x-tex\",\n                    children: \"y_{\\\\text{target}}\"\n                  })]\n                })\n              })\n            }), _jsx(_components.span, {\n              className: \"katex-html\",\n              \"aria-hidden\": \"true\",\n              children: _jsxs(_components.span, {\n                className: \"base\",\n                children: [_jsx(_components.span, {\n                  className: \"strut\",\n                  style: {\n                    height: \"0.7167em\",\n                    verticalAlign: \"-0.2861em\"\n                  }\n                }), _jsxs(_components.span, {\n                  className: \"mord\",\n                  children: [_jsx(_components.span, {\n                    className: \"mord mathnormal\",\n                    style: {\n                      marginRight: \"0.03588em\"\n                    },\n                    children: \"y\"\n                  }), _jsx(_components.span, {\n                    className: \"msupsub\",\n                    children: _jsxs(_components.span, {\n                      className: \"vlist-t vlist-t2\",\n                      children: [_jsxs(_components.span, {\n                        className: \"vlist-r\",\n                        children: [_jsx(_components.span, {\n                          className: \"vlist\",\n                          style: {\n                            height: \"0.2806em\"\n                          },\n                          children: _jsxs(_components.span, {\n                            style: {\n                              top: \"-2.55em\",\n                              marginLeft: \"-0.0359em\",\n                              marginRight: \"0.05em\"\n                            },\n                            children: [_jsx(_components.span, {\n                              className: \"pstrut\",\n                              style: {\n                                height: \"2.7em\"\n                              }\n                            }), _jsx(_components.span, {\n                              className: \"sizing reset-size6 size3 mtight\",\n                              children: _jsx(_components.span, {\n                                className: \"mord mtight\",\n                                children: _jsx(_components.span, {\n                                  className: \"mord text mtight\",\n                                  children: _jsx(_components.span, {\n                                    className: \"mord mtight\",\n                                    children: \"target\"\n                                  })\n                                })\n                              })\n                            })]\n                          })\n                        }), _jsx(_components.span, {\n                          className: \"vlist-s\",\n                          children: \"​\"\n                        })]\n                      }), _jsx(_components.span, {\n                        className: \"vlist-r\",\n                        children: _jsx(_components.span, {\n                          className: \"vlist\",\n                          style: {\n                            height: \"0.2861em\"\n                          },\n                          children: _jsx(_components.span, {})\n                        })\n                      })]\n                    })\n                  })]\n                })]\n              })\n            })]\n          })\n        }), \" is the target class that we want to generate an adversarial example for.\"]\n      }), \"\\n\", _jsxs(_components.li, {\n        children: [_jsx(_components.code, {\n          className: \"language-math math-inline\",\n          children: _jsxs(_components.span, {\n            className: \"katex\",\n            children: [_jsx(_components.span, {\n              className: \"katex-mathml\",\n              children: _jsx(_components.math, {\n                xmlns: \"http://www.w3.org/1998/Math/MathML\",\n                children: _jsxs(_components.semantics, {\n                  children: [_jsx(_components.mrow, {\n                    children: _jsx(_components.mtext, {\n                      children: \"CE\"\n                    })\n                  }), _jsx(_components.annotation, {\n                    encoding: \"application/x-tex\",\n                    children: \"\\\\text{CE}\"\n                  })]\n                })\n              })\n            }), _jsx(_components.span, {\n              className: \"katex-html\",\n              \"aria-hidden\": \"true\",\n              children: _jsxs(_components.span, {\n                className: \"base\",\n                children: [_jsx(_components.span, {\n                  className: \"strut\",\n                  style: {\n                    height: \"0.6833em\"\n                  }\n                }), _jsx(_components.span, {\n                  className: \"mord text\",\n                  children: _jsx(_components.span, {\n                    className: \"mord\",\n                    children: \"CE\"\n                  })\n                })]\n              })\n            })]\n          })\n        }), \" is the \", _jsx(\"a\", {\n          target: \"_blank\",\n          rel: \"noopener noreferrer\",\n          href: \"https://en.wikipedia.org/wiki/Cross-entropy\",\n          children: \"Cross Entropy\"\n        }), \" loss function.\"]\n      }), \"\\n\", _jsxs(_components.li, {\n        children: [_jsx(_components.code, {\n          className: \"language-math math-inline\",\n          children: _jsxs(_components.span, {\n            className: \"katex\",\n            children: [_jsx(_components.span, {\n              className: \"katex-mathml\",\n              children: _jsx(_components.math, {\n                xmlns: \"http://www.w3.org/1998/Math/MathML\",\n                children: _jsxs(_components.semantics, {\n                  children: [_jsxs(_components.mrow, {\n                    children: [_jsx(_components.mi, {\n                      children: \"f\"\n                    }), _jsx(_components.mo, {\n                      stretchy: \"false\",\n                      children: \"(\"\n                    }), _jsx(_components.mi, {\n                      children: \"x\"\n                    }), _jsx(_components.mo, {\n                      stretchy: \"false\",\n                      children: \")\"\n                    })]\n                  }), _jsx(_components.annotation, {\n                    encoding: \"application/x-tex\",\n                    children: \"f(x)\"\n                  })]\n                })\n              })\n            }), _jsx(_components.span, {\n              className: \"katex-html\",\n              \"aria-hidden\": \"true\",\n              children: _jsxs(_components.span, {\n                className: \"base\",\n                children: [_jsx(_components.span, {\n                  className: \"strut\",\n                  style: {\n                    height: \"1em\",\n                    verticalAlign: \"-0.25em\"\n                  }\n                }), _jsx(_components.span, {\n                  className: \"mord mathnormal\",\n                  style: {\n                    marginRight: \"0.10764em\"\n                  },\n                  children: \"f\"\n                }), _jsx(_components.span, {\n                  className: \"mopen\",\n                  children: \"(\"\n                }), _jsx(_components.span, {\n                  className: \"mord mathnormal\",\n                  children: \"x\"\n                }), _jsx(_components.span, {\n                  className: \"mclose\",\n                  children: \")\"\n                })]\n              })\n            })]\n          })\n        }), \" denotes the model.\"]\n      }), \"\\n\"]\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"If we need to, we can also optimize the \", _jsx(_components.code, {\n        className: \"language-math math-inline\",\n        children: _jsxs(_components.span, {\n          className: \"katex\",\n          children: [_jsx(_components.span, {\n            className: \"katex-mathml\",\n            children: _jsx(_components.math, {\n              xmlns: \"http://www.w3.org/1998/Math/MathML\",\n              children: _jsxs(_components.semantics, {\n                children: [_jsx(_components.mrow, {\n                  children: _jsx(_components.mtext, {\n                    children: \"CE\"\n                  })\n                }), _jsx(_components.annotation, {\n                  encoding: \"application/x-tex\",\n                  children: \"\\\\text{CE}\"\n                })]\n              })\n            })\n          }), _jsx(_components.span, {\n            className: \"katex-html\",\n            \"aria-hidden\": \"true\",\n            children: _jsxs(_components.span, {\n              className: \"base\",\n              children: [_jsx(_components.span, {\n                className: \"strut\",\n                style: {\n                  height: \"0.6833em\"\n                }\n              }), _jsx(_components.span, {\n                className: \"mord text\",\n                children: _jsx(_components.span, {\n                  className: \"mord\",\n                  children: \"CE\"\n                })\n              })]\n            })\n          })]\n        })\n      }), \" loss by maximizing the loss of the true label of \", _jsx(_components.code, {\n        className: \"language-math math-inline\",\n        children: _jsxs(_components.span, {\n          className: \"katex\",\n          children: [_jsx(_components.span, {\n            className: \"katex-mathml\",\n            children: _jsx(_components.math, {\n              xmlns: \"http://www.w3.org/1998/Math/MathML\",\n              children: _jsxs(_components.semantics, {\n                children: [_jsx(_components.mrow, {\n                  children: _jsx(_components.mi, {\n                    children: \"x\"\n                  })\n                }), _jsx(_components.annotation, {\n                  encoding: \"application/x-tex\",\n                  children: \"x\"\n                })]\n              })\n            })\n          }), _jsx(_components.span, {\n            className: \"katex-html\",\n            \"aria-hidden\": \"true\",\n            children: _jsxs(_components.span, {\n              className: \"base\",\n              children: [_jsx(_components.span, {\n                className: \"strut\",\n                style: {\n                  height: \"0.4306em\"\n                }\n              }), _jsx(_components.span, {\n                className: \"mord mathnormal\",\n                children: \"x\"\n              })]\n            })\n          })]\n        })\n      }), \" and the model's output.\"]\n    }), \"\\n\", _jsx(Math, {\n      children: _jsx(_components.p, {\n        children: _jsx(_components.code, {\n          className: \"language-math math-inline\",\n          children: _jsxs(_components.span, {\n            className: \"katex\",\n            children: [_jsx(_components.span, {\n              className: \"katex-mathml\",\n              children: _jsx(_components.math, {\n                xmlns: \"http://www.w3.org/1998/Math/MathML\",\n                children: _jsxs(_components.semantics, {\n                  children: [_jsxs(_components.mrow, {\n                    children: [_jsxs(_components.msub, {\n                      children: [_jsx(_components.mi, {\n                        mathvariant: \"script\",\n                        children: \"L\"\n                      }), _jsx(_components.mtext, {\n                        children: \"untargeted\"\n                      })]\n                    }), _jsx(_components.mo, {\n                      stretchy: \"false\",\n                      children: \"(\"\n                    }), _jsx(_components.mi, {\n                      children: \"x\"\n                    }), _jsx(_components.mo, {\n                      separator: \"true\",\n                      children: \",\"\n                    }), _jsxs(_components.msub, {\n                      children: [_jsx(_components.mi, {\n                        children: \"y\"\n                      }), _jsx(_components.mtext, {\n                        children: \"true\"\n                      })]\n                    }), _jsx(_components.mo, {\n                      stretchy: \"false\",\n                      children: \")\"\n                    }), _jsx(_components.mo, {\n                      children: \"=\"\n                    }), _jsx(_components.mo, {\n                      children: \"−\"\n                    }), _jsx(_components.mtext, {\n                      children: \"CE\"\n                    }), _jsx(_components.mo, {\n                      stretchy: \"false\",\n                      children: \"(\"\n                    }), _jsxs(_components.msub, {\n                      children: [_jsx(_components.mi, {\n                        children: \"y\"\n                      }), _jsx(_components.mtext, {\n                        children: \"true\"\n                      })]\n                    }), _jsx(_components.mo, {\n                      separator: \"true\",\n                      children: \",\"\n                    }), _jsx(_components.mi, {\n                      children: \"f\"\n                    }), _jsx(_components.mo, {\n                      stretchy: \"false\",\n                      children: \"(\"\n                    }), _jsx(_components.mi, {\n                      children: \"x\"\n                    }), _jsx(_components.mo, {\n                      stretchy: \"false\",\n                      children: \")\"\n                    }), _jsx(_components.mo, {\n                      stretchy: \"false\",\n                      children: \")\"\n                    })]\n                  }), _jsx(_components.annotation, {\n                    encoding: \"application/x-tex\",\n                    children: \"\\\\mathcal{L}_{\\\\text{untargeted}}(x, y_{\\\\text{true}}) = - \\\\text{CE}(y_{\\\\text{true}}, f(x))\"\n                  })]\n                })\n              })\n            }), _jsxs(_components.span, {\n              className: \"katex-html\",\n              \"aria-hidden\": \"true\",\n              children: [_jsxs(_components.span, {\n                className: \"base\",\n                children: [_jsx(_components.span, {\n                  className: \"strut\",\n                  style: {\n                    height: \"1.0361em\",\n                    verticalAlign: \"-0.2861em\"\n                  }\n                }), _jsxs(_components.span, {\n                  className: \"mord\",\n                  children: [_jsx(_components.span, {\n                    className: \"mord mathcal\",\n                    children: \"L\"\n                  }), _jsx(_components.span, {\n                    className: \"msupsub\",\n                    children: _jsxs(_components.span, {\n                      className: \"vlist-t vlist-t2\",\n                      children: [_jsxs(_components.span, {\n                        className: \"vlist-r\",\n                        children: [_jsx(_components.span, {\n                          className: \"vlist\",\n                          style: {\n                            height: \"0.3361em\"\n                          },\n                          children: _jsxs(_components.span, {\n                            style: {\n                              top: \"-2.55em\",\n                              marginLeft: \"0em\",\n                              marginRight: \"0.05em\"\n                            },\n                            children: [_jsx(_components.span, {\n                              className: \"pstrut\",\n                              style: {\n                                height: \"2.7em\"\n                              }\n                            }), _jsx(_components.span, {\n                              className: \"sizing reset-size6 size3 mtight\",\n                              children: _jsx(_components.span, {\n                                className: \"mord mtight\",\n                                children: _jsx(_components.span, {\n                                  className: \"mord text mtight\",\n                                  children: _jsx(_components.span, {\n                                    className: \"mord mtight\",\n                                    children: \"untargeted\"\n                                  })\n                                })\n                              })\n                            })]\n                          })\n                        }), _jsx(_components.span, {\n                          className: \"vlist-s\",\n                          children: \"​\"\n                        })]\n                      }), _jsx(_components.span, {\n                        className: \"vlist-r\",\n                        children: _jsx(_components.span, {\n                          className: \"vlist\",\n                          style: {\n                            height: \"0.2861em\"\n                          },\n                          children: _jsx(_components.span, {})\n                        })\n                      })]\n                    })\n                  })]\n                }), _jsx(_components.span, {\n                  className: \"mopen\",\n                  children: \"(\"\n                }), _jsx(_components.span, {\n                  className: \"mord mathnormal\",\n                  children: \"x\"\n                }), _jsx(_components.span, {\n                  className: \"mpunct\",\n                  children: \",\"\n                }), _jsx(_components.span, {\n                  className: \"mspace\",\n                  style: {\n                    marginRight: \"0.1667em\"\n                  }\n                }), _jsxs(_components.span, {\n                  className: \"mord\",\n                  children: [_jsx(_components.span, {\n                    className: \"mord mathnormal\",\n                    style: {\n                      marginRight: \"0.03588em\"\n                    },\n                    children: \"y\"\n                  }), _jsx(_components.span, {\n                    className: \"msupsub\",\n                    children: _jsxs(_components.span, {\n                      className: \"vlist-t vlist-t2\",\n                      children: [_jsxs(_components.span, {\n                        className: \"vlist-r\",\n                        children: [_jsx(_components.span, {\n                          className: \"vlist\",\n                          style: {\n                            height: \"0.2806em\"\n                          },\n                          children: _jsxs(_components.span, {\n                            style: {\n                              top: \"-2.55em\",\n                              marginLeft: \"-0.0359em\",\n                              marginRight: \"0.05em\"\n                            },\n                            children: [_jsx(_components.span, {\n                              className: \"pstrut\",\n                              style: {\n                                height: \"2.7em\"\n                              }\n                            }), _jsx(_components.span, {\n                              className: \"sizing reset-size6 size3 mtight\",\n                              children: _jsx(_components.span, {\n                                className: \"mord mtight\",\n                                children: _jsx(_components.span, {\n                                  className: \"mord text mtight\",\n                                  children: _jsx(_components.span, {\n                                    className: \"mord mtight\",\n                                    children: \"true\"\n                                  })\n                                })\n                              })\n                            })]\n                          })\n                        }), _jsx(_components.span, {\n                          className: \"vlist-s\",\n                          children: \"​\"\n                        })]\n                      }), _jsx(_components.span, {\n                        className: \"vlist-r\",\n                        children: _jsx(_components.span, {\n                          className: \"vlist\",\n                          style: {\n                            height: \"0.15em\"\n                          },\n                          children: _jsx(_components.span, {})\n                        })\n                      })]\n                    })\n                  })]\n                }), _jsx(_components.span, {\n                  className: \"mclose\",\n                  children: \")\"\n                }), _jsx(_components.span, {\n                  className: \"mspace\",\n                  style: {\n                    marginRight: \"0.2778em\"\n                  }\n                }), _jsx(_components.span, {\n                  className: \"mrel\",\n                  children: \"=\"\n                }), _jsx(_components.span, {\n                  className: \"mspace\",\n                  style: {\n                    marginRight: \"0.2778em\"\n                  }\n                })]\n              }), _jsxs(_components.span, {\n                className: \"base\",\n                children: [_jsx(_components.span, {\n                  className: \"strut\",\n                  style: {\n                    height: \"1em\",\n                    verticalAlign: \"-0.25em\"\n                  }\n                }), _jsx(_components.span, {\n                  className: \"mord\",\n                  children: \"−\"\n                }), _jsx(_components.span, {\n                  className: \"mord text\",\n                  children: _jsx(_components.span, {\n                    className: \"mord\",\n                    children: \"CE\"\n                  })\n                }), _jsx(_components.span, {\n                  className: \"mopen\",\n                  children: \"(\"\n                }), _jsxs(_components.span, {\n                  className: \"mord\",\n                  children: [_jsx(_components.span, {\n                    className: \"mord mathnormal\",\n                    style: {\n                      marginRight: \"0.03588em\"\n                    },\n                    children: \"y\"\n                  }), _jsx(_components.span, {\n                    className: \"msupsub\",\n                    children: _jsxs(_components.span, {\n                      className: \"vlist-t vlist-t2\",\n                      children: [_jsxs(_components.span, {\n                        className: \"vlist-r\",\n                        children: [_jsx(_components.span, {\n                          className: \"vlist\",\n                          style: {\n                            height: \"0.2806em\"\n                          },\n                          children: _jsxs(_components.span, {\n                            style: {\n                              top: \"-2.55em\",\n                              marginLeft: \"-0.0359em\",\n                              marginRight: \"0.05em\"\n                            },\n                            children: [_jsx(_components.span, {\n                              className: \"pstrut\",\n                              style: {\n                                height: \"2.7em\"\n                              }\n                            }), _jsx(_components.span, {\n                              className: \"sizing reset-size6 size3 mtight\",\n                              children: _jsx(_components.span, {\n                                className: \"mord mtight\",\n                                children: _jsx(_components.span, {\n                                  className: \"mord text mtight\",\n                                  children: _jsx(_components.span, {\n                                    className: \"mord mtight\",\n                                    children: \"true\"\n                                  })\n                                })\n                              })\n                            })]\n                          })\n                        }), _jsx(_components.span, {\n                          className: \"vlist-s\",\n                          children: \"​\"\n                        })]\n                      }), _jsx(_components.span, {\n                        className: \"vlist-r\",\n                        children: _jsx(_components.span, {\n                          className: \"vlist\",\n                          style: {\n                            height: \"0.15em\"\n                          },\n                          children: _jsx(_components.span, {})\n                        })\n                      })]\n                    })\n                  })]\n                }), _jsx(_components.span, {\n                  className: \"mpunct\",\n                  children: \",\"\n                }), _jsx(_components.span, {\n                  className: \"mspace\",\n                  style: {\n                    marginRight: \"0.1667em\"\n                  }\n                }), _jsx(_components.span, {\n                  className: \"mord mathnormal\",\n                  style: {\n                    marginRight: \"0.10764em\"\n                  },\n                  children: \"f\"\n                }), _jsx(_components.span, {\n                  className: \"mopen\",\n                  children: \"(\"\n                }), _jsx(_components.span, {\n                  className: \"mord mathnormal\",\n                  children: \"x\"\n                }), _jsx(_components.span, {\n                  className: \"mclose\",\n                  children: \"))\"\n                })]\n              })]\n            })]\n          })\n        })\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Where:\"\n    }), \"\\n\", _jsxs(_components.ul, {\n      children: [\"\\n\", _jsxs(_components.li, {\n        children: [_jsx(_components.code, {\n          className: \"language-math math-inline\",\n          children: _jsxs(_components.span, {\n            className: \"katex\",\n            children: [_jsx(_components.span, {\n              className: \"katex-mathml\",\n              children: _jsx(_components.math, {\n                xmlns: \"http://www.w3.org/1998/Math/MathML\",\n                children: _jsxs(_components.semantics, {\n                  children: [_jsx(_components.mrow, {\n                    children: _jsxs(_components.msub, {\n                      children: [_jsx(_components.mi, {\n                        children: \"y\"\n                      }), _jsx(_components.mtext, {\n                        children: \"true\"\n                      })]\n                    })\n                  }), _jsx(_components.annotation, {\n                    encoding: \"application/x-tex\",\n                    children: \"y_{\\\\text{true}}\"\n                  })]\n                })\n              })\n            }), _jsx(_components.span, {\n              className: \"katex-html\",\n              \"aria-hidden\": \"true\",\n              children: _jsxs(_components.span, {\n                className: \"base\",\n                children: [_jsx(_components.span, {\n                  className: \"strut\",\n                  style: {\n                    height: \"0.625em\",\n                    verticalAlign: \"-0.1944em\"\n                  }\n                }), _jsxs(_components.span, {\n                  className: \"mord\",\n                  children: [_jsx(_components.span, {\n                    className: \"mord mathnormal\",\n                    style: {\n                      marginRight: \"0.03588em\"\n                    },\n                    children: \"y\"\n                  }), _jsx(_components.span, {\n                    className: \"msupsub\",\n                    children: _jsxs(_components.span, {\n                      className: \"vlist-t vlist-t2\",\n                      children: [_jsxs(_components.span, {\n                        className: \"vlist-r\",\n                        children: [_jsx(_components.span, {\n                          className: \"vlist\",\n                          style: {\n                            height: \"0.2806em\"\n                          },\n                          children: _jsxs(_components.span, {\n                            style: {\n                              top: \"-2.55em\",\n                              marginLeft: \"-0.0359em\",\n                              marginRight: \"0.05em\"\n                            },\n                            children: [_jsx(_components.span, {\n                              className: \"pstrut\",\n                              style: {\n                                height: \"2.7em\"\n                              }\n                            }), _jsx(_components.span, {\n                              className: \"sizing reset-size6 size3 mtight\",\n                              children: _jsx(_components.span, {\n                                className: \"mord mtight\",\n                                children: _jsx(_components.span, {\n                                  className: \"mord text mtight\",\n                                  children: _jsx(_components.span, {\n                                    className: \"mord mtight\",\n                                    children: \"true\"\n                                  })\n                                })\n                              })\n                            })]\n                          })\n                        }), _jsx(_components.span, {\n                          className: \"vlist-s\",\n                          children: \"​\"\n                        })]\n                      }), _jsx(_components.span, {\n                        className: \"vlist-r\",\n                        children: _jsx(_components.span, {\n                          className: \"vlist\",\n                          style: {\n                            height: \"0.15em\"\n                          },\n                          children: _jsx(_components.span, {})\n                        })\n                      })]\n                    })\n                  })]\n                })]\n              })\n            })]\n          })\n        }), \" is the label we want to optimize against.\"]\n      }), \"\\n\"]\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"For the solutions, we will also try to keep the adversarial example \", _jsx(_components.strong, {\n        children: \"close\"\n      }), \" to the initial image.\\nThis means that the difference pixels of the original and adversarial image are within a certain number of pixels.\\nWe will do this by \", _jsx(_components.strong, {\n        children: \"clamping\"\n      }), \" the changes after generating an adversarial example or during each iteration.\\nEach solution can just easily remove this restriction, we are keeping it as it leads to the CTF problems easier.\"]\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"Lastly, these solutions require input to start with, the initial \", _jsx(_components.code, {\n        className: \"language-math math-inline\",\n        children: _jsxs(_components.span, {\n          className: \"katex\",\n          children: [_jsx(_components.span, {\n            className: \"katex-mathml\",\n            children: _jsx(_components.math, {\n              xmlns: \"http://www.w3.org/1998/Math/MathML\",\n              children: _jsxs(_components.semantics, {\n                children: [_jsx(_components.mrow, {\n                  children: _jsxs(_components.msup, {\n                    children: [_jsx(_components.mi, {\n                      children: \"x\"\n                    }), _jsx(_components.mn, {\n                      children: \"0\"\n                    })]\n                  })\n                }), _jsx(_components.annotation, {\n                  encoding: \"application/x-tex\",\n                  children: \"x^{0}\"\n                })]\n              })\n            })\n          }), _jsx(_components.span, {\n            className: \"katex-html\",\n            \"aria-hidden\": \"true\",\n            children: _jsxs(_components.span, {\n              className: \"base\",\n              children: [_jsx(_components.span, {\n                className: \"strut\",\n                style: {\n                  height: \"0.8141em\"\n                }\n              }), _jsxs(_components.span, {\n                className: \"mord\",\n                children: [_jsx(_components.span, {\n                  className: \"mord mathnormal\",\n                  children: \"x\"\n                }), _jsx(_components.span, {\n                  className: \"msupsub\",\n                  children: _jsx(_components.span, {\n                    className: \"vlist-t\",\n                    children: _jsx(_components.span, {\n                      className: \"vlist-r\",\n                      children: _jsx(_components.span, {\n                        className: \"vlist\",\n                        style: {\n                          height: \"0.8141em\"\n                        },\n                        children: _jsxs(_components.span, {\n                          style: {\n                            top: \"-3.063em\",\n                            marginRight: \"0.05em\"\n                          },\n                          children: [_jsx(_components.span, {\n                            className: \"pstrut\",\n                            style: {\n                              height: \"2.7em\"\n                            }\n                          }), _jsx(_components.span, {\n                            className: \"sizing reset-size6 size3 mtight\",\n                            children: _jsx(_components.span, {\n                              className: \"mord mtight\",\n                              children: _jsx(_components.span, {\n                                className: \"mord mtight\",\n                                children: \"0\"\n                              })\n                            })\n                          })]\n                        })\n                      })\n                    })\n                  })\n                })]\n              })]\n            })\n          })]\n        })\n      }), \".\\nWe will start with using the white image from the diagram above, and later transition the attack to use a picture of my bird below.\"]\n    }), \"\\n\", _jsxs(\"div\", {\n      className: \"flex items-center justify-center flex-col\",\n      children: [_jsx(\"img\", {\n        src: \"/post-assets/exploring-attacks-1/burb-img.png\",\n        alt: \"Yellow parakeet\"\n      }), _jsx(\"p\", {\n        className: \"mr-4 subtext\",\n        style: {\n          fontSize: '0.75rem'\n        },\n        children: \"ImageNet-trained ResNet18 model's output probabilities for the bird.\"\n      })]\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Let's finally jump in the solutions.\"\n    }), \"\\n\", _jsx(_components.h2, {\n      children: \"Iterative naive solution\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"We can write out a simple solution to generate an adversarial image given an inital image \", _jsx(_components.code, {\n        className: \"language-math math-inline\",\n        children: _jsxs(_components.span, {\n          className: \"katex\",\n          children: [_jsx(_components.span, {\n            className: \"katex-mathml\",\n            children: _jsx(_components.math, {\n              xmlns: \"http://www.w3.org/1998/Math/MathML\",\n              children: _jsxs(_components.semantics, {\n                children: [_jsx(_components.mrow, {\n                  children: _jsx(_components.mi, {\n                    children: \"x\"\n                  })\n                }), _jsx(_components.annotation, {\n                  encoding: \"application/x-tex\",\n                  children: \"x\"\n                })]\n              })\n            })\n          }), _jsx(_components.span, {\n            className: \"katex-html\",\n            \"aria-hidden\": \"true\",\n            children: _jsxs(_components.span, {\n              className: \"base\",\n              children: [_jsx(_components.span, {\n                className: \"strut\",\n                style: {\n                  height: \"0.4306em\"\n                }\n              }), _jsx(_components.span, {\n                className: \"mord mathnormal\",\n                children: \"x\"\n              })]\n            })\n          })]\n        })\n      }), \".\\nWe can iteratively optimize for a better solution.\"]\n    }), \"\\n\", _jsx(Math, {\n      children: _jsx(_components.p, {\n        children: _jsx(_components.code, {\n          className: \"language-math math-inline\",\n          children: _jsxs(_components.span, {\n            className: \"katex\",\n            children: [_jsx(_components.span, {\n              className: \"katex-mathml\",\n              children: _jsx(_components.math, {\n                xmlns: \"http://www.w3.org/1998/Math/MathML\",\n                children: _jsxs(_components.semantics, {\n                  children: [_jsxs(_components.mrow, {\n                    children: [_jsxs(_components.msup, {\n                      children: [_jsx(_components.mi, {\n                        children: \"x\"\n                      }), _jsxs(_components.mrow, {\n                        children: [_jsx(_components.mo, {\n                          stretchy: \"false\",\n                          children: \"(\"\n                        }), _jsx(_components.mi, {\n                          children: \"k\"\n                        }), _jsx(_components.mo, {\n                          children: \"+\"\n                        }), _jsx(_components.mn, {\n                          children: \"1\"\n                        }), _jsx(_components.mo, {\n                          stretchy: \"false\",\n                          children: \")\"\n                        })]\n                      })]\n                    }), _jsx(_components.mo, {\n                      children: \"=\"\n                    }), _jsxs(_components.msup, {\n                      children: [_jsx(_components.mi, {\n                        children: \"x\"\n                      }), _jsxs(_components.mrow, {\n                        children: [_jsx(_components.mo, {\n                          stretchy: \"false\",\n                          children: \"(\"\n                        }), _jsx(_components.mi, {\n                          children: \"k\"\n                        }), _jsx(_components.mo, {\n                          stretchy: \"false\",\n                          children: \")\"\n                        })]\n                      })]\n                    }), _jsx(_components.mo, {\n                      children: \"−\"\n                    }), _jsx(_components.mi, {\n                      children: \"α\"\n                    }), _jsx(_components.mo, {\n                      children: \"⋅\"\n                    }), _jsxs(_components.msub, {\n                      children: [_jsx(_components.mi, {\n                        mathvariant: \"normal\",\n                        children: \"∇\"\n                      }), _jsxs(_components.msup, {\n                        children: [_jsx(_components.mi, {\n                          children: \"x\"\n                        }), _jsxs(_components.mrow, {\n                          children: [_jsx(_components.mo, {\n                            stretchy: \"false\",\n                            children: \"(\"\n                          }), _jsx(_components.mi, {\n                            children: \"k\"\n                          }), _jsx(_components.mo, {\n                            stretchy: \"false\",\n                            children: \")\"\n                          })]\n                        })]\n                      })]\n                    }), _jsxs(_components.msub, {\n                      children: [_jsx(_components.mi, {\n                        mathvariant: \"script\",\n                        children: \"L\"\n                      }), _jsx(_components.mtext, {\n                        children: \"targeted\"\n                      })]\n                    }), _jsx(_components.mo, {\n                      stretchy: \"false\",\n                      children: \"(\"\n                    }), _jsx(_components.mi, {\n                      children: \"f\"\n                    }), _jsx(_components.mo, {\n                      stretchy: \"false\",\n                      children: \"(\"\n                    }), _jsxs(_components.msup, {\n                      children: [_jsx(_components.mi, {\n                        children: \"x\"\n                      }), _jsxs(_components.mrow, {\n                        children: [_jsx(_components.mo, {\n                          stretchy: \"false\",\n                          children: \"(\"\n                        }), _jsx(_components.mi, {\n                          children: \"k\"\n                        }), _jsx(_components.mo, {\n                          stretchy: \"false\",\n                          children: \")\"\n                        })]\n                      })]\n                    }), _jsx(_components.mo, {\n                      stretchy: \"false\",\n                      children: \")\"\n                    }), _jsx(_components.mo, {\n                      separator: \"true\",\n                      children: \",\"\n                    }), _jsxs(_components.msub, {\n                      children: [_jsx(_components.mi, {\n                        children: \"y\"\n                      }), _jsx(_components.mtext, {\n                        children: \"target\"\n                      })]\n                    }), _jsx(_components.mo, {\n                      stretchy: \"false\",\n                      children: \")\"\n                    })]\n                  }), _jsx(_components.annotation, {\n                    encoding: \"application/x-tex\",\n                    children: \"x^{(k+1)} = x^{(k)} - \\\\alpha \\\\cdot \\\\nabla_{x^{(k)}} \\\\mathcal{L}_{\\\\text{targeted}}(f(x^{(k)}), y_{\\\\text{target}})\"\n                  })]\n                })\n              })\n            }), _jsxs(_components.span, {\n              className: \"katex-html\",\n              \"aria-hidden\": \"true\",\n              children: [_jsxs(_components.span, {\n                className: \"base\",\n                children: [_jsx(_components.span, {\n                  className: \"strut\",\n                  style: {\n                    height: \"0.888em\"\n                  }\n                }), _jsxs(_components.span, {\n                  className: \"mord\",\n                  children: [_jsx(_components.span, {\n                    className: \"mord mathnormal\",\n                    children: \"x\"\n                  }), _jsx(_components.span, {\n                    className: \"msupsub\",\n                    children: _jsx(_components.span, {\n                      className: \"vlist-t\",\n                      children: _jsx(_components.span, {\n                        className: \"vlist-r\",\n                        children: _jsx(_components.span, {\n                          className: \"vlist\",\n                          style: {\n                            height: \"0.888em\"\n                          },\n                          children: _jsxs(_components.span, {\n                            style: {\n                              top: \"-3.063em\",\n                              marginRight: \"0.05em\"\n                            },\n                            children: [_jsx(_components.span, {\n                              className: \"pstrut\",\n                              style: {\n                                height: \"2.7em\"\n                              }\n                            }), _jsx(_components.span, {\n                              className: \"sizing reset-size6 size3 mtight\",\n                              children: _jsxs(_components.span, {\n                                className: \"mord mtight\",\n                                children: [_jsx(_components.span, {\n                                  className: \"mopen mtight\",\n                                  children: \"(\"\n                                }), _jsx(_components.span, {\n                                  className: \"mord mathnormal mtight\",\n                                  style: {\n                                    marginRight: \"0.03148em\"\n                                  },\n                                  children: \"k\"\n                                }), _jsx(_components.span, {\n                                  className: \"mbin mtight\",\n                                  children: \"+\"\n                                }), _jsx(_components.span, {\n                                  className: \"mord mtight\",\n                                  children: \"1\"\n                                }), _jsx(_components.span, {\n                                  className: \"mclose mtight\",\n                                  children: \")\"\n                                })]\n                              })\n                            })]\n                          })\n                        })\n                      })\n                    })\n                  })]\n                }), _jsx(_components.span, {\n                  className: \"mspace\",\n                  style: {\n                    marginRight: \"0.2778em\"\n                  }\n                }), _jsx(_components.span, {\n                  className: \"mrel\",\n                  children: \"=\"\n                }), _jsx(_components.span, {\n                  className: \"mspace\",\n                  style: {\n                    marginRight: \"0.2778em\"\n                  }\n                })]\n              }), _jsxs(_components.span, {\n                className: \"base\",\n                children: [_jsx(_components.span, {\n                  className: \"strut\",\n                  style: {\n                    height: \"0.9713em\",\n                    verticalAlign: \"-0.0833em\"\n                  }\n                }), _jsxs(_components.span, {\n                  className: \"mord\",\n                  children: [_jsx(_components.span, {\n                    className: \"mord mathnormal\",\n                    children: \"x\"\n                  }), _jsx(_components.span, {\n                    className: \"msupsub\",\n                    children: _jsx(_components.span, {\n                      className: \"vlist-t\",\n                      children: _jsx(_components.span, {\n                        className: \"vlist-r\",\n                        children: _jsx(_components.span, {\n                          className: \"vlist\",\n                          style: {\n                            height: \"0.888em\"\n                          },\n                          children: _jsxs(_components.span, {\n                            style: {\n                              top: \"-3.063em\",\n                              marginRight: \"0.05em\"\n                            },\n                            children: [_jsx(_components.span, {\n                              className: \"pstrut\",\n                              style: {\n                                height: \"2.7em\"\n                              }\n                            }), _jsx(_components.span, {\n                              className: \"sizing reset-size6 size3 mtight\",\n                              children: _jsxs(_components.span, {\n                                className: \"mord mtight\",\n                                children: [_jsx(_components.span, {\n                                  className: \"mopen mtight\",\n                                  children: \"(\"\n                                }), _jsx(_components.span, {\n                                  className: \"mord mathnormal mtight\",\n                                  style: {\n                                    marginRight: \"0.03148em\"\n                                  },\n                                  children: \"k\"\n                                }), _jsx(_components.span, {\n                                  className: \"mclose mtight\",\n                                  children: \")\"\n                                })]\n                              })\n                            })]\n                          })\n                        })\n                      })\n                    })\n                  })]\n                }), _jsx(_components.span, {\n                  className: \"mspace\",\n                  style: {\n                    marginRight: \"0.2222em\"\n                  }\n                }), _jsx(_components.span, {\n                  className: \"mbin\",\n                  children: \"−\"\n                }), _jsx(_components.span, {\n                  className: \"mspace\",\n                  style: {\n                    marginRight: \"0.2222em\"\n                  }\n                })]\n              }), _jsxs(_components.span, {\n                className: \"base\",\n                children: [_jsx(_components.span, {\n                  className: \"strut\",\n                  style: {\n                    height: \"0.4445em\"\n                  }\n                }), _jsx(_components.span, {\n                  className: \"mord mathnormal\",\n                  style: {\n                    marginRight: \"0.0037em\"\n                  },\n                  children: \"α\"\n                }), _jsx(_components.span, {\n                  className: \"mspace\",\n                  style: {\n                    marginRight: \"0.2222em\"\n                  }\n                }), _jsx(_components.span, {\n                  className: \"mbin\",\n                  children: \"⋅\"\n                }), _jsx(_components.span, {\n                  className: \"mspace\",\n                  style: {\n                    marginRight: \"0.2222em\"\n                  }\n                })]\n              }), _jsxs(_components.span, {\n                className: \"base\",\n                children: [_jsx(_components.span, {\n                  className: \"strut\",\n                  style: {\n                    height: \"1.1741em\",\n                    verticalAlign: \"-0.2861em\"\n                  }\n                }), _jsxs(_components.span, {\n                  className: \"mord\",\n                  children: [_jsx(_components.span, {\n                    className: \"mord\",\n                    children: \"∇\"\n                  }), _jsx(_components.span, {\n                    className: \"msupsub\",\n                    children: _jsxs(_components.span, {\n                      className: \"vlist-t vlist-t2\",\n                      children: [_jsxs(_components.span, {\n                        className: \"vlist-r\",\n                        children: [_jsx(_components.span, {\n                          className: \"vlist\",\n                          style: {\n                            height: \"0.3448em\"\n                          },\n                          children: _jsxs(_components.span, {\n                            style: {\n                              top: \"-2.4694em\",\n                              marginLeft: \"0em\",\n                              marginRight: \"0.05em\"\n                            },\n                            children: [_jsx(_components.span, {\n                              className: \"pstrut\",\n                              style: {\n                                height: \"2.7em\"\n                              }\n                            }), _jsx(_components.span, {\n                              className: \"sizing reset-size6 size3 mtight\",\n                              children: _jsx(_components.span, {\n                                className: \"mord mtight\",\n                                children: _jsxs(_components.span, {\n                                  className: \"mord mtight\",\n                                  children: [_jsx(_components.span, {\n                                    className: \"mord mathnormal mtight\",\n                                    children: \"x\"\n                                  }), _jsx(_components.span, {\n                                    className: \"msupsub\",\n                                    children: _jsx(_components.span, {\n                                      className: \"vlist-t\",\n                                      children: _jsx(_components.span, {\n                                        className: \"vlist-r\",\n                                        children: _jsx(_components.span, {\n                                          className: \"vlist\",\n                                          style: {\n                                            height: \"0.822em\"\n                                          },\n                                          children: _jsxs(_components.span, {\n                                            style: {\n                                              top: \"-2.822em\",\n                                              marginRight: \"0.0714em\"\n                                            },\n                                            children: [_jsx(_components.span, {\n                                              className: \"pstrut\",\n                                              style: {\n                                                height: \"2.5357em\"\n                                              }\n                                            }), _jsx(_components.span, {\n                                              className: \"sizing reset-size3 size1 mtight\",\n                                              children: _jsxs(_components.span, {\n                                                className: \"mord mtight\",\n                                                children: [_jsx(_components.span, {\n                                                  className: \"mopen mtight\",\n                                                  children: \"(\"\n                                                }), _jsx(_components.span, {\n                                                  className: \"mord mathnormal mtight\",\n                                                  style: {\n                                                    marginRight: \"0.03148em\"\n                                                  },\n                                                  children: \"k\"\n                                                }), _jsx(_components.span, {\n                                                  className: \"mclose mtight\",\n                                                  children: \")\"\n                                                })]\n                                              })\n                                            })]\n                                          })\n                                        })\n                                      })\n                                    })\n                                  })]\n                                })\n                              })\n                            })]\n                          })\n                        }), _jsx(_components.span, {\n                          className: \"vlist-s\",\n                          children: \"​\"\n                        })]\n                      }), _jsx(_components.span, {\n                        className: \"vlist-r\",\n                        children: _jsx(_components.span, {\n                          className: \"vlist\",\n                          style: {\n                            height: \"0.2306em\"\n                          },\n                          children: _jsx(_components.span, {})\n                        })\n                      })]\n                    })\n                  })]\n                }), _jsxs(_components.span, {\n                  className: \"mord\",\n                  children: [_jsx(_components.span, {\n                    className: \"mord mathcal\",\n                    children: \"L\"\n                  }), _jsx(_components.span, {\n                    className: \"msupsub\",\n                    children: _jsxs(_components.span, {\n                      className: \"vlist-t vlist-t2\",\n                      children: [_jsxs(_components.span, {\n                        className: \"vlist-r\",\n                        children: [_jsx(_components.span, {\n                          className: \"vlist\",\n                          style: {\n                            height: \"0.3361em\"\n                          },\n                          children: _jsxs(_components.span, {\n                            style: {\n                              top: \"-2.55em\",\n                              marginLeft: \"0em\",\n                              marginRight: \"0.05em\"\n                            },\n                            children: [_jsx(_components.span, {\n                              className: \"pstrut\",\n                              style: {\n                                height: \"2.7em\"\n                              }\n                            }), _jsx(_components.span, {\n                              className: \"sizing reset-size6 size3 mtight\",\n                              children: _jsx(_components.span, {\n                                className: \"mord mtight\",\n                                children: _jsx(_components.span, {\n                                  className: \"mord text mtight\",\n                                  children: _jsx(_components.span, {\n                                    className: \"mord mtight\",\n                                    children: \"targeted\"\n                                  })\n                                })\n                              })\n                            })]\n                          })\n                        }), _jsx(_components.span, {\n                          className: \"vlist-s\",\n                          children: \"​\"\n                        })]\n                      }), _jsx(_components.span, {\n                        className: \"vlist-r\",\n                        children: _jsx(_components.span, {\n                          className: \"vlist\",\n                          style: {\n                            height: \"0.2861em\"\n                          },\n                          children: _jsx(_components.span, {})\n                        })\n                      })]\n                    })\n                  })]\n                }), _jsx(_components.span, {\n                  className: \"mopen\",\n                  children: \"(\"\n                }), _jsx(_components.span, {\n                  className: \"mord mathnormal\",\n                  style: {\n                    marginRight: \"0.10764em\"\n                  },\n                  children: \"f\"\n                }), _jsx(_components.span, {\n                  className: \"mopen\",\n                  children: \"(\"\n                }), _jsxs(_components.span, {\n                  className: \"mord\",\n                  children: [_jsx(_components.span, {\n                    className: \"mord mathnormal\",\n                    children: \"x\"\n                  }), _jsx(_components.span, {\n                    className: \"msupsub\",\n                    children: _jsx(_components.span, {\n                      className: \"vlist-t\",\n                      children: _jsx(_components.span, {\n                        className: \"vlist-r\",\n                        children: _jsx(_components.span, {\n                          className: \"vlist\",\n                          style: {\n                            height: \"0.888em\"\n                          },\n                          children: _jsxs(_components.span, {\n                            style: {\n                              top: \"-3.063em\",\n                              marginRight: \"0.05em\"\n                            },\n                            children: [_jsx(_components.span, {\n                              className: \"pstrut\",\n                              style: {\n                                height: \"2.7em\"\n                              }\n                            }), _jsx(_components.span, {\n                              className: \"sizing reset-size6 size3 mtight\",\n                              children: _jsxs(_components.span, {\n                                className: \"mord mtight\",\n                                children: [_jsx(_components.span, {\n                                  className: \"mopen mtight\",\n                                  children: \"(\"\n                                }), _jsx(_components.span, {\n                                  className: \"mord mathnormal mtight\",\n                                  style: {\n                                    marginRight: \"0.03148em\"\n                                  },\n                                  children: \"k\"\n                                }), _jsx(_components.span, {\n                                  className: \"mclose mtight\",\n                                  children: \")\"\n                                })]\n                              })\n                            })]\n                          })\n                        })\n                      })\n                    })\n                  })]\n                }), _jsx(_components.span, {\n                  className: \"mclose\",\n                  children: \")\"\n                }), _jsx(_components.span, {\n                  className: \"mpunct\",\n                  children: \",\"\n                }), _jsx(_components.span, {\n                  className: \"mspace\",\n                  style: {\n                    marginRight: \"0.1667em\"\n                  }\n                }), _jsxs(_components.span, {\n                  className: \"mord\",\n                  children: [_jsx(_components.span, {\n                    className: \"mord mathnormal\",\n                    style: {\n                      marginRight: \"0.03588em\"\n                    },\n                    children: \"y\"\n                  }), _jsx(_components.span, {\n                    className: \"msupsub\",\n                    children: _jsxs(_components.span, {\n                      className: \"vlist-t vlist-t2\",\n                      children: [_jsxs(_components.span, {\n                        className: \"vlist-r\",\n                        children: [_jsx(_components.span, {\n                          className: \"vlist\",\n                          style: {\n                            height: \"0.2806em\"\n                          },\n                          children: _jsxs(_components.span, {\n                            style: {\n                              top: \"-2.55em\",\n                              marginLeft: \"-0.0359em\",\n                              marginRight: \"0.05em\"\n                            },\n                            children: [_jsx(_components.span, {\n                              className: \"pstrut\",\n                              style: {\n                                height: \"2.7em\"\n                              }\n                            }), _jsx(_components.span, {\n                              className: \"sizing reset-size6 size3 mtight\",\n                              children: _jsx(_components.span, {\n                                className: \"mord mtight\",\n                                children: _jsx(_components.span, {\n                                  className: \"mord text mtight\",\n                                  children: _jsx(_components.span, {\n                                    className: \"mord mtight\",\n                                    children: \"target\"\n                                  })\n                                })\n                              })\n                            })]\n                          })\n                        }), _jsx(_components.span, {\n                          className: \"vlist-s\",\n                          children: \"​\"\n                        })]\n                      }), _jsx(_components.span, {\n                        className: \"vlist-r\",\n                        children: _jsx(_components.span, {\n                          className: \"vlist\",\n                          style: {\n                            height: \"0.2861em\"\n                          },\n                          children: _jsx(_components.span, {})\n                        })\n                      })]\n                    })\n                  })]\n                }), _jsx(_components.span, {\n                  className: \"mclose\",\n                  children: \")\"\n                })]\n              })]\n            })]\n          })\n        })\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Where:\"\n    }), \"\\n\", _jsxs(_components.ul, {\n      children: [\"\\n\", _jsxs(_components.li, {\n        children: [_jsx(_components.code, {\n          className: \"language-math math-inline\",\n          children: _jsxs(_components.span, {\n            className: \"katex\",\n            children: [_jsx(_components.span, {\n              className: \"katex-mathml\",\n              children: _jsx(_components.math, {\n                xmlns: \"http://www.w3.org/1998/Math/MathML\",\n                children: _jsxs(_components.semantics, {\n                  children: [_jsx(_components.mrow, {\n                    children: _jsxs(_components.msup, {\n                      children: [_jsx(_components.mi, {\n                        children: \"x\"\n                      }), _jsxs(_components.mrow, {\n                        children: [_jsx(_components.mo, {\n                          stretchy: \"false\",\n                          children: \"(\"\n                        }), _jsx(_components.mi, {\n                          children: \"k\"\n                        }), _jsx(_components.mo, {\n                          stretchy: \"false\",\n                          children: \")\"\n                        })]\n                      })]\n                    })\n                  }), _jsx(_components.annotation, {\n                    encoding: \"application/x-tex\",\n                    children: \"x^{(k)}\"\n                  })]\n                })\n              })\n            }), _jsx(_components.span, {\n              className: \"katex-html\",\n              \"aria-hidden\": \"true\",\n              children: _jsxs(_components.span, {\n                className: \"base\",\n                children: [_jsx(_components.span, {\n                  className: \"strut\",\n                  style: {\n                    height: \"0.888em\"\n                  }\n                }), _jsxs(_components.span, {\n                  className: \"mord\",\n                  children: [_jsx(_components.span, {\n                    className: \"mord mathnormal\",\n                    children: \"x\"\n                  }), _jsx(_components.span, {\n                    className: \"msupsub\",\n                    children: _jsx(_components.span, {\n                      className: \"vlist-t\",\n                      children: _jsx(_components.span, {\n                        className: \"vlist-r\",\n                        children: _jsx(_components.span, {\n                          className: \"vlist\",\n                          style: {\n                            height: \"0.888em\"\n                          },\n                          children: _jsxs(_components.span, {\n                            style: {\n                              top: \"-3.063em\",\n                              marginRight: \"0.05em\"\n                            },\n                            children: [_jsx(_components.span, {\n                              className: \"pstrut\",\n                              style: {\n                                height: \"2.7em\"\n                              }\n                            }), _jsx(_components.span, {\n                              className: \"sizing reset-size6 size3 mtight\",\n                              children: _jsxs(_components.span, {\n                                className: \"mord mtight\",\n                                children: [_jsx(_components.span, {\n                                  className: \"mopen mtight\",\n                                  children: \"(\"\n                                }), _jsx(_components.span, {\n                                  className: \"mord mathnormal mtight\",\n                                  style: {\n                                    marginRight: \"0.03148em\"\n                                  },\n                                  children: \"k\"\n                                }), _jsx(_components.span, {\n                                  className: \"mclose mtight\",\n                                  children: \")\"\n                                })]\n                              })\n                            })]\n                          })\n                        })\n                      })\n                    })\n                  })]\n                })]\n              })\n            })]\n          })\n        }), \" denotes the image at iteration \", _jsx(_components.code, {\n          className: \"language-math math-inline\",\n          children: _jsxs(_components.span, {\n            className: \"katex\",\n            children: [_jsx(_components.span, {\n              className: \"katex-mathml\",\n              children: _jsx(_components.math, {\n                xmlns: \"http://www.w3.org/1998/Math/MathML\",\n                children: _jsxs(_components.semantics, {\n                  children: [_jsx(_components.mrow, {\n                    children: _jsx(_components.mi, {\n                      children: \"k\"\n                    })\n                  }), _jsx(_components.annotation, {\n                    encoding: \"application/x-tex\",\n                    children: \"k\"\n                  })]\n                })\n              })\n            }), _jsx(_components.span, {\n              className: \"katex-html\",\n              \"aria-hidden\": \"true\",\n              children: _jsxs(_components.span, {\n                className: \"base\",\n                children: [_jsx(_components.span, {\n                  className: \"strut\",\n                  style: {\n                    height: \"0.6944em\"\n                  }\n                }), _jsx(_components.span, {\n                  className: \"mord mathnormal\",\n                  style: {\n                    marginRight: \"0.03148em\"\n                  },\n                  children: \"k\"\n                })]\n              })\n            })]\n          })\n        }), \".\"]\n      }), \"\\n\", _jsxs(_components.li, {\n        children: [_jsx(_components.code, {\n          className: \"language-math math-inline\",\n          children: _jsxs(_components.span, {\n            className: \"katex\",\n            children: [_jsx(_components.span, {\n              className: \"katex-mathml\",\n              children: _jsx(_components.math, {\n                xmlns: \"http://www.w3.org/1998/Math/MathML\",\n                children: _jsxs(_components.semantics, {\n                  children: [_jsx(_components.mrow, {\n                    children: _jsx(_components.mi, {\n                      children: \"α\"\n                    })\n                  }), _jsx(_components.annotation, {\n                    encoding: \"application/x-tex\",\n                    children: \"\\\\alpha\"\n                  })]\n                })\n              })\n            }), _jsx(_components.span, {\n              className: \"katex-html\",\n              \"aria-hidden\": \"true\",\n              children: _jsxs(_components.span, {\n                className: \"base\",\n                children: [_jsx(_components.span, {\n                  className: \"strut\",\n                  style: {\n                    height: \"0.4306em\"\n                  }\n                }), _jsx(_components.span, {\n                  className: \"mord mathnormal\",\n                  style: {\n                    marginRight: \"0.0037em\"\n                  },\n                  children: \"α\"\n                })]\n              })\n            })]\n          })\n        }), \" is the step size at each iteration.\"]\n      }), \"\\n\", _jsxs(_components.li, {\n        children: [_jsx(_components.code, {\n          className: \"language-math math-inline\",\n          children: _jsxs(_components.span, {\n            className: \"katex\",\n            children: [_jsx(_components.span, {\n              className: \"katex-mathml\",\n              children: _jsx(_components.math, {\n                xmlns: \"http://www.w3.org/1998/Math/MathML\",\n                children: _jsxs(_components.semantics, {\n                  children: [_jsxs(_components.mrow, {\n                    children: [_jsxs(_components.msub, {\n                      children: [_jsx(_components.mi, {\n                        mathvariant: \"normal\",\n                        children: \"∇\"\n                      }), _jsxs(_components.msup, {\n                        children: [_jsx(_components.mi, {\n                          children: \"x\"\n                        }), _jsxs(_components.mrow, {\n                          children: [_jsx(_components.mo, {\n                            stretchy: \"false\",\n                            children: \"(\"\n                          }), _jsx(_components.mi, {\n                            children: \"k\"\n                          }), _jsx(_components.mo, {\n                            stretchy: \"false\",\n                            children: \")\"\n                          })]\n                        })]\n                      })]\n                    }), _jsxs(_components.msub, {\n                      children: [_jsx(_components.mi, {\n                        mathvariant: \"script\",\n                        children: \"L\"\n                      }), _jsx(_components.mtext, {\n                        children: \"targeted\"\n                      })]\n                    }), _jsx(_components.mo, {\n                      stretchy: \"false\",\n                      children: \"(\"\n                    }), _jsx(_components.mi, {\n                      children: \"f\"\n                    }), _jsx(_components.mo, {\n                      stretchy: \"false\",\n                      children: \"(\"\n                    }), _jsxs(_components.msup, {\n                      children: [_jsx(_components.mi, {\n                        children: \"x\"\n                      }), _jsxs(_components.mrow, {\n                        children: [_jsx(_components.mo, {\n                          stretchy: \"false\",\n                          children: \"(\"\n                        }), _jsx(_components.mi, {\n                          children: \"k\"\n                        }), _jsx(_components.mo, {\n                          stretchy: \"false\",\n                          children: \")\"\n                        })]\n                      })]\n                    }), _jsx(_components.mo, {\n                      stretchy: \"false\",\n                      children: \")\"\n                    }), _jsx(_components.mo, {\n                      separator: \"true\",\n                      children: \",\"\n                    }), _jsxs(_components.msub, {\n                      children: [_jsx(_components.mi, {\n                        children: \"y\"\n                      }), _jsx(_components.mtext, {\n                        children: \"target\"\n                      })]\n                    }), _jsx(_components.mo, {\n                      stretchy: \"false\",\n                      children: \")\"\n                    })]\n                  }), _jsx(_components.annotation, {\n                    encoding: \"application/x-tex\",\n                    children: \"\\\\nabla_{x^{(k)}} \\\\mathcal{L}_{\\\\text{targeted}}(f(x^{(k)}), y_{\\\\text{target}})\"\n                  })]\n                })\n              })\n            }), _jsx(_components.span, {\n              className: \"katex-html\",\n              \"aria-hidden\": \"true\",\n              children: _jsxs(_components.span, {\n                className: \"base\",\n                children: [_jsx(_components.span, {\n                  className: \"strut\",\n                  style: {\n                    height: \"1.1741em\",\n                    verticalAlign: \"-0.2861em\"\n                  }\n                }), _jsxs(_components.span, {\n                  className: \"mord\",\n                  children: [_jsx(_components.span, {\n                    className: \"mord\",\n                    children: \"∇\"\n                  }), _jsx(_components.span, {\n                    className: \"msupsub\",\n                    children: _jsxs(_components.span, {\n                      className: \"vlist-t vlist-t2\",\n                      children: [_jsxs(_components.span, {\n                        className: \"vlist-r\",\n                        children: [_jsx(_components.span, {\n                          className: \"vlist\",\n                          style: {\n                            height: \"0.3448em\"\n                          },\n                          children: _jsxs(_components.span, {\n                            style: {\n                              top: \"-2.4694em\",\n                              marginLeft: \"0em\",\n                              marginRight: \"0.05em\"\n                            },\n                            children: [_jsx(_components.span, {\n                              className: \"pstrut\",\n                              style: {\n                                height: \"2.7em\"\n                              }\n                            }), _jsx(_components.span, {\n                              className: \"sizing reset-size6 size3 mtight\",\n                              children: _jsx(_components.span, {\n                                className: \"mord mtight\",\n                                children: _jsxs(_components.span, {\n                                  className: \"mord mtight\",\n                                  children: [_jsx(_components.span, {\n                                    className: \"mord mathnormal mtight\",\n                                    children: \"x\"\n                                  }), _jsx(_components.span, {\n                                    className: \"msupsub\",\n                                    children: _jsx(_components.span, {\n                                      className: \"vlist-t\",\n                                      children: _jsx(_components.span, {\n                                        className: \"vlist-r\",\n                                        children: _jsx(_components.span, {\n                                          className: \"vlist\",\n                                          style: {\n                                            height: \"0.822em\"\n                                          },\n                                          children: _jsxs(_components.span, {\n                                            style: {\n                                              top: \"-2.822em\",\n                                              marginRight: \"0.0714em\"\n                                            },\n                                            children: [_jsx(_components.span, {\n                                              className: \"pstrut\",\n                                              style: {\n                                                height: \"2.5357em\"\n                                              }\n                                            }), _jsx(_components.span, {\n                                              className: \"sizing reset-size3 size1 mtight\",\n                                              children: _jsxs(_components.span, {\n                                                className: \"mord mtight\",\n                                                children: [_jsx(_components.span, {\n                                                  className: \"mopen mtight\",\n                                                  children: \"(\"\n                                                }), _jsx(_components.span, {\n                                                  className: \"mord mathnormal mtight\",\n                                                  style: {\n                                                    marginRight: \"0.03148em\"\n                                                  },\n                                                  children: \"k\"\n                                                }), _jsx(_components.span, {\n                                                  className: \"mclose mtight\",\n                                                  children: \")\"\n                                                })]\n                                              })\n                                            })]\n                                          })\n                                        })\n                                      })\n                                    })\n                                  })]\n                                })\n                              })\n                            })]\n                          })\n                        }), _jsx(_components.span, {\n                          className: \"vlist-s\",\n                          children: \"​\"\n                        })]\n                      }), _jsx(_components.span, {\n                        className: \"vlist-r\",\n                        children: _jsx(_components.span, {\n                          className: \"vlist\",\n                          style: {\n                            height: \"0.2306em\"\n                          },\n                          children: _jsx(_components.span, {})\n                        })\n                      })]\n                    })\n                  })]\n                }), _jsxs(_components.span, {\n                  className: \"mord\",\n                  children: [_jsx(_components.span, {\n                    className: \"mord mathcal\",\n                    children: \"L\"\n                  }), _jsx(_components.span, {\n                    className: \"msupsub\",\n                    children: _jsxs(_components.span, {\n                      className: \"vlist-t vlist-t2\",\n                      children: [_jsxs(_components.span, {\n                        className: \"vlist-r\",\n                        children: [_jsx(_components.span, {\n                          className: \"vlist\",\n                          style: {\n                            height: \"0.3361em\"\n                          },\n                          children: _jsxs(_components.span, {\n                            style: {\n                              top: \"-2.55em\",\n                              marginLeft: \"0em\",\n                              marginRight: \"0.05em\"\n                            },\n                            children: [_jsx(_components.span, {\n                              className: \"pstrut\",\n                              style: {\n                                height: \"2.7em\"\n                              }\n                            }), _jsx(_components.span, {\n                              className: \"sizing reset-size6 size3 mtight\",\n                              children: _jsx(_components.span, {\n                                className: \"mord mtight\",\n                                children: _jsx(_components.span, {\n                                  className: \"mord text mtight\",\n                                  children: _jsx(_components.span, {\n                                    className: \"mord mtight\",\n                                    children: \"targeted\"\n                                  })\n                                })\n                              })\n                            })]\n                          })\n                        }), _jsx(_components.span, {\n                          className: \"vlist-s\",\n                          children: \"​\"\n                        })]\n                      }), _jsx(_components.span, {\n                        className: \"vlist-r\",\n                        children: _jsx(_components.span, {\n                          className: \"vlist\",\n                          style: {\n                            height: \"0.2861em\"\n                          },\n                          children: _jsx(_components.span, {})\n                        })\n                      })]\n                    })\n                  })]\n                }), _jsx(_components.span, {\n                  className: \"mopen\",\n                  children: \"(\"\n                }), _jsx(_components.span, {\n                  className: \"mord mathnormal\",\n                  style: {\n                    marginRight: \"0.10764em\"\n                  },\n                  children: \"f\"\n                }), _jsx(_components.span, {\n                  className: \"mopen\",\n                  children: \"(\"\n                }), _jsxs(_components.span, {\n                  className: \"mord\",\n                  children: [_jsx(_components.span, {\n                    className: \"mord mathnormal\",\n                    children: \"x\"\n                  }), _jsx(_components.span, {\n                    className: \"msupsub\",\n                    children: _jsx(_components.span, {\n                      className: \"vlist-t\",\n                      children: _jsx(_components.span, {\n                        className: \"vlist-r\",\n                        children: _jsx(_components.span, {\n                          className: \"vlist\",\n                          style: {\n                            height: \"0.888em\"\n                          },\n                          children: _jsxs(_components.span, {\n                            style: {\n                              top: \"-3.063em\",\n                              marginRight: \"0.05em\"\n                            },\n                            children: [_jsx(_components.span, {\n                              className: \"pstrut\",\n                              style: {\n                                height: \"2.7em\"\n                              }\n                            }), _jsx(_components.span, {\n                              className: \"sizing reset-size6 size3 mtight\",\n                              children: _jsxs(_components.span, {\n                                className: \"mord mtight\",\n                                children: [_jsx(_components.span, {\n                                  className: \"mopen mtight\",\n                                  children: \"(\"\n                                }), _jsx(_components.span, {\n                                  className: \"mord mathnormal mtight\",\n                                  style: {\n                                    marginRight: \"0.03148em\"\n                                  },\n                                  children: \"k\"\n                                }), _jsx(_components.span, {\n                                  className: \"mclose mtight\",\n                                  children: \")\"\n                                })]\n                              })\n                            })]\n                          })\n                        })\n                      })\n                    })\n                  })]\n                }), _jsx(_components.span, {\n                  className: \"mclose\",\n                  children: \")\"\n                }), _jsx(_components.span, {\n                  className: \"mpunct\",\n                  children: \",\"\n                }), _jsx(_components.span, {\n                  className: \"mspace\",\n                  style: {\n                    marginRight: \"0.1667em\"\n                  }\n                }), _jsxs(_components.span, {\n                  className: \"mord\",\n                  children: [_jsx(_components.span, {\n                    className: \"mord mathnormal\",\n                    style: {\n                      marginRight: \"0.03588em\"\n                    },\n                    children: \"y\"\n                  }), _jsx(_components.span, {\n                    className: \"msupsub\",\n                    children: _jsxs(_components.span, {\n                      className: \"vlist-t vlist-t2\",\n                      children: [_jsxs(_components.span, {\n                        className: \"vlist-r\",\n                        children: [_jsx(_components.span, {\n                          className: \"vlist\",\n                          style: {\n                            height: \"0.2806em\"\n                          },\n                          children: _jsxs(_components.span, {\n                            style: {\n                              top: \"-2.55em\",\n                              marginLeft: \"-0.0359em\",\n                              marginRight: \"0.05em\"\n                            },\n                            children: [_jsx(_components.span, {\n                              className: \"pstrut\",\n                              style: {\n                                height: \"2.7em\"\n                              }\n                            }), _jsx(_components.span, {\n                              className: \"sizing reset-size6 size3 mtight\",\n                              children: _jsx(_components.span, {\n                                className: \"mord mtight\",\n                                children: _jsx(_components.span, {\n                                  className: \"mord text mtight\",\n                                  children: _jsx(_components.span, {\n                                    className: \"mord mtight\",\n                                    children: \"target\"\n                                  })\n                                })\n                              })\n                            })]\n                          })\n                        }), _jsx(_components.span, {\n                          className: \"vlist-s\",\n                          children: \"​\"\n                        })]\n                      }), _jsx(_components.span, {\n                        className: \"vlist-r\",\n                        children: _jsx(_components.span, {\n                          className: \"vlist\",\n                          style: {\n                            height: \"0.2861em\"\n                          },\n                          children: _jsx(_components.span, {})\n                        })\n                      })]\n                    })\n                  })]\n                }), _jsx(_components.span, {\n                  className: \"mclose\",\n                  children: \")\"\n                })]\n              })\n            })]\n          })\n        }), \" represents the gradient of the cost function with respect to \", _jsx(_components.code, {\n          className: \"language-math math-inline\",\n          children: _jsxs(_components.span, {\n            className: \"katex\",\n            children: [_jsx(_components.span, {\n              className: \"katex-mathml\",\n              children: _jsx(_components.math, {\n                xmlns: \"http://www.w3.org/1998/Math/MathML\",\n                children: _jsxs(_components.semantics, {\n                  children: [_jsx(_components.mrow, {\n                    children: _jsxs(_components.msup, {\n                      children: [_jsx(_components.mi, {\n                        children: \"x\"\n                      }), _jsxs(_components.mrow, {\n                        children: [_jsx(_components.mo, {\n                          stretchy: \"false\",\n                          children: \"(\"\n                        }), _jsx(_components.mi, {\n                          children: \"k\"\n                        }), _jsx(_components.mo, {\n                          stretchy: \"false\",\n                          children: \")\"\n                        })]\n                      })]\n                    })\n                  }), _jsx(_components.annotation, {\n                    encoding: \"application/x-tex\",\n                    children: \"x^{(k)}\"\n                  })]\n                })\n              })\n            }), _jsx(_components.span, {\n              className: \"katex-html\",\n              \"aria-hidden\": \"true\",\n              children: _jsxs(_components.span, {\n                className: \"base\",\n                children: [_jsx(_components.span, {\n                  className: \"strut\",\n                  style: {\n                    height: \"0.888em\"\n                  }\n                }), _jsxs(_components.span, {\n                  className: \"mord\",\n                  children: [_jsx(_components.span, {\n                    className: \"mord mathnormal\",\n                    children: \"x\"\n                  }), _jsx(_components.span, {\n                    className: \"msupsub\",\n                    children: _jsx(_components.span, {\n                      className: \"vlist-t\",\n                      children: _jsx(_components.span, {\n                        className: \"vlist-r\",\n                        children: _jsx(_components.span, {\n                          className: \"vlist\",\n                          style: {\n                            height: \"0.888em\"\n                          },\n                          children: _jsxs(_components.span, {\n                            style: {\n                              top: \"-3.063em\",\n                              marginRight: \"0.05em\"\n                            },\n                            children: [_jsx(_components.span, {\n                              className: \"pstrut\",\n                              style: {\n                                height: \"2.7em\"\n                              }\n                            }), _jsx(_components.span, {\n                              className: \"sizing reset-size6 size3 mtight\",\n                              children: _jsxs(_components.span, {\n                                className: \"mord mtight\",\n                                children: [_jsx(_components.span, {\n                                  className: \"mopen mtight\",\n                                  children: \"(\"\n                                }), _jsx(_components.span, {\n                                  className: \"mord mathnormal mtight\",\n                                  style: {\n                                    marginRight: \"0.03148em\"\n                                  },\n                                  children: \"k\"\n                                }), _jsx(_components.span, {\n                                  className: \"mclose mtight\",\n                                  children: \")\"\n                                })]\n                              })\n                            })]\n                          })\n                        })\n                      })\n                    })\n                  })]\n                })]\n              })\n            })]\n          })\n        }), \".\"]\n      }), \"\\n\"]\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Using gradient descent, we can slowly come up with a solution that maximizes the probability of the target.\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"Lets try an example in python using pytorch and apply this simple iterative solution.\\nStarting from a completely white image, lets try to get the model to predict class index \", _jsx(_components.code, {\n        className: \"language-math math-inline\",\n        children: _jsxs(_components.span, {\n          className: \"katex\",\n          children: [_jsx(_components.span, {\n            className: \"katex-mathml\",\n            children: _jsx(_components.math, {\n              xmlns: \"http://www.w3.org/1998/Math/MathML\",\n              children: _jsxs(_components.semantics, {\n                children: [_jsx(_components.mrow, {\n                  children: _jsx(_components.mn, {\n                    children: \"0\"\n                  })\n                }), _jsx(_components.annotation, {\n                  encoding: \"application/x-tex\",\n                  children: \"0\"\n                })]\n              })\n            })\n          }), _jsx(_components.span, {\n            className: \"katex-html\",\n            \"aria-hidden\": \"true\",\n            children: _jsxs(_components.span, {\n              className: \"base\",\n              children: [_jsx(_components.span, {\n                className: \"strut\",\n                style: {\n                  height: \"0.6444em\"\n                }\n              }), _jsx(_components.span, {\n                className: \"mord\",\n                children: \"0\"\n              })]\n            })\n          })]\n        })\n      }), \", which maps to \\\"tench.\\\"\\nHere is the python code to do this gradient descent:\"]\n    }), \"\\n\", _jsx(_components.pre, {\n      className: \"language-python\",\n      children: _jsxs(_components.code, {\n        className: \"language-python code-highlight\",\n        children: [_jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"target_output \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" torch\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"tensor\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"[\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"]\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" dtype\", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \"torch\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), _jsx(_components.span, {\n            className: \"token builtin\",\n            children: \"long\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token comment\",\n            children: \"# class 0 is \\\"tench\\\"\"\n          }), \"\\n\"]\n        }), _jsx(_components.span, {\n          className: \"code-line\",\n          children: \"\\n\"\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [_jsx(_components.span, {\n            className: \"token comment\",\n            children: \"# convert the white image to a tensor and normalize it to the same range as the model's input (0-1)\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"x \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" torch\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"tensor\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"white_img\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" dtype\", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \"torch\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"float32\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"permute\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"2\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"1\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"unsqueeze\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"/\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"255.0\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"x\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"requires_grad \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token boolean\",\n            children: \"True\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token comment\",\n            children: \"# allow gradients to be calculated since we want to optimize the image\"\n          }), \"\\n\"]\n        }), _jsx(_components.span, {\n          className: \"code-line\",\n          children: \"\\n\"\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"alpha \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"1.\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token comment\",\n            children: \"# step size for the gradient descent\"\n          }), \"\\n\"]\n        }), _jsx(_components.span, {\n          className: \"code-line\",\n          children: \"\\n\"\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [_jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"for\"\n          }), \" iteration \", _jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"in\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token builtin\",\n            children: \"range\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"15\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    output \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" model\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"x\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsx(_components.span, {\n          className: \"code-line\",\n          children: \"\\n\"\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    \", _jsx(_components.span, {\n            className: \"token comment\",\n            children: \"# our objective is to maximize the probability of the target class\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    loss \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" F\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"cross_entropy\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"output\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" target_output\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsx(_components.span, {\n          className: \"code-line\",\n          children: \"\\n\"\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    \", _jsx(_components.span, {\n            className: \"token comment\",\n            children: \"# calculate the gradient of the loss with respect to the input image\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    loss\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"backward\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsx(_components.span, {\n          className: \"code-line\",\n          children: \"\\n\"\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    \", _jsx(_components.span, {\n            className: \"token comment\",\n            children: \"# apply gradient descent to the image, this step is usually done by the optimizer\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    \", _jsx(_components.span, {\n            className: \"token comment\",\n            children: \"# but we're doing it manually here, by taking the gradient of the image and updating it\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    x\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"data \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" x\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"data \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"-\"\n          }), \" alpha \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"*\"\n          }), \" x\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"grad\\n\"]\n        }), _jsx(_components.span, {\n          className: \"code-line\",\n          children: \"\\n\"\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    \", _jsx(_components.span, {\n            className: \"token comment\",\n            children: \"# zero the gradient for the next iteration\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    x\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"grad\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"zero_\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token comment\",\n            children: \"# probably not needed\"\n          }), \"\\n\"]\n        }), _jsx(_components.span, {\n          className: \"code-line\",\n          children: \"\\n\"\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    \", _jsx(_components.span, {\n            className: \"token comment\",\n            children: \"# clamp the image to the valid pixel range [0, 1]\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    x\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"data \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" torch\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"clamp\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"x\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"data\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"1\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        })]\n      })\n    }), \"\\n\", _jsxs(\"p\", {\n      className: \"mr-4 subtext\",\n      style: {\n        fontSize: '0.75rem'\n      },\n      children: [\"full code: \", _jsx(_components.a, {\n        href: \"https://github.com/OutWrest/blog-handouts/blob/main/exploring-attacks-1/attacks-introduction.ipynb\",\n        children: \"https://github.com/OutWrest/blog-handouts/blob/main/exploring-attacks-1/attacks-introduction.ipynb\"\n      })]\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Output:\"\n    }), \"\\n\", _jsx(_components.pre, {\n      className: \"language-bash\",\n      children: _jsxs(_components.code, {\n        className: \"language-bash code-highlight\",\n        children: [_jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"Iter: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0\"\n          }), \"  \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Loss:  \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"7.5425\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Pred: \", _jsx(_components.span, {\n            className: \"token string\",\n            children: \"\\\"window shade\\\"\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"5.05\"\n          }), \"% confidence\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"Iter: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"1\"\n          }), \"  \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Loss:  \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"9.2704\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Pred: \", _jsx(_components.span, {\n            className: \"token string\",\n            children: \"\\\"dishrag\\\"\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"3.04\"\n          }), \"% confidence\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"Iter: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"2\"\n          }), \"  \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Loss:  \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"10.1515\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Pred: \", _jsx(_components.span, {\n            className: \"token string\",\n            children: \"\\\"nematode\\\"\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"1.45\"\n          }), \"% confidence\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"Iter: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"3\"\n          }), \"  \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Loss:  \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"7.6952\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Pred: \", _jsx(_components.span, {\n            className: \"token string\",\n            children: \"\\\"brain coral\\\"\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"2.15\"\n          }), \"% confidence\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"Iter: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"4\"\n          }), \"  \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Loss:  \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"5.4389\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Pred: \", _jsx(_components.span, {\n            className: \"token string\",\n            children: \"\\\"American alligator\\\"\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"1.96\"\n          }), \"% confidence\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"Iter: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"5\"\n          }), \"  \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Loss:  \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"4.7709\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Pred: \", _jsx(_components.span, {\n            className: \"token string\",\n            children: \"\\\"American alligator\\\"\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"5.01\"\n          }), \"% confidence\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"Iter: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"6\"\n          }), \"  \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Loss:  \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"3.2306\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Pred: \", _jsx(_components.span, {\n            className: \"token string\",\n            children: \"\\\"tench\\\"\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"10.06\"\n          }), \"% confidence\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"Iter: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"7\"\n          }), \"  \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Loss:  \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"2.2304\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Pred: \", _jsx(_components.span, {\n            className: \"token string\",\n            children: \"\\\"brain coral\\\"\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"17.83\"\n          }), \"% confidence\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"Iter: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"8\"\n          }), \"  \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Loss:  \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"2.4371\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Pred: \", _jsx(_components.span, {\n            className: \"token string\",\n            children: \"\\\"tench\\\"\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"35.66\"\n          }), \"% confidence\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"Iter: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"9\"\n          }), \"  \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Loss:  \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"1.0132\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Pred: \", _jsx(_components.span, {\n            className: \"token string\",\n            children: \"\\\"tench\\\"\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"96.03\"\n          }), \"% confidence\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"Iter: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"10\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Loss:  \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.0390\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Pred: \", _jsx(_components.span, {\n            className: \"token string\",\n            children: \"\\\"tench\\\"\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"99.90\"\n          }), \"% confidence\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"Iter: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"11\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Loss:  \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.0015\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Pred: \", _jsx(_components.span, {\n            className: \"token string\",\n            children: \"\\\"tench\\\"\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"99.92\"\n          }), \"% confidence\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"Iter: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"12\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Loss:  \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.0013\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Pred: \", _jsx(_components.span, {\n            className: \"token string\",\n            children: \"\\\"tench\\\"\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"99.93\"\n          }), \"% confidence\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"Iter: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"13\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Loss:  \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.0012\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Pred: \", _jsx(_components.span, {\n            className: \"token string\",\n            children: \"\\\"tench\\\"\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"99.93\"\n          }), \"% confidence\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"Iter: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"14\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Loss:  \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.0011\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Pred: \", _jsx(_components.span, {\n            className: \"token string\",\n            children: \"\\\"tench\\\"\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"99.94\"\n          }), \"% confidence\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        })]\n      })\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"\\\"tench\\\" maps to our target index of \", _jsx(_components.code, {\n        className: \"language-math math-inline\",\n        children: _jsxs(_components.span, {\n          className: \"katex\",\n          children: [_jsx(_components.span, {\n            className: \"katex-mathml\",\n            children: _jsx(_components.math, {\n              xmlns: \"http://www.w3.org/1998/Math/MathML\",\n              children: _jsxs(_components.semantics, {\n                children: [_jsx(_components.mrow, {\n                  children: _jsx(_components.mn, {\n                    children: \"0\"\n                  })\n                }), _jsx(_components.annotation, {\n                  encoding: \"application/x-tex\",\n                  children: \"0\"\n                })]\n              })\n            })\n          }), _jsx(_components.span, {\n            className: \"katex-html\",\n            \"aria-hidden\": \"true\",\n            children: _jsxs(_components.span, {\n              className: \"base\",\n              children: [_jsx(_components.span, {\n                className: \"strut\",\n                style: {\n                  height: \"0.6444em\"\n                }\n              }), _jsx(_components.span, {\n                className: \"mord\",\n                children: \"0\"\n              })]\n            })\n          })]\n        })\n      }), \", \", _jsx(_components.strong, {\n        children: \"succes!\"\n      })]\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Lets see how the adversarial example looks.\"\n    }), \"\\n\", _jsxs(\"div\", {\n      className: \"flex items-center justify-center flex-col\",\n      children: [_jsx(\"img\", {\n        className: \"block\",\n        src: \"/post-assets/exploring-attacks-1/white-img-adv-1.png\",\n        alt: \"White image classified as tench\"\n      }), _jsx(\"p\", {\n        className: \"mr-4 subtext\",\n        style: {\n          fontSize: '0.75rem'\n        },\n        children: \"The output adversarial example.\"\n      })]\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Starting from a completely white image - we are able to produce an adversarial image with any class we pick.\\nThe adversarial example is not visually recognizable as a \\\"tench\\\" but the model predicts it with high confidence.\"\n    }), \"\\n\", _jsx(_components.h3, {\n      children: \"How different is the adversarial example to our original image?\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"To calculate the difference of the original image adversarial example, we track three different metrics.\\nWe will keep track of the max, mean, and min pixel difference of the two images.\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"The code to do this is very simple:\"\n    }), \"\\n\", _jsx(_components.pre, {\n      className: \"language-python\",\n      children: _jsxs(_components.code, {\n        className: \"language-python code-highlight\",\n        children: [_jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"diff \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" np\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), _jsx(_components.span, {\n            className: \"token builtin\",\n            children: \"abs\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"white_img \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"-\"\n          }), \" current_img\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"max_diff\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" mean_diff\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" min_diff \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" diff\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), _jsx(_components.span, {\n            className: \"token builtin\",\n            children: \"max\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" diff\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"mean\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" diff\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), _jsx(_components.span, {\n            className: \"token builtin\",\n            children: \"min\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        })]\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Here is the pixel difference from our initial solution:\"\n    }), \"\\n\", _jsx(_components.pre, {\n      className: \"language-bash\",\n      children: _jsxs(_components.code, {\n        className: \"language-bash code-highlight\",\n        children: [_jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"Max  difference:  \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"209.00\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"Mean difference:  \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"14.36\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"Min  difference:  \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.00\"\n          }), \"\\n\"]\n        })]\n      })\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"Let's try to create another adversarial using the same method but lets try to minimize our \", _jsx(_components.em, {\n        children: \"changes\"\n      }), \" to the image.\\nWe will clamp the image so that the changes are within a certain range.\\nI will arbitrarily pick that our adversarial example should \", _jsxs(_components.strong, {\n        children: [\"within \", _jsx(_components.code, {\n          className: \"language-math math-inline\",\n          children: _jsxs(_components.span, {\n            className: \"katex\",\n            children: [_jsx(_components.span, {\n              className: \"katex-mathml\",\n              children: _jsx(_components.math, {\n                xmlns: \"http://www.w3.org/1998/Math/MathML\",\n                children: _jsxs(_components.semantics, {\n                  children: [_jsx(_components.mrow, {\n                    children: _jsx(_components.mn, {\n                      children: \"10\"\n                    })\n                  }), _jsx(_components.annotation, {\n                    encoding: \"application/x-tex\",\n                    children: \"10\"\n                  })]\n                })\n              })\n            }), _jsx(_components.span, {\n              className: \"katex-html\",\n              \"aria-hidden\": \"true\",\n              children: _jsxs(_components.span, {\n                className: \"base\",\n                children: [_jsx(_components.span, {\n                  className: \"strut\",\n                  style: {\n                    height: \"0.6444em\"\n                  }\n                }), _jsx(_components.span, {\n                  className: \"mord\",\n                  children: \"10\"\n                })]\n              })\n            })]\n          })\n        }), \" pixels\"]\n      }), \".\\nThis is common theme that shows up in CTF challeges, so lets try this out here.\"]\n    }), \"\\n\", _jsx(_components.h3, {\n      children: \"Iterative naive solution (with clamping)\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"Let's define a new function \", _jsx(_components.code, {\n        className: \"language-math math-inline\",\n        children: _jsxs(_components.span, {\n          className: \"katex\",\n          children: [_jsx(_components.span, {\n            className: \"katex-mathml\",\n            children: _jsx(_components.math, {\n              xmlns: \"http://www.w3.org/1998/Math/MathML\",\n              children: _jsxs(_components.semantics, {\n                children: [_jsx(_components.mrow, {\n                  children: _jsx(_components.mtext, {\n                    children: \"clip\"\n                  })\n                }), _jsx(_components.annotation, {\n                  encoding: \"application/x-tex\",\n                  children: \"\\\\text{clip}\"\n                })]\n              })\n            })\n          }), _jsx(_components.span, {\n            className: \"katex-html\",\n            \"aria-hidden\": \"true\",\n            children: _jsxs(_components.span, {\n              className: \"base\",\n              children: [_jsx(_components.span, {\n                className: \"strut\",\n                style: {\n                  height: \"0.8889em\",\n                  verticalAlign: \"-0.1944em\"\n                }\n              }), _jsx(_components.span, {\n                className: \"mord text\",\n                children: _jsx(_components.span, {\n                  className: \"mord\",\n                  children: \"clip\"\n                })\n              })]\n            })\n          })]\n        })\n      }), \" that can simplify clamping.\"]\n    }), \"\\n\", _jsx(Math, {\n      children: _jsx(_components.p, {\n        children: _jsx(_components.code, {\n          className: \"language-math math-inline\",\n          children: _jsxs(_components.span, {\n            className: \"katex\",\n            children: [_jsx(_components.span, {\n              className: \"katex-mathml\",\n              children: _jsx(_components.math, {\n                xmlns: \"http://www.w3.org/1998/Math/MathML\",\n                children: _jsxs(_components.semantics, {\n                  children: [_jsxs(_components.mrow, {\n                    children: [_jsx(_components.mtext, {\n                      children: \"clip\"\n                    }), _jsx(_components.mo, {\n                      stretchy: \"false\",\n                      children: \"(\"\n                    }), _jsx(_components.mi, {\n                      children: \"x\"\n                    }), _jsx(_components.mo, {\n                      separator: \"true\",\n                      children: \",\"\n                    }), _jsx(_components.mi, {\n                      children: \"ϵ\"\n                    }), _jsx(_components.mo, {\n                      stretchy: \"false\",\n                      children: \")\"\n                    }), _jsx(_components.mo, {\n                      children: \"=\"\n                    }), _jsx(_components.mtext, {\n                      children: \"clamp\"\n                    }), _jsx(_components.mo, {\n                      stretchy: \"false\",\n                      children: \"(\"\n                    }), _jsx(_components.mi, {\n                      children: \"x\"\n                    }), _jsx(_components.mo, {\n                      separator: \"true\",\n                      children: \",\"\n                    }), _jsx(_components.mi, {\n                      children: \"x\"\n                    }), _jsx(_components.mo, {\n                      children: \"−\"\n                    }), _jsx(_components.mi, {\n                      children: \"ϵ\"\n                    }), _jsx(_components.mo, {\n                      separator: \"true\",\n                      children: \",\"\n                    }), _jsx(_components.mi, {\n                      children: \"x\"\n                    }), _jsx(_components.mo, {\n                      children: \"+\"\n                    }), _jsx(_components.mi, {\n                      children: \"ϵ\"\n                    }), _jsx(_components.mo, {\n                      stretchy: \"false\",\n                      children: \")\"\n                    })]\n                  }), _jsx(_components.annotation, {\n                    encoding: \"application/x-tex\",\n                    children: \"\\\\text{clip}(x,\\\\epsilon) = \\\\text{clamp}(x, x - \\\\epsilon, x + \\\\epsilon)\"\n                  })]\n                })\n              })\n            }), _jsxs(_components.span, {\n              className: \"katex-html\",\n              \"aria-hidden\": \"true\",\n              children: [_jsxs(_components.span, {\n                className: \"base\",\n                children: [_jsx(_components.span, {\n                  className: \"strut\",\n                  style: {\n                    height: \"1em\",\n                    verticalAlign: \"-0.25em\"\n                  }\n                }), _jsx(_components.span, {\n                  className: \"mord text\",\n                  children: _jsx(_components.span, {\n                    className: \"mord\",\n                    children: \"clip\"\n                  })\n                }), _jsx(_components.span, {\n                  className: \"mopen\",\n                  children: \"(\"\n                }), _jsx(_components.span, {\n                  className: \"mord mathnormal\",\n                  children: \"x\"\n                }), _jsx(_components.span, {\n                  className: \"mpunct\",\n                  children: \",\"\n                }), _jsx(_components.span, {\n                  className: \"mspace\",\n                  style: {\n                    marginRight: \"0.1667em\"\n                  }\n                }), _jsx(_components.span, {\n                  className: \"mord mathnormal\",\n                  children: \"ϵ\"\n                }), _jsx(_components.span, {\n                  className: \"mclose\",\n                  children: \")\"\n                }), _jsx(_components.span, {\n                  className: \"mspace\",\n                  style: {\n                    marginRight: \"0.2778em\"\n                  }\n                }), _jsx(_components.span, {\n                  className: \"mrel\",\n                  children: \"=\"\n                }), _jsx(_components.span, {\n                  className: \"mspace\",\n                  style: {\n                    marginRight: \"0.2778em\"\n                  }\n                })]\n              }), _jsxs(_components.span, {\n                className: \"base\",\n                children: [_jsx(_components.span, {\n                  className: \"strut\",\n                  style: {\n                    height: \"1em\",\n                    verticalAlign: \"-0.25em\"\n                  }\n                }), _jsx(_components.span, {\n                  className: \"mord text\",\n                  children: _jsx(_components.span, {\n                    className: \"mord\",\n                    children: \"clamp\"\n                  })\n                }), _jsx(_components.span, {\n                  className: \"mopen\",\n                  children: \"(\"\n                }), _jsx(_components.span, {\n                  className: \"mord mathnormal\",\n                  children: \"x\"\n                }), _jsx(_components.span, {\n                  className: \"mpunct\",\n                  children: \",\"\n                }), _jsx(_components.span, {\n                  className: \"mspace\",\n                  style: {\n                    marginRight: \"0.1667em\"\n                  }\n                }), _jsx(_components.span, {\n                  className: \"mord mathnormal\",\n                  children: \"x\"\n                }), _jsx(_components.span, {\n                  className: \"mspace\",\n                  style: {\n                    marginRight: \"0.2222em\"\n                  }\n                }), _jsx(_components.span, {\n                  className: \"mbin\",\n                  children: \"−\"\n                }), _jsx(_components.span, {\n                  className: \"mspace\",\n                  style: {\n                    marginRight: \"0.2222em\"\n                  }\n                })]\n              }), _jsxs(_components.span, {\n                className: \"base\",\n                children: [_jsx(_components.span, {\n                  className: \"strut\",\n                  style: {\n                    height: \"0.7778em\",\n                    verticalAlign: \"-0.1944em\"\n                  }\n                }), _jsx(_components.span, {\n                  className: \"mord mathnormal\",\n                  children: \"ϵ\"\n                }), _jsx(_components.span, {\n                  className: \"mpunct\",\n                  children: \",\"\n                }), _jsx(_components.span, {\n                  className: \"mspace\",\n                  style: {\n                    marginRight: \"0.1667em\"\n                  }\n                }), _jsx(_components.span, {\n                  className: \"mord mathnormal\",\n                  children: \"x\"\n                }), _jsx(_components.span, {\n                  className: \"mspace\",\n                  style: {\n                    marginRight: \"0.2222em\"\n                  }\n                }), _jsx(_components.span, {\n                  className: \"mbin\",\n                  children: \"+\"\n                }), _jsx(_components.span, {\n                  className: \"mspace\",\n                  style: {\n                    marginRight: \"0.2222em\"\n                  }\n                })]\n              }), _jsxs(_components.span, {\n                className: \"base\",\n                children: [_jsx(_components.span, {\n                  className: \"strut\",\n                  style: {\n                    height: \"1em\",\n                    verticalAlign: \"-0.25em\"\n                  }\n                }), _jsx(_components.span, {\n                  className: \"mord mathnormal\",\n                  children: \"ϵ\"\n                }), _jsx(_components.span, {\n                  className: \"mclose\",\n                  children: \")\"\n                })]\n              })]\n            })]\n          })\n        })\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Where:\"\n    }), \"\\n\", _jsxs(_components.ul, {\n      children: [\"\\n\", _jsxs(_components.li, {\n        children: [_jsx(_components.code, {\n          className: \"language-math math-inline\",\n          children: _jsxs(_components.span, {\n            className: \"katex\",\n            children: [_jsx(_components.span, {\n              className: \"katex-mathml\",\n              children: _jsx(_components.math, {\n                xmlns: \"http://www.w3.org/1998/Math/MathML\",\n                children: _jsxs(_components.semantics, {\n                  children: [_jsxs(_components.mrow, {\n                    children: [_jsx(_components.mtext, {\n                      children: \"clamp\"\n                    }), _jsx(_components.mo, {\n                      stretchy: \"false\",\n                      children: \"(\"\n                    }), _jsx(_components.mi, {\n                      children: \"x\"\n                    }), _jsx(_components.mo, {\n                      separator: \"true\",\n                      children: \",\"\n                    }), _jsx(_components.mtext, {\n                      children: \"min_value\"\n                    }), _jsx(_components.mo, {\n                      separator: \"true\",\n                      children: \",\"\n                    }), _jsx(_components.mtext, {\n                      children: \"max_value\"\n                    }), _jsx(_components.mo, {\n                      stretchy: \"false\",\n                      children: \")\"\n                    })]\n                  }), _jsx(_components.annotation, {\n                    encoding: \"application/x-tex\",\n                    children: \"\\\\text{clamp}(x, \\\\text{min\\\\_value}, \\\\text{max\\\\_value})\"\n                  })]\n                })\n              })\n            }), _jsx(_components.span, {\n              className: \"katex-html\",\n              \"aria-hidden\": \"true\",\n              children: _jsxs(_components.span, {\n                className: \"base\",\n                children: [_jsx(_components.span, {\n                  className: \"strut\",\n                  style: {\n                    height: \"1.06em\",\n                    verticalAlign: \"-0.31em\"\n                  }\n                }), _jsx(_components.span, {\n                  className: \"mord text\",\n                  children: _jsx(_components.span, {\n                    className: \"mord\",\n                    children: \"clamp\"\n                  })\n                }), _jsx(_components.span, {\n                  className: \"mopen\",\n                  children: \"(\"\n                }), _jsx(_components.span, {\n                  className: \"mord mathnormal\",\n                  children: \"x\"\n                }), _jsx(_components.span, {\n                  className: \"mpunct\",\n                  children: \",\"\n                }), _jsx(_components.span, {\n                  className: \"mspace\",\n                  style: {\n                    marginRight: \"0.1667em\"\n                  }\n                }), _jsx(_components.span, {\n                  className: \"mord text\",\n                  children: _jsx(_components.span, {\n                    className: \"mord\",\n                    children: \"min_value\"\n                  })\n                }), _jsx(_components.span, {\n                  className: \"mpunct\",\n                  children: \",\"\n                }), _jsx(_components.span, {\n                  className: \"mspace\",\n                  style: {\n                    marginRight: \"0.1667em\"\n                  }\n                }), _jsx(_components.span, {\n                  className: \"mord text\",\n                  children: _jsx(_components.span, {\n                    className: \"mord\",\n                    children: \"max_value\"\n                  })\n                }), _jsx(_components.span, {\n                  className: \"mclose\",\n                  children: \")\"\n                })]\n              })\n            })]\n          })\n        }), \" is function that clamps the value of \", _jsx(_components.code, {\n          className: \"language-math math-inline\",\n          children: _jsxs(_components.span, {\n            className: \"katex\",\n            children: [_jsx(_components.span, {\n              className: \"katex-mathml\",\n              children: _jsx(_components.math, {\n                xmlns: \"http://www.w3.org/1998/Math/MathML\",\n                children: _jsxs(_components.semantics, {\n                  children: [_jsx(_components.mrow, {\n                    children: _jsx(_components.mi, {\n                      children: \"x\"\n                    })\n                  }), _jsx(_components.annotation, {\n                    encoding: \"application/x-tex\",\n                    children: \"x\"\n                  })]\n                })\n              })\n            }), _jsx(_components.span, {\n              className: \"katex-html\",\n              \"aria-hidden\": \"true\",\n              children: _jsxs(_components.span, {\n                className: \"base\",\n                children: [_jsx(_components.span, {\n                  className: \"strut\",\n                  style: {\n                    height: \"0.4306em\"\n                  }\n                }), _jsx(_components.span, {\n                  className: \"mord mathnormal\",\n                  children: \"x\"\n                })]\n              })\n            })]\n          })\n        }), \" between \", _jsx(_components.code, {\n          className: \"language-math math-inline\",\n          children: _jsxs(_components.span, {\n            className: \"katex\",\n            children: [_jsx(_components.span, {\n              className: \"katex-mathml\",\n              children: _jsx(_components.math, {\n                xmlns: \"http://www.w3.org/1998/Math/MathML\",\n                children: _jsxs(_components.semantics, {\n                  children: [_jsx(_components.mrow, {\n                    children: _jsx(_components.mtext, {\n                      children: \"min_value\"\n                    })\n                  }), _jsx(_components.annotation, {\n                    encoding: \"application/x-tex\",\n                    children: \"\\\\text{min\\\\_value}\"\n                  })]\n                })\n              })\n            }), _jsx(_components.span, {\n              className: \"katex-html\",\n              \"aria-hidden\": \"true\",\n              children: _jsxs(_components.span, {\n                className: \"base\",\n                children: [_jsx(_components.span, {\n                  className: \"strut\",\n                  style: {\n                    height: \"1.0044em\",\n                    verticalAlign: \"-0.31em\"\n                  }\n                }), _jsx(_components.span, {\n                  className: \"mord text\",\n                  children: _jsx(_components.span, {\n                    className: \"mord\",\n                    children: \"min_value\"\n                  })\n                })]\n              })\n            })]\n          })\n        }), \" and \", _jsx(_components.code, {\n          className: \"language-math math-inline\",\n          children: _jsxs(_components.span, {\n            className: \"katex\",\n            children: [_jsx(_components.span, {\n              className: \"katex-mathml\",\n              children: _jsx(_components.math, {\n                xmlns: \"http://www.w3.org/1998/Math/MathML\",\n                children: _jsxs(_components.semantics, {\n                  children: [_jsx(_components.mrow, {\n                    children: _jsx(_components.mtext, {\n                      children: \"max_value\"\n                    })\n                  }), _jsx(_components.annotation, {\n                    encoding: \"application/x-tex\",\n                    children: \"\\\\text{max\\\\_value}\"\n                  })]\n                })\n              })\n            }), _jsx(_components.span, {\n              className: \"katex-html\",\n              \"aria-hidden\": \"true\",\n              children: _jsxs(_components.span, {\n                className: \"base\",\n                children: [_jsx(_components.span, {\n                  className: \"strut\",\n                  style: {\n                    height: \"1.0044em\",\n                    verticalAlign: \"-0.31em\"\n                  }\n                }), _jsx(_components.span, {\n                  className: \"mord text\",\n                  children: _jsx(_components.span, {\n                    className: \"mord\",\n                    children: \"max_value\"\n                  })\n                })]\n              })\n            })]\n          })\n        }), \".\"]\n      }), \"\\n\", _jsxs(_components.li, {\n        children: [_jsx(_components.code, {\n          className: \"language-math math-inline\",\n          children: _jsxs(_components.span, {\n            className: \"katex\",\n            children: [_jsx(_components.span, {\n              className: \"katex-mathml\",\n              children: _jsx(_components.math, {\n                xmlns: \"http://www.w3.org/1998/Math/MathML\",\n                children: _jsxs(_components.semantics, {\n                  children: [_jsx(_components.mrow, {\n                    children: _jsx(_components.mi, {\n                      children: \"ϵ\"\n                    })\n                  }), _jsx(_components.annotation, {\n                    encoding: \"application/x-tex\",\n                    children: \"\\\\epsilon\"\n                  })]\n                })\n              })\n            }), _jsx(_components.span, {\n              className: \"katex-html\",\n              \"aria-hidden\": \"true\",\n              children: _jsxs(_components.span, {\n                className: \"base\",\n                children: [_jsx(_components.span, {\n                  className: \"strut\",\n                  style: {\n                    height: \"0.4306em\"\n                  }\n                }), _jsx(_components.span, {\n                  className: \"mord mathnormal\",\n                  children: \"ϵ\"\n                })]\n              })\n            })]\n          })\n        }), \" is the maximum allowed change.\"]\n      }), \"\\n\"]\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"We easily add a restriction to our equation to clip \", _jsx(_components.code, {\n        className: \"language-math math-inline\",\n        children: _jsxs(_components.span, {\n          className: \"katex\",\n          children: [_jsx(_components.span, {\n            className: \"katex-mathml\",\n            children: _jsx(_components.math, {\n              xmlns: \"http://www.w3.org/1998/Math/MathML\",\n              children: _jsxs(_components.semantics, {\n                children: [_jsx(_components.mrow, {\n                  children: _jsxs(_components.msup, {\n                    children: [_jsx(_components.mi, {\n                      children: \"x\"\n                    }), _jsxs(_components.mrow, {\n                      children: [_jsx(_components.mo, {\n                        stretchy: \"false\",\n                        children: \"(\"\n                      }), _jsx(_components.mi, {\n                        children: \"k\"\n                      }), _jsx(_components.mo, {\n                        stretchy: \"false\",\n                        children: \")\"\n                      })]\n                    })]\n                  })\n                }), _jsx(_components.annotation, {\n                  encoding: \"application/x-tex\",\n                  children: \"x^{(k)}\"\n                })]\n              })\n            })\n          }), _jsx(_components.span, {\n            className: \"katex-html\",\n            \"aria-hidden\": \"true\",\n            children: _jsxs(_components.span, {\n              className: \"base\",\n              children: [_jsx(_components.span, {\n                className: \"strut\",\n                style: {\n                  height: \"0.888em\"\n                }\n              }), _jsxs(_components.span, {\n                className: \"mord\",\n                children: [_jsx(_components.span, {\n                  className: \"mord mathnormal\",\n                  children: \"x\"\n                }), _jsx(_components.span, {\n                  className: \"msupsub\",\n                  children: _jsx(_components.span, {\n                    className: \"vlist-t\",\n                    children: _jsx(_components.span, {\n                      className: \"vlist-r\",\n                      children: _jsx(_components.span, {\n                        className: \"vlist\",\n                        style: {\n                          height: \"0.888em\"\n                        },\n                        children: _jsxs(_components.span, {\n                          style: {\n                            top: \"-3.063em\",\n                            marginRight: \"0.05em\"\n                          },\n                          children: [_jsx(_components.span, {\n                            className: \"pstrut\",\n                            style: {\n                              height: \"2.7em\"\n                            }\n                          }), _jsx(_components.span, {\n                            className: \"sizing reset-size6 size3 mtight\",\n                            children: _jsxs(_components.span, {\n                              className: \"mord mtight\",\n                              children: [_jsx(_components.span, {\n                                className: \"mopen mtight\",\n                                children: \"(\"\n                              }), _jsx(_components.span, {\n                                className: \"mord mathnormal mtight\",\n                                style: {\n                                  marginRight: \"0.03148em\"\n                                },\n                                children: \"k\"\n                              }), _jsx(_components.span, {\n                                className: \"mclose mtight\",\n                                children: \")\"\n                              })]\n                            })\n                          })]\n                        })\n                      })\n                    })\n                  })\n                })]\n              })]\n            })\n          })]\n        })\n      }), \" to be within \", _jsx(_components.code, {\n        className: \"language-math math-inline\",\n        children: _jsxs(_components.span, {\n          className: \"katex\",\n          children: [_jsx(_components.span, {\n            className: \"katex-mathml\",\n            children: _jsx(_components.math, {\n              xmlns: \"http://www.w3.org/1998/Math/MathML\",\n              children: _jsxs(_components.semantics, {\n                children: [_jsx(_components.mrow, {\n                  children: _jsx(_components.mn, {\n                    children: \"10\"\n                  })\n                }), _jsx(_components.annotation, {\n                  encoding: \"application/x-tex\",\n                  children: \"10\"\n                })]\n              })\n            })\n          }), _jsx(_components.span, {\n            className: \"katex-html\",\n            \"aria-hidden\": \"true\",\n            children: _jsxs(_components.span, {\n              className: \"base\",\n              children: [_jsx(_components.span, {\n                className: \"strut\",\n                style: {\n                  height: \"0.6444em\"\n                }\n              }), _jsx(_components.span, {\n                className: \"mord\",\n                children: \"10\"\n              })]\n            })\n          })]\n        })\n      }), \" pixels of \", _jsx(_components.code, {\n        className: \"language-math math-inline\",\n        children: _jsxs(_components.span, {\n          className: \"katex\",\n          children: [_jsx(_components.span, {\n            className: \"katex-mathml\",\n            children: _jsx(_components.math, {\n              xmlns: \"http://www.w3.org/1998/Math/MathML\",\n              children: _jsxs(_components.semantics, {\n                children: [_jsx(_components.mrow, {\n                  children: _jsxs(_components.msup, {\n                    children: [_jsx(_components.mi, {\n                      children: \"x\"\n                    }), _jsx(_components.mn, {\n                      children: \"0\"\n                    })]\n                  })\n                }), _jsx(_components.annotation, {\n                  encoding: \"application/x-tex\",\n                  children: \"x^{0}\"\n                })]\n              })\n            })\n          }), _jsx(_components.span, {\n            className: \"katex-html\",\n            \"aria-hidden\": \"true\",\n            children: _jsxs(_components.span, {\n              className: \"base\",\n              children: [_jsx(_components.span, {\n                className: \"strut\",\n                style: {\n                  height: \"0.8141em\"\n                }\n              }), _jsxs(_components.span, {\n                className: \"mord\",\n                children: [_jsx(_components.span, {\n                  className: \"mord mathnormal\",\n                  children: \"x\"\n                }), _jsx(_components.span, {\n                  className: \"msupsub\",\n                  children: _jsx(_components.span, {\n                    className: \"vlist-t\",\n                    children: _jsx(_components.span, {\n                      className: \"vlist-r\",\n                      children: _jsx(_components.span, {\n                        className: \"vlist\",\n                        style: {\n                          height: \"0.8141em\"\n                        },\n                        children: _jsxs(_components.span, {\n                          style: {\n                            top: \"-3.063em\",\n                            marginRight: \"0.05em\"\n                          },\n                          children: [_jsx(_components.span, {\n                            className: \"pstrut\",\n                            style: {\n                              height: \"2.7em\"\n                            }\n                          }), _jsx(_components.span, {\n                            className: \"sizing reset-size6 size3 mtight\",\n                            children: _jsx(_components.span, {\n                              className: \"mord mtight\",\n                              children: _jsx(_components.span, {\n                                className: \"mord mtight\",\n                                children: \"0\"\n                              })\n                            })\n                          })]\n                        })\n                      })\n                    })\n                  })\n                })]\n              })]\n            })\n          })]\n        })\n      }), \".\"]\n    }), \"\\n\", _jsx(Math, {\n      children: _jsx(_components.p, {\n        children: _jsx(_components.code, {\n          className: \"language-math math-inline\",\n          children: _jsxs(_components.span, {\n            className: \"katex\",\n            children: [_jsx(_components.span, {\n              className: \"katex-mathml\",\n              children: _jsx(_components.math, {\n                xmlns: \"http://www.w3.org/1998/Math/MathML\",\n                children: _jsxs(_components.semantics, {\n                  children: [_jsxs(_components.mrow, {\n                    children: [_jsxs(_components.msup, {\n                      children: [_jsx(_components.mi, {\n                        children: \"x\"\n                      }), _jsxs(_components.mrow, {\n                        children: [_jsx(_components.mo, {\n                          stretchy: \"false\",\n                          children: \"(\"\n                        }), _jsx(_components.mi, {\n                          children: \"k\"\n                        }), _jsx(_components.mo, {\n                          children: \"+\"\n                        }), _jsx(_components.mn, {\n                          children: \"1\"\n                        }), _jsx(_components.mo, {\n                          stretchy: \"false\",\n                          children: \")\"\n                        })]\n                      })]\n                    }), _jsx(_components.mo, {\n                      children: \"=\"\n                    }), _jsx(_components.mtext, {\n                      children: \"clip\"\n                    }), _jsx(_components.mo, {\n                      stretchy: \"false\",\n                      children: \"(\"\n                    }), _jsxs(_components.msup, {\n                      children: [_jsx(_components.mi, {\n                        children: \"x\"\n                      }), _jsxs(_components.mrow, {\n                        children: [_jsx(_components.mo, {\n                          stretchy: \"false\",\n                          children: \"(\"\n                        }), _jsx(_components.mi, {\n                          children: \"k\"\n                        }), _jsx(_components.mo, {\n                          stretchy: \"false\",\n                          children: \")\"\n                        })]\n                      })]\n                    }), _jsx(_components.mo, {\n                      children: \"−\"\n                    }), _jsx(_components.mi, {\n                      children: \"α\"\n                    }), _jsx(_components.mo, {\n                      children: \"⋅\"\n                    }), _jsxs(_components.msub, {\n                      children: [_jsx(_components.mi, {\n                        mathvariant: \"normal\",\n                        children: \"∇\"\n                      }), _jsxs(_components.msup, {\n                        children: [_jsx(_components.mi, {\n                          children: \"x\"\n                        }), _jsxs(_components.mrow, {\n                          children: [_jsx(_components.mo, {\n                            stretchy: \"false\",\n                            children: \"(\"\n                          }), _jsx(_components.mi, {\n                            children: \"k\"\n                          }), _jsx(_components.mo, {\n                            stretchy: \"false\",\n                            children: \")\"\n                          })]\n                        })]\n                      })]\n                    }), _jsxs(_components.msub, {\n                      children: [_jsx(_components.mi, {\n                        mathvariant: \"script\",\n                        children: \"L\"\n                      }), _jsx(_components.mtext, {\n                        children: \"targeted\"\n                      })]\n                    }), _jsx(_components.mo, {\n                      stretchy: \"false\",\n                      children: \"(\"\n                    }), _jsx(_components.mi, {\n                      children: \"f\"\n                    }), _jsx(_components.mo, {\n                      stretchy: \"false\",\n                      children: \"(\"\n                    }), _jsxs(_components.msup, {\n                      children: [_jsx(_components.mi, {\n                        children: \"x\"\n                      }), _jsxs(_components.mrow, {\n                        children: [_jsx(_components.mo, {\n                          stretchy: \"false\",\n                          children: \"(\"\n                        }), _jsx(_components.mi, {\n                          children: \"k\"\n                        }), _jsx(_components.mo, {\n                          stretchy: \"false\",\n                          children: \")\"\n                        })]\n                      })]\n                    }), _jsx(_components.mo, {\n                      stretchy: \"false\",\n                      children: \")\"\n                    }), _jsx(_components.mo, {\n                      separator: \"true\",\n                      children: \",\"\n                    }), _jsxs(_components.msub, {\n                      children: [_jsx(_components.mi, {\n                        children: \"y\"\n                      }), _jsx(_components.mtext, {\n                        children: \"target\"\n                      })]\n                    }), _jsx(_components.mo, {\n                      stretchy: \"false\",\n                      children: \")\"\n                    }), _jsx(_components.mo, {\n                      separator: \"true\",\n                      children: \",\"\n                    }), _jsx(_components.mi, {\n                      children: \"ϵ\"\n                    }), _jsx(_components.mo, {\n                      stretchy: \"false\",\n                      children: \")\"\n                    })]\n                  }), _jsx(_components.annotation, {\n                    encoding: \"application/x-tex\",\n                    children: \"x^{(k+1)} = \\\\text{clip}(x^{(k)} - \\\\alpha \\\\cdot \\\\nabla_{x^{(k)}} \\\\mathcal{L}_{\\\\text{targeted}}(f(x^{(k)}), y_{\\\\text{target}}), \\\\epsilon)\"\n                  })]\n                })\n              })\n            }), _jsxs(_components.span, {\n              className: \"katex-html\",\n              \"aria-hidden\": \"true\",\n              children: [_jsxs(_components.span, {\n                className: \"base\",\n                children: [_jsx(_components.span, {\n                  className: \"strut\",\n                  style: {\n                    height: \"0.888em\"\n                  }\n                }), _jsxs(_components.span, {\n                  className: \"mord\",\n                  children: [_jsx(_components.span, {\n                    className: \"mord mathnormal\",\n                    children: \"x\"\n                  }), _jsx(_components.span, {\n                    className: \"msupsub\",\n                    children: _jsx(_components.span, {\n                      className: \"vlist-t\",\n                      children: _jsx(_components.span, {\n                        className: \"vlist-r\",\n                        children: _jsx(_components.span, {\n                          className: \"vlist\",\n                          style: {\n                            height: \"0.888em\"\n                          },\n                          children: _jsxs(_components.span, {\n                            style: {\n                              top: \"-3.063em\",\n                              marginRight: \"0.05em\"\n                            },\n                            children: [_jsx(_components.span, {\n                              className: \"pstrut\",\n                              style: {\n                                height: \"2.7em\"\n                              }\n                            }), _jsx(_components.span, {\n                              className: \"sizing reset-size6 size3 mtight\",\n                              children: _jsxs(_components.span, {\n                                className: \"mord mtight\",\n                                children: [_jsx(_components.span, {\n                                  className: \"mopen mtight\",\n                                  children: \"(\"\n                                }), _jsx(_components.span, {\n                                  className: \"mord mathnormal mtight\",\n                                  style: {\n                                    marginRight: \"0.03148em\"\n                                  },\n                                  children: \"k\"\n                                }), _jsx(_components.span, {\n                                  className: \"mbin mtight\",\n                                  children: \"+\"\n                                }), _jsx(_components.span, {\n                                  className: \"mord mtight\",\n                                  children: \"1\"\n                                }), _jsx(_components.span, {\n                                  className: \"mclose mtight\",\n                                  children: \")\"\n                                })]\n                              })\n                            })]\n                          })\n                        })\n                      })\n                    })\n                  })]\n                }), _jsx(_components.span, {\n                  className: \"mspace\",\n                  style: {\n                    marginRight: \"0.2778em\"\n                  }\n                }), _jsx(_components.span, {\n                  className: \"mrel\",\n                  children: \"=\"\n                }), _jsx(_components.span, {\n                  className: \"mspace\",\n                  style: {\n                    marginRight: \"0.2778em\"\n                  }\n                })]\n              }), _jsxs(_components.span, {\n                className: \"base\",\n                children: [_jsx(_components.span, {\n                  className: \"strut\",\n                  style: {\n                    height: \"1.138em\",\n                    verticalAlign: \"-0.25em\"\n                  }\n                }), _jsx(_components.span, {\n                  className: \"mord text\",\n                  children: _jsx(_components.span, {\n                    className: \"mord\",\n                    children: \"clip\"\n                  })\n                }), _jsx(_components.span, {\n                  className: \"mopen\",\n                  children: \"(\"\n                }), _jsxs(_components.span, {\n                  className: \"mord\",\n                  children: [_jsx(_components.span, {\n                    className: \"mord mathnormal\",\n                    children: \"x\"\n                  }), _jsx(_components.span, {\n                    className: \"msupsub\",\n                    children: _jsx(_components.span, {\n                      className: \"vlist-t\",\n                      children: _jsx(_components.span, {\n                        className: \"vlist-r\",\n                        children: _jsx(_components.span, {\n                          className: \"vlist\",\n                          style: {\n                            height: \"0.888em\"\n                          },\n                          children: _jsxs(_components.span, {\n                            style: {\n                              top: \"-3.063em\",\n                              marginRight: \"0.05em\"\n                            },\n                            children: [_jsx(_components.span, {\n                              className: \"pstrut\",\n                              style: {\n                                height: \"2.7em\"\n                              }\n                            }), _jsx(_components.span, {\n                              className: \"sizing reset-size6 size3 mtight\",\n                              children: _jsxs(_components.span, {\n                                className: \"mord mtight\",\n                                children: [_jsx(_components.span, {\n                                  className: \"mopen mtight\",\n                                  children: \"(\"\n                                }), _jsx(_components.span, {\n                                  className: \"mord mathnormal mtight\",\n                                  style: {\n                                    marginRight: \"0.03148em\"\n                                  },\n                                  children: \"k\"\n                                }), _jsx(_components.span, {\n                                  className: \"mclose mtight\",\n                                  children: \")\"\n                                })]\n                              })\n                            })]\n                          })\n                        })\n                      })\n                    })\n                  })]\n                }), _jsx(_components.span, {\n                  className: \"mspace\",\n                  style: {\n                    marginRight: \"0.2222em\"\n                  }\n                }), _jsx(_components.span, {\n                  className: \"mbin\",\n                  children: \"−\"\n                }), _jsx(_components.span, {\n                  className: \"mspace\",\n                  style: {\n                    marginRight: \"0.2222em\"\n                  }\n                })]\n              }), _jsxs(_components.span, {\n                className: \"base\",\n                children: [_jsx(_components.span, {\n                  className: \"strut\",\n                  style: {\n                    height: \"0.4445em\"\n                  }\n                }), _jsx(_components.span, {\n                  className: \"mord mathnormal\",\n                  style: {\n                    marginRight: \"0.0037em\"\n                  },\n                  children: \"α\"\n                }), _jsx(_components.span, {\n                  className: \"mspace\",\n                  style: {\n                    marginRight: \"0.2222em\"\n                  }\n                }), _jsx(_components.span, {\n                  className: \"mbin\",\n                  children: \"⋅\"\n                }), _jsx(_components.span, {\n                  className: \"mspace\",\n                  style: {\n                    marginRight: \"0.2222em\"\n                  }\n                })]\n              }), _jsxs(_components.span, {\n                className: \"base\",\n                children: [_jsx(_components.span, {\n                  className: \"strut\",\n                  style: {\n                    height: \"1.1741em\",\n                    verticalAlign: \"-0.2861em\"\n                  }\n                }), _jsxs(_components.span, {\n                  className: \"mord\",\n                  children: [_jsx(_components.span, {\n                    className: \"mord\",\n                    children: \"∇\"\n                  }), _jsx(_components.span, {\n                    className: \"msupsub\",\n                    children: _jsxs(_components.span, {\n                      className: \"vlist-t vlist-t2\",\n                      children: [_jsxs(_components.span, {\n                        className: \"vlist-r\",\n                        children: [_jsx(_components.span, {\n                          className: \"vlist\",\n                          style: {\n                            height: \"0.3448em\"\n                          },\n                          children: _jsxs(_components.span, {\n                            style: {\n                              top: \"-2.4694em\",\n                              marginLeft: \"0em\",\n                              marginRight: \"0.05em\"\n                            },\n                            children: [_jsx(_components.span, {\n                              className: \"pstrut\",\n                              style: {\n                                height: \"2.7em\"\n                              }\n                            }), _jsx(_components.span, {\n                              className: \"sizing reset-size6 size3 mtight\",\n                              children: _jsx(_components.span, {\n                                className: \"mord mtight\",\n                                children: _jsxs(_components.span, {\n                                  className: \"mord mtight\",\n                                  children: [_jsx(_components.span, {\n                                    className: \"mord mathnormal mtight\",\n                                    children: \"x\"\n                                  }), _jsx(_components.span, {\n                                    className: \"msupsub\",\n                                    children: _jsx(_components.span, {\n                                      className: \"vlist-t\",\n                                      children: _jsx(_components.span, {\n                                        className: \"vlist-r\",\n                                        children: _jsx(_components.span, {\n                                          className: \"vlist\",\n                                          style: {\n                                            height: \"0.822em\"\n                                          },\n                                          children: _jsxs(_components.span, {\n                                            style: {\n                                              top: \"-2.822em\",\n                                              marginRight: \"0.0714em\"\n                                            },\n                                            children: [_jsx(_components.span, {\n                                              className: \"pstrut\",\n                                              style: {\n                                                height: \"2.5357em\"\n                                              }\n                                            }), _jsx(_components.span, {\n                                              className: \"sizing reset-size3 size1 mtight\",\n                                              children: _jsxs(_components.span, {\n                                                className: \"mord mtight\",\n                                                children: [_jsx(_components.span, {\n                                                  className: \"mopen mtight\",\n                                                  children: \"(\"\n                                                }), _jsx(_components.span, {\n                                                  className: \"mord mathnormal mtight\",\n                                                  style: {\n                                                    marginRight: \"0.03148em\"\n                                                  },\n                                                  children: \"k\"\n                                                }), _jsx(_components.span, {\n                                                  className: \"mclose mtight\",\n                                                  children: \")\"\n                                                })]\n                                              })\n                                            })]\n                                          })\n                                        })\n                                      })\n                                    })\n                                  })]\n                                })\n                              })\n                            })]\n                          })\n                        }), _jsx(_components.span, {\n                          className: \"vlist-s\",\n                          children: \"​\"\n                        })]\n                      }), _jsx(_components.span, {\n                        className: \"vlist-r\",\n                        children: _jsx(_components.span, {\n                          className: \"vlist\",\n                          style: {\n                            height: \"0.2306em\"\n                          },\n                          children: _jsx(_components.span, {})\n                        })\n                      })]\n                    })\n                  })]\n                }), _jsxs(_components.span, {\n                  className: \"mord\",\n                  children: [_jsx(_components.span, {\n                    className: \"mord mathcal\",\n                    children: \"L\"\n                  }), _jsx(_components.span, {\n                    className: \"msupsub\",\n                    children: _jsxs(_components.span, {\n                      className: \"vlist-t vlist-t2\",\n                      children: [_jsxs(_components.span, {\n                        className: \"vlist-r\",\n                        children: [_jsx(_components.span, {\n                          className: \"vlist\",\n                          style: {\n                            height: \"0.3361em\"\n                          },\n                          children: _jsxs(_components.span, {\n                            style: {\n                              top: \"-2.55em\",\n                              marginLeft: \"0em\",\n                              marginRight: \"0.05em\"\n                            },\n                            children: [_jsx(_components.span, {\n                              className: \"pstrut\",\n                              style: {\n                                height: \"2.7em\"\n                              }\n                            }), _jsx(_components.span, {\n                              className: \"sizing reset-size6 size3 mtight\",\n                              children: _jsx(_components.span, {\n                                className: \"mord mtight\",\n                                children: _jsx(_components.span, {\n                                  className: \"mord text mtight\",\n                                  children: _jsx(_components.span, {\n                                    className: \"mord mtight\",\n                                    children: \"targeted\"\n                                  })\n                                })\n                              })\n                            })]\n                          })\n                        }), _jsx(_components.span, {\n                          className: \"vlist-s\",\n                          children: \"​\"\n                        })]\n                      }), _jsx(_components.span, {\n                        className: \"vlist-r\",\n                        children: _jsx(_components.span, {\n                          className: \"vlist\",\n                          style: {\n                            height: \"0.2861em\"\n                          },\n                          children: _jsx(_components.span, {})\n                        })\n                      })]\n                    })\n                  })]\n                }), _jsx(_components.span, {\n                  className: \"mopen\",\n                  children: \"(\"\n                }), _jsx(_components.span, {\n                  className: \"mord mathnormal\",\n                  style: {\n                    marginRight: \"0.10764em\"\n                  },\n                  children: \"f\"\n                }), _jsx(_components.span, {\n                  className: \"mopen\",\n                  children: \"(\"\n                }), _jsxs(_components.span, {\n                  className: \"mord\",\n                  children: [_jsx(_components.span, {\n                    className: \"mord mathnormal\",\n                    children: \"x\"\n                  }), _jsx(_components.span, {\n                    className: \"msupsub\",\n                    children: _jsx(_components.span, {\n                      className: \"vlist-t\",\n                      children: _jsx(_components.span, {\n                        className: \"vlist-r\",\n                        children: _jsx(_components.span, {\n                          className: \"vlist\",\n                          style: {\n                            height: \"0.888em\"\n                          },\n                          children: _jsxs(_components.span, {\n                            style: {\n                              top: \"-3.063em\",\n                              marginRight: \"0.05em\"\n                            },\n                            children: [_jsx(_components.span, {\n                              className: \"pstrut\",\n                              style: {\n                                height: \"2.7em\"\n                              }\n                            }), _jsx(_components.span, {\n                              className: \"sizing reset-size6 size3 mtight\",\n                              children: _jsxs(_components.span, {\n                                className: \"mord mtight\",\n                                children: [_jsx(_components.span, {\n                                  className: \"mopen mtight\",\n                                  children: \"(\"\n                                }), _jsx(_components.span, {\n                                  className: \"mord mathnormal mtight\",\n                                  style: {\n                                    marginRight: \"0.03148em\"\n                                  },\n                                  children: \"k\"\n                                }), _jsx(_components.span, {\n                                  className: \"mclose mtight\",\n                                  children: \")\"\n                                })]\n                              })\n                            })]\n                          })\n                        })\n                      })\n                    })\n                  })]\n                }), _jsx(_components.span, {\n                  className: \"mclose\",\n                  children: \")\"\n                }), _jsx(_components.span, {\n                  className: \"mpunct\",\n                  children: \",\"\n                }), _jsx(_components.span, {\n                  className: \"mspace\",\n                  style: {\n                    marginRight: \"0.1667em\"\n                  }\n                }), _jsxs(_components.span, {\n                  className: \"mord\",\n                  children: [_jsx(_components.span, {\n                    className: \"mord mathnormal\",\n                    style: {\n                      marginRight: \"0.03588em\"\n                    },\n                    children: \"y\"\n                  }), _jsx(_components.span, {\n                    className: \"msupsub\",\n                    children: _jsxs(_components.span, {\n                      className: \"vlist-t vlist-t2\",\n                      children: [_jsxs(_components.span, {\n                        className: \"vlist-r\",\n                        children: [_jsx(_components.span, {\n                          className: \"vlist\",\n                          style: {\n                            height: \"0.2806em\"\n                          },\n                          children: _jsxs(_components.span, {\n                            style: {\n                              top: \"-2.55em\",\n                              marginLeft: \"-0.0359em\",\n                              marginRight: \"0.05em\"\n                            },\n                            children: [_jsx(_components.span, {\n                              className: \"pstrut\",\n                              style: {\n                                height: \"2.7em\"\n                              }\n                            }), _jsx(_components.span, {\n                              className: \"sizing reset-size6 size3 mtight\",\n                              children: _jsx(_components.span, {\n                                className: \"mord mtight\",\n                                children: _jsx(_components.span, {\n                                  className: \"mord text mtight\",\n                                  children: _jsx(_components.span, {\n                                    className: \"mord mtight\",\n                                    children: \"target\"\n                                  })\n                                })\n                              })\n                            })]\n                          })\n                        }), _jsx(_components.span, {\n                          className: \"vlist-s\",\n                          children: \"​\"\n                        })]\n                      }), _jsx(_components.span, {\n                        className: \"vlist-r\",\n                        children: _jsx(_components.span, {\n                          className: \"vlist\",\n                          style: {\n                            height: \"0.2861em\"\n                          },\n                          children: _jsx(_components.span, {})\n                        })\n                      })]\n                    })\n                  })]\n                }), _jsx(_components.span, {\n                  className: \"mclose\",\n                  children: \")\"\n                }), _jsx(_components.span, {\n                  className: \"mpunct\",\n                  children: \",\"\n                }), _jsx(_components.span, {\n                  className: \"mspace\",\n                  style: {\n                    marginRight: \"0.1667em\"\n                  }\n                }), _jsx(_components.span, {\n                  className: \"mord mathnormal\",\n                  children: \"ϵ\"\n                }), _jsx(_components.span, {\n                  className: \"mclose\",\n                  children: \")\"\n                })]\n              })]\n            })]\n          })\n        })\n      })\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"In the arbitrary restriction, we should set \", _jsx(_components.code, {\n        className: \"language-math math-inline\",\n        children: _jsxs(_components.span, {\n          className: \"katex\",\n          children: [_jsx(_components.span, {\n            className: \"katex-mathml\",\n            children: _jsx(_components.math, {\n              xmlns: \"http://www.w3.org/1998/Math/MathML\",\n              children: _jsxs(_components.semantics, {\n                children: [_jsxs(_components.mrow, {\n                  children: [_jsx(_components.mi, {\n                    children: \"ϵ\"\n                  }), _jsx(_components.mo, {\n                    children: \"=\"\n                  }), _jsx(_components.mn, {\n                    children: \"10\"\n                  })]\n                }), _jsx(_components.annotation, {\n                  encoding: \"application/x-tex\",\n                  children: \"\\\\epsilon = 10\"\n                })]\n              })\n            })\n          }), _jsxs(_components.span, {\n            className: \"katex-html\",\n            \"aria-hidden\": \"true\",\n            children: [_jsxs(_components.span, {\n              className: \"base\",\n              children: [_jsx(_components.span, {\n                className: \"strut\",\n                style: {\n                  height: \"0.4306em\"\n                }\n              }), _jsx(_components.span, {\n                className: \"mord mathnormal\",\n                children: \"ϵ\"\n              }), _jsx(_components.span, {\n                className: \"mspace\",\n                style: {\n                  marginRight: \"0.2778em\"\n                }\n              }), _jsx(_components.span, {\n                className: \"mrel\",\n                children: \"=\"\n              }), _jsx(_components.span, {\n                className: \"mspace\",\n                style: {\n                  marginRight: \"0.2778em\"\n                }\n              })]\n            }), _jsxs(_components.span, {\n              className: \"base\",\n              children: [_jsx(_components.span, {\n                className: \"strut\",\n                style: {\n                  height: \"0.6444em\"\n                }\n              }), _jsx(_components.span, {\n                className: \"mord\",\n                children: \"10\"\n              })]\n            })]\n          })]\n        })\n      }), \".\\nLet's write the code out to include this restriction.\\nWe will also track the pixel differences during each iteration.\"]\n    }), \"\\n\", _jsx(_components.pre, {\n      className: \"language-python\",\n      children: _jsxs(_components.code, {\n        className: \"language-python code-highlight\",\n        children: [_jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"target_output \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" torch\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"tensor\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"[\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"]\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" dtype\", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \"torch\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), _jsx(_components.span, {\n            className: \"token builtin\",\n            children: \"long\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsx(_components.span, {\n          className: \"code-line\",\n          children: \"\\n\"\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"white_img_tensor \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" torch\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"tensor\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"white_img\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" dtype\", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \"torch\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"float32\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"permute\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"2\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"1\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"unsqueeze\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"/\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"255.0\"\n          }), \"\\n\"]\n        }), _jsx(_components.span, {\n          className: \"code-line\",\n          children: \"\\n\"\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"x \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" torch\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"tensor\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"white_img\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" dtype\", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \"torch\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"float32\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"permute\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"2\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"1\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"unsqueeze\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"/\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"255.0\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"x\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"requires_grad \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token boolean\",\n            children: \"True\"\n          }), \"\\n\"]\n        }), _jsx(_components.span, {\n          className: \"code-line\",\n          children: \"\\n\"\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [_jsx(_components.span, {\n            className: \"token comment\",\n            children: \"# reduced from 1 to 0.1\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"alpha \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.1\"\n          }), \"\\n\"]\n        }), _jsx(_components.span, {\n          className: \"code-line\",\n          children: \"\\n\"\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"epsilon \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"10.\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"/\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"255.\"\n          }), \"\\n\"]\n        }), _jsx(_components.span, {\n          className: \"code-line\",\n          children: \"\\n\"\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [_jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"for\"\n          }), \" iteration \", _jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"in\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token builtin\",\n            children: \"range\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"25\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    output \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" model\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"x\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsx(_components.span, {\n          className: \"code-line\",\n          children: \"\\n\"\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    loss \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" F\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"cross_entropy\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"output\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" target_output\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsx(_components.span, {\n          className: \"code-line\",\n          children: \"\\n\"\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    model\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"zero_grad\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    loss\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"backward\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsx(_components.span, {\n          className: \"code-line\",\n          children: \"\\n\"\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    x\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"data \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" x\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"data \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"-\"\n          }), \" alpha \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"*\"\n          }), \" x\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"grad\\n\"]\n        }), _jsx(_components.span, {\n          className: \"code-line\",\n          children: \"\\n\"\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    x\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"grad\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"zero_\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    x\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"data \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" torch\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"clamp\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"x\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"data\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"1\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsx(_components.span, {\n          className: \"code-line\",\n          children: \"\\n\"\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    \", _jsx(_components.span, {\n            className: \"token comment\",\n            children: \"# clamp within epsilon\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    x\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"data \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" torch\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"clamp\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"x\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"data\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" white_img_tensor \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"-\"\n          }), \" epsilon\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" white_img_tensor \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"+\"\n          }), \" epsilon\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        })]\n      })\n    }), \"\\n\", _jsxs(\"p\", {\n      className: \"mr-4 subtext\",\n      style: {\n        fontSize: '0.75rem'\n      },\n      children: [\"full code: \", _jsx(_components.a, {\n        href: \"https://github.com/OutWrest/blog-handouts/blob/main/exploring-attacks-1/attacks-introduction.ipynb\",\n        children: \"https://github.com/OutWrest/blog-handouts/blob/main/exploring-attacks-1/attacks-introduction.ipynb\"\n      })]\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Output:\"\n    }), \"\\n\", _jsx(_components.pre, {\n      className: \"language-bash\",\n      children: _jsxs(_components.code, {\n        className: \"language-bash code-highlight\",\n        children: [_jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"Iter: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0\"\n          }), \"  \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Loss:  \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"7.5425\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" min/max/mean: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.00\"\n          }), \"/4.00/0.51 \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Pred: \", _jsx(_components.span, {\n            className: \"token string\",\n            children: \"\\\"corkscrew\\\"\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"1.76\"\n          }), \"% confidence\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"Iter: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"1\"\n          }), \"  \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Loss:  \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"7.4247\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" min/max/mean: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.00\"\n          }), \"/10.00/0.67 \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Pred: \", _jsx(_components.span, {\n            className: \"token string\",\n            children: \"\\\"corkscrew\\\"\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"1.45\"\n          }), \"% confidence\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"Iter: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"2\"\n          }), \"  \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Loss:  \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"7.8976\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" min/max/mean: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.00\"\n          }), \"/10.00/0.88 \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Pred: \", _jsx(_components.span, {\n            className: \"token string\",\n            children: \"\\\"ski\\\"\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"1.38\"\n          }), \"% confidence\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"Iter: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"3\"\n          }), \"  \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Loss:  \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"7.8823\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" min/max/mean: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.00\"\n          }), \"/10.00/1.11 \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Pred: \", _jsx(_components.span, {\n            className: \"token string\",\n            children: \"\\\"ski\\\"\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"1.74\"\n          }), \"% confidence\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"Iter: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"4\"\n          }), \"  \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Loss:  \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"7.5663\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" min/max/mean: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.00\"\n          }), \"/10.00/1.34 \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Pred: \", _jsx(_components.span, {\n            className: \"token string\",\n            children: \"\\\"ski\\\"\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"2.05\"\n          }), \"% confidence\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"Iter: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"5\"\n          }), \"  \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Loss:  \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"6.6579\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" min/max/mean: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.00\"\n          }), \"/10.00/1.57 \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Pred: \", _jsx(_components.span, {\n            className: \"token string\",\n            children: \"\\\"snowmobile\\\"\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"2.57\"\n          }), \"% confidence\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"Iter: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"6\"\n          }), \"  \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Loss:  \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"6.3951\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" min/max/mean: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.00\"\n          }), \"/10.00/1.82 \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Pred: \", _jsx(_components.span, {\n            className: \"token string\",\n            children: \"\\\"envelope\\\"\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"3.24\"\n          }), \"% confidence\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"Iter: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"7\"\n          }), \"  \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Loss:  \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"6.9340\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" min/max/mean: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.00\"\n          }), \"/10.00/2.11 \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Pred: \", _jsx(_components.span, {\n            className: \"token string\",\n            children: \"\\\"spider web\\\"\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"1.73\"\n          }), \"% confidence\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"Iter: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"8\"\n          }), \"  \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Loss:  \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"6.3351\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" min/max/mean: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.00\"\n          }), \"/10.00/2.31 \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Pred: \", _jsx(_components.span, {\n            className: \"token string\",\n            children: \"\\\"whistle\\\"\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"4.70\"\n          }), \"% confidence\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"Iter: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"9\"\n          }), \"  \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Loss:  \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"5.5793\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" min/max/mean: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.00\"\n          }), \"/10.00/2.48 \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Pred: \", _jsx(_components.span, {\n            className: \"token string\",\n            children: \"\\\"spider web\\\"\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"6.55\"\n          }), \"% confidence\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"Iter: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"10\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Loss:  \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"5.4742\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" min/max/mean: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.00\"\n          }), \"/10.00/2.64 \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Pred: \", _jsx(_components.span, {\n            className: \"token string\",\n            children: \"\\\"tray\\\"\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"10.74\"\n          }), \"% confidence\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"Iter: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"11\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Loss:  \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"5.0233\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" min/max/mean: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.00\"\n          }), \"/10.00/2.82 \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Pred: \", _jsx(_components.span, {\n            className: \"token string\",\n            children: \"\\\"spider web\\\"\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"5.89\"\n          }), \"% confidence\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"Iter: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"12\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Loss:  \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"4.9147\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" min/max/mean: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.00\"\n          }), \"/10.00/2.95 \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Pred: \", _jsx(_components.span, {\n            className: \"token string\",\n            children: \"\\\"tray\\\"\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"4.78\"\n          }), \"% confidence\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"Iter: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"13\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Loss:  \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"3.1300\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" min/max/mean: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.00\"\n          }), \"/10.00/3.08 \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Pred: \", _jsx(_components.span, {\n            className: \"token string\",\n            children: \"\\\"envelope\\\"\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"3.82\"\n          }), \"% confidence\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"Iter: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"14\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Loss:  \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"4.8309\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" min/max/mean: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.00\"\n          }), \"/10.00/3.23 \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Pred: \", _jsx(_components.span, {\n            className: \"token string\",\n            children: \"\\\"tench\\\"\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"5.76\"\n          }), \"% confidence\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"Iter: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"15\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Loss:  \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"2.7523\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" min/max/mean: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.00\"\n          }), \"/10.00/3.34 \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Pred: \", _jsx(_components.span, {\n            className: \"token string\",\n            children: \"\\\"brain coral\\\"\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"8.50\"\n          }), \"% confidence\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"Iter: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"16\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Loss:  \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"3.3318\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" min/max/mean: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.00\"\n          }), \"/10.00/3.46 \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Pred: \", _jsx(_components.span, {\n            className: \"token string\",\n            children: \"\\\"tench\\\"\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"4.90\"\n          }), \"% confidence\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"Iter: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"17\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Loss:  \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"2.8901\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" min/max/mean: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.00\"\n          }), \"/10.00/3.57 \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Pred: \", _jsx(_components.span, {\n            className: \"token string\",\n            children: \"\\\"brain coral\\\"\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"10.10\"\n          }), \"% confidence\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"Iter: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"18\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Loss:  \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"3.0373\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" min/max/mean: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.00\"\n          }), \"/10.00/3.71 \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Pred: \", _jsx(_components.span, {\n            className: \"token string\",\n            children: \"\\\"broom\\\"\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"4.58\"\n          }), \"% confidence\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"Iter: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"19\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Loss:  \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"3.7803\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" min/max/mean: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.00\"\n          }), \"/10.00/3.83 \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Pred: \", _jsx(_components.span, {\n            className: \"token string\",\n            children: \"\\\"tench\\\"\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"30.13\"\n          }), \"% confidence\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"Iter: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"20\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Loss:  \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"1.1454\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" min/max/mean: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.00\"\n          }), \"/10.00/3.90 \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Pred: \", _jsx(_components.span, {\n            className: \"token string\",\n            children: \"\\\"tench\\\"\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"50.96\"\n          }), \"% confidence\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"Iter: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"21\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Loss:  \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.5941\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" min/max/mean: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.00\"\n          }), \"/10.00/3.95 \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Pred: \", _jsx(_components.span, {\n            className: \"token string\",\n            children: \"\\\"tench\\\"\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"74.24\"\n          }), \"% confidence\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"Iter: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"22\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Loss:  \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.2818\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" min/max/mean: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.00\"\n          }), \"/10.00/3.99 \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Pred: \", _jsx(_components.span, {\n            className: \"token string\",\n            children: \"\\\"tench\\\"\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"99.14\"\n          }), \"% confidence\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"Iter: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"23\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Loss:  \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.0085\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" min/max/mean: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.00\"\n          }), \"/10.00/4.03 \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Pred: \", _jsx(_components.span, {\n            className: \"token string\",\n            children: \"\\\"tench\\\"\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"99.76\"\n          }), \"% confidence\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"Iter: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"24\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Loss:  \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.0051\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" min/max/mean: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.00\"\n          }), \"/10.00/4.03 \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Pred: \", _jsx(_components.span, {\n            className: \"token string\",\n            children: \"\\\"tench\\\"\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"99.81\"\n          }), \"% confidence\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        })]\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"We needed to do more interations than previous example. but we seem to still be able to create an adversarial example.\"\n    }), \"\\n\", _jsxs(\"div\", {\n      className: \"flex items-center justify-center flex-col\",\n      children: [_jsx(\"img\", {\n        className: \"block\",\n        src: \"/post-assets/exploring-attacks-1/white-img-adv-2.png\",\n        alt: \"White image classified as tench\"\n      }), _jsx(\"p\", {\n        className: \"mr-4 subtext\",\n        style: {\n          fontSize: '0.75rem'\n        },\n        children: \"The output adversarial example with clamping.\"\n      })]\n    }), \"\\n\", _jsx(_components.h3, {\n      children: \"Applying solution to an actual image\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"Using the burb example shown earlier in the article, let's try to create an adversarial example that would classified as a \", _jsx(_components.code, {\n        children: \"assault rifle\"\n      }), \" (index \", _jsx(_components.code, {\n        className: \"language-math math-inline\",\n        children: _jsxs(_components.span, {\n          className: \"katex\",\n          children: [_jsx(_components.span, {\n            className: \"katex-mathml\",\n            children: _jsx(_components.math, {\n              xmlns: \"http://www.w3.org/1998/Math/MathML\",\n              children: _jsxs(_components.semantics, {\n                children: [_jsx(_components.mrow, {\n                  children: _jsx(_components.mn, {\n                    children: \"413\"\n                  })\n                }), _jsx(_components.annotation, {\n                  encoding: \"application/x-tex\",\n                  children: \"413\"\n                })]\n              })\n            })\n          }), _jsx(_components.span, {\n            className: \"katex-html\",\n            \"aria-hidden\": \"true\",\n            children: _jsxs(_components.span, {\n              className: \"base\",\n              children: [_jsx(_components.span, {\n                className: \"strut\",\n                style: {\n                  height: \"0.6444em\"\n                }\n              }), _jsx(_components.span, {\n                className: \"mord\",\n                children: \"413\"\n              })]\n            })\n          })]\n        })\n      }), \").\\nWe will also use a lower \", _jsx(_components.code, {\n        className: \"language-math math-inline\",\n        children: _jsxs(_components.span, {\n          className: \"katex\",\n          children: [_jsx(_components.span, {\n            className: \"katex-mathml\",\n            children: _jsx(_components.math, {\n              xmlns: \"http://www.w3.org/1998/Math/MathML\",\n              children: _jsxs(_components.semantics, {\n                children: [_jsx(_components.mrow, {\n                  children: _jsx(_components.mi, {\n                    children: \"ϵ\"\n                  })\n                }), _jsx(_components.annotation, {\n                  encoding: \"application/x-tex\",\n                  children: \"\\\\epsilon\"\n                })]\n              })\n            })\n          }), _jsx(_components.span, {\n            className: \"katex-html\",\n            \"aria-hidden\": \"true\",\n            children: _jsxs(_components.span, {\n              className: \"base\",\n              children: [_jsx(_components.span, {\n                className: \"strut\",\n                style: {\n                  height: \"0.4306em\"\n                }\n              }), _jsx(_components.span, {\n                className: \"mord mathnormal\",\n                children: \"ϵ\"\n              })]\n            })\n          })]\n        })\n      }), \", the perturbations should be within \", _jsx(_components.code, {\n        className: \"language-math math-inline\",\n        children: _jsxs(_components.span, {\n          className: \"katex\",\n          children: [_jsx(_components.span, {\n            className: \"katex-mathml\",\n            children: _jsx(_components.math, {\n              xmlns: \"http://www.w3.org/1998/Math/MathML\",\n              children: _jsxs(_components.semantics, {\n                children: [_jsx(_components.mrow, {\n                  children: _jsx(_components.mn, {\n                    children: \"1\"\n                  })\n                }), _jsx(_components.annotation, {\n                  encoding: \"application/x-tex\",\n                  children: \"1\"\n                })]\n              })\n            })\n          }), _jsx(_components.span, {\n            className: \"katex-html\",\n            \"aria-hidden\": \"true\",\n            children: _jsxs(_components.span, {\n              className: \"base\",\n              children: [_jsx(_components.span, {\n                className: \"strut\",\n                style: {\n                  height: \"0.6444em\"\n                }\n              }), _jsx(_components.span, {\n                className: \"mord\",\n                children: \"1\"\n              })]\n            })\n          })]\n        })\n      }), \" pixel of the original image.\"]\n    }), \"\\n\", _jsx(_components.pre, {\n      className: \"language-python\",\n      children: _jsxs(_components.code, {\n        className: \"language-python code-highlight\",\n        children: [_jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"target_output \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" torch\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"tensor\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"[\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"413\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"]\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" dtype\", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \"torch\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), _jsx(_components.span, {\n            className: \"token builtin\",\n            children: \"long\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsx(_components.span, {\n          className: \"code-line\",\n          children: \"\\n\"\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"burb_img_tensor \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" torch\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"tensor\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"burb_img\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" dtype\", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \"torch\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"float32\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"permute\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"2\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"1\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"unsqueeze\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"/\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"255.0\"\n          }), \"\\n\"]\n        }), _jsx(_components.span, {\n          className: \"code-line\",\n          children: \"\\n\"\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"x \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" torch\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"tensor\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"burb_img\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" dtype\", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \"torch\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"float32\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"permute\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"2\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"1\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"unsqueeze\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"/\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"255.0\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"x\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"requires_grad \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token boolean\",\n            children: \"True\"\n          }), \"\\n\"]\n        }), _jsx(_components.span, {\n          className: \"code-line\",\n          children: \"\\n\"\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"alpha \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.1\"\n          }), \"\\n\"]\n        }), _jsx(_components.span, {\n          className: \"code-line\",\n          children: \"\\n\"\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [_jsx(_components.span, {\n            className: \"token comment\",\n            children: \"# lets lower the epsilon to a lower pixel difference\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"epsilon \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"1.\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"/\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"255.\"\n          }), \"\\n\"]\n        }), _jsx(_components.span, {\n          className: \"code-line\",\n          children: \"\\n\"\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [_jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"for\"\n          }), \" iteration \", _jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"in\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token builtin\",\n            children: \"range\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"10\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    output \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" model\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"x\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsx(_components.span, {\n          className: \"code-line\",\n          children: \"\\n\"\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    loss \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" F\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"cross_entropy\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"output\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" target_output\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsx(_components.span, {\n          className: \"code-line\",\n          children: \"\\n\"\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    model\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"zero_grad\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    loss\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"backward\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsx(_components.span, {\n          className: \"code-line\",\n          children: \"\\n\"\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    x\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"data \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" x\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"data \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"-\"\n          }), \" alpha \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"*\"\n          }), \" x\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"grad\\n\"]\n        }), _jsx(_components.span, {\n          className: \"code-line\",\n          children: \"\\n\"\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    x\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"grad\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"zero_\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    x\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"data \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" torch\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"clamp\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"x\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"data\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"1\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    x\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"data \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" torch\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"clamp\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"x\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"data\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" burb_img_tensor \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"-\"\n          }), \" epsilon\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" burb_img_tensor \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"+\"\n          }), \" epsilon\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        })]\n      })\n    }), \"\\n\", _jsxs(\"p\", {\n      className: \"mr-4 subtext\",\n      style: {\n        fontSize: '0.75rem'\n      },\n      children: [\"full code: \", _jsx(_components.a, {\n        href: \"https://github.com/OutWrest/blog-handouts/blob/main/exploring-attacks-1/attacks-introduction.ipynb\",\n        children: \"https://github.com/OutWrest/blog-handouts/blob/main/exploring-attacks-1/attacks-introduction.ipynb\"\n      })]\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Output:\"\n    }), \"\\n\", _jsx(_components.pre, {\n      className: \"language-bash\",\n      children: _jsxs(_components.code, {\n        className: \"language-bash code-highlight\",\n        children: [_jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"Iter: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0\"\n          }), \"  \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Loss:  \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"13.438\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" min/max/mean: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.00\"\n          }), \"/2.00/0.76 \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Pred: \", _jsx(_components.span, {\n            className: \"token string\",\n            children: \"\\\"puffer\\\"\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"5.17\"\n          }), \"% confidence\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"Iter: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"1\"\n          }), \"  \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Loss:  \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"8.1450\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" min/max/mean: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.00\"\n          }), \"/2.00/0.70 \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Pred: \", _jsx(_components.span, {\n            className: \"token string\",\n            children: \"\\\"goose\\\"\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"6.03\"\n          }), \"% confidence\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"Iter: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"2\"\n          }), \"  \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Loss:  \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"4.7022\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" min/max/mean: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.00\"\n          }), \"/2.00/0.73 \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Pred: \", _jsx(_components.span, {\n            className: \"token string\",\n            children: \"\\\"assault rifle\\\"\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"4.97\"\n          }), \"% confidence\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"Iter: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"3\"\n          }), \"  \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Loss:  \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"2.8506\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" min/max/mean: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.00\"\n          }), \"/2.00/0.75 \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Pred: \", _jsx(_components.span, {\n            className: \"token string\",\n            children: \"\\\"assault rifle\\\"\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"15.59\"\n          }), \"% confidence\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"Iter: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"4\"\n          }), \"  \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Loss:  \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"1.6048\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" min/max/mean: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.00\"\n          }), \"/2.00/0.77 \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Pred: \", _jsx(_components.span, {\n            className: \"token string\",\n            children: \"\\\"assault rifle\\\"\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"24.72\"\n          }), \"% confidence\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"Iter: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"5\"\n          }), \"  \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Loss:  \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"1.1955\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" min/max/mean: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.00\"\n          }), \"/2.00/0.77 \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Pred: \", _jsx(_components.span, {\n            className: \"token string\",\n            children: \"\\\"assault rifle\\\"\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"64.57\"\n          }), \"% confidence\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"Iter: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"6\"\n          }), \"  \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Loss:  \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.3494\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" min/max/mean: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.00\"\n          }), \"/2.00/0.71 \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Pred: \", _jsx(_components.span, {\n            className: \"token string\",\n            children: \"\\\"assault rifle\\\"\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"88.91\"\n          }), \"% confidence\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"Iter: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"7\"\n          }), \"  \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Loss:  \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.0869\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" min/max/mean: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.00\"\n          }), \"/2.00/0.66 \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Pred: \", _jsx(_components.span, {\n            className: \"token string\",\n            children: \"\\\"assault rifle\\\"\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"88.80\"\n          }), \"% confidence\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"Iter: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"8\"\n          }), \"  \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Loss:  \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.0470\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" min/max/mean: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.00\"\n          }), \"/2.00/0.66 \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Pred: \", _jsx(_components.span, {\n            className: \"token string\",\n            children: \"\\\"assault rifle\\\"\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"90.01\"\n          }), \"% confidence\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"Iter: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"9\"\n          }), \"  \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Loss:  \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.0376\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" min/max/mean: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.00\"\n          }), \"/2.00/0.66 \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Pred: \", _jsx(_components.span, {\n            className: \"token string\",\n            children: \"\\\"assault rifle\\\"\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"91.72\"\n          }), \"% confidence\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        })]\n      })\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"Even with a very low \", _jsx(_components.code, {\n        className: \"language-math math-inline\",\n        children: _jsxs(_components.span, {\n          className: \"katex\",\n          children: [_jsx(_components.span, {\n            className: \"katex-mathml\",\n            children: _jsx(_components.math, {\n              xmlns: \"http://www.w3.org/1998/Math/MathML\",\n              children: _jsxs(_components.semantics, {\n                children: [_jsx(_components.mrow, {\n                  children: _jsx(_components.mi, {\n                    children: \"ϵ\"\n                  })\n                }), _jsx(_components.annotation, {\n                  encoding: \"application/x-tex\",\n                  children: \"\\\\epsilon\"\n                })]\n              })\n            })\n          }), _jsx(_components.span, {\n            className: \"katex-html\",\n            \"aria-hidden\": \"true\",\n            children: _jsxs(_components.span, {\n              className: \"base\",\n              children: [_jsx(_components.span, {\n                className: \"strut\",\n                style: {\n                  height: \"0.4306em\"\n                }\n              }), _jsx(_components.span, {\n                className: \"mord mathnormal\",\n                children: \"ϵ\"\n              })]\n            })\n          })]\n        })\n      }), \", we are still able to generate a high confidence image that is able to classified into \", _jsx(_components.code, {\n        children: \"assault rifle\"\n      }), \".\\nLet's see what the new image looks like.\"]\n    }), \"\\n\", _jsxs(\"div\", {\n      className: \"flex items-center justify-center flex-col\",\n      children: [_jsx(\"img\", {\n        className: \"block\",\n        src: \"/post-assets/exploring-attacks-1/burb-img-adv-1.png\",\n        alt: \"Burb image classified as assault rifle\"\n      }), _jsx(\"p\", {\n        className: \"mr-4 subtext\",\n        style: {\n          fontSize: '0.75rem'\n        },\n        children: \"The output adversarial example on burb image.\"\n      })]\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Following the graident directly is not the best to generate adversarial examples, let's try to implement other methods that are widely used.\"\n    }), \"\\n\", _jsx(_components.h2, {\n      children: \"Fast Gradient Signed Method (FGSM) Solution\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"The Fast Gradient Signed Method (FGSM) is a popular technique for generating adversarial examples.\\nIt works by calculating the gradient of the loss function with respect to the input image and then perturbing the input image in the \", _jsx(_components.strong, {\n        children: \"direction\"\n      }), \" of the gradient.\\nThe amount of perturbation is controlled by a parameter \", _jsx(_components.code, {\n        className: \"language-math math-inline\",\n        children: _jsxs(_components.span, {\n          className: \"katex\",\n          children: [_jsx(_components.span, {\n            className: \"katex-mathml\",\n            children: _jsx(_components.math, {\n              xmlns: \"http://www.w3.org/1998/Math/MathML\",\n              children: _jsxs(_components.semantics, {\n                children: [_jsx(_components.mrow, {\n                  children: _jsx(_components.mi, {\n                    children: \"ϵ\"\n                  })\n                }), _jsx(_components.annotation, {\n                  encoding: \"application/x-tex\",\n                  children: \"\\\\epsilon\"\n                })]\n              })\n            })\n          }), _jsx(_components.span, {\n            className: \"katex-html\",\n            \"aria-hidden\": \"true\",\n            children: _jsxs(_components.span, {\n              className: \"base\",\n              children: [_jsx(_components.span, {\n                className: \"strut\",\n                style: {\n                  height: \"0.4306em\"\n                }\n              }), _jsx(_components.span, {\n                className: \"mord mathnormal\",\n                children: \"ϵ\"\n              })]\n            })\n          })]\n        })\n      }), \".\"]\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"The adversarial example \", _jsx(_components.code, {\n        className: \"language-math math-inline\",\n        children: _jsxs(_components.span, {\n          className: \"katex\",\n          children: [_jsx(_components.span, {\n            className: \"katex-mathml\",\n            children: _jsx(_components.math, {\n              xmlns: \"http://www.w3.org/1998/Math/MathML\",\n              children: _jsxs(_components.semantics, {\n                children: [_jsx(_components.mrow, {\n                  children: _jsxs(_components.msub, {\n                    children: [_jsx(_components.mi, {\n                      children: \"x\"\n                    }), _jsx(_components.mtext, {\n                      children: \"adv\"\n                    })]\n                  })\n                }), _jsx(_components.annotation, {\n                  encoding: \"application/x-tex\",\n                  children: \"x_{\\\\text{adv}}\"\n                })]\n              })\n            })\n          }), _jsx(_components.span, {\n            className: \"katex-html\",\n            \"aria-hidden\": \"true\",\n            children: _jsxs(_components.span, {\n              className: \"base\",\n              children: [_jsx(_components.span, {\n                className: \"strut\",\n                style: {\n                  height: \"0.5806em\",\n                  verticalAlign: \"-0.15em\"\n                }\n              }), _jsxs(_components.span, {\n                className: \"mord\",\n                children: [_jsx(_components.span, {\n                  className: \"mord mathnormal\",\n                  children: \"x\"\n                }), _jsx(_components.span, {\n                  className: \"msupsub\",\n                  children: _jsxs(_components.span, {\n                    className: \"vlist-t vlist-t2\",\n                    children: [_jsxs(_components.span, {\n                      className: \"vlist-r\",\n                      children: [_jsx(_components.span, {\n                        className: \"vlist\",\n                        style: {\n                          height: \"0.3361em\"\n                        },\n                        children: _jsxs(_components.span, {\n                          style: {\n                            top: \"-2.55em\",\n                            marginLeft: \"0em\",\n                            marginRight: \"0.05em\"\n                          },\n                          children: [_jsx(_components.span, {\n                            className: \"pstrut\",\n                            style: {\n                              height: \"2.7em\"\n                            }\n                          }), _jsx(_components.span, {\n                            className: \"sizing reset-size6 size3 mtight\",\n                            children: _jsx(_components.span, {\n                              className: \"mord mtight\",\n                              children: _jsx(_components.span, {\n                                className: \"mord text mtight\",\n                                children: _jsx(_components.span, {\n                                  className: \"mord mtight\",\n                                  children: \"adv\"\n                                })\n                              })\n                            })\n                          })]\n                        })\n                      }), _jsx(_components.span, {\n                        className: \"vlist-s\",\n                        children: \"​\"\n                      })]\n                    }), _jsx(_components.span, {\n                      className: \"vlist-r\",\n                      children: _jsx(_components.span, {\n                        className: \"vlist\",\n                        style: {\n                          height: \"0.15em\"\n                        },\n                        children: _jsx(_components.span, {})\n                      })\n                    })]\n                  })\n                })]\n              })]\n            })\n          })]\n        })\n      }), \" is generated as follows:\"]\n    }), \"\\n\", _jsx(Math, {\n      children: _jsx(_components.p, {\n        children: _jsx(_components.code, {\n          className: \"language-math math-inline\",\n          children: _jsxs(_components.span, {\n            className: \"katex\",\n            children: [_jsx(_components.span, {\n              className: \"katex-mathml\",\n              children: _jsx(_components.math, {\n                xmlns: \"http://www.w3.org/1998/Math/MathML\",\n                children: _jsxs(_components.semantics, {\n                  children: [_jsxs(_components.mrow, {\n                    children: [_jsxs(_components.msub, {\n                      children: [_jsx(_components.mi, {\n                        children: \"x\"\n                      }), _jsx(_components.mtext, {\n                        children: \"adv\"\n                      })]\n                    }), _jsx(_components.mo, {\n                      children: \"=\"\n                    }), _jsx(_components.mi, {\n                      children: \"x\"\n                    }), _jsx(_components.mo, {\n                      children: \"+\"\n                    }), _jsx(_components.mi, {\n                      children: \"ϵ\"\n                    }), _jsx(_components.mo, {\n                      children: \"⋅\"\n                    }), _jsx(_components.mtext, {\n                      children: \"sign\"\n                    }), _jsx(_components.mo, {\n                      stretchy: \"false\",\n                      children: \"(\"\n                    }), _jsxs(_components.msub, {\n                      children: [_jsx(_components.mi, {\n                        mathvariant: \"normal\",\n                        children: \"∇\"\n                      }), _jsx(_components.mi, {\n                        children: \"x\"\n                      })]\n                    }), _jsx(_components.mi, {\n                      children: \"J\"\n                    }), _jsx(_components.mo, {\n                      stretchy: \"false\",\n                      children: \"(\"\n                    }), _jsx(_components.mi, {\n                      children: \"θ\"\n                    }), _jsx(_components.mo, {\n                      separator: \"true\",\n                      children: \",\"\n                    }), _jsx(_components.mi, {\n                      children: \"x\"\n                    }), _jsx(_components.mo, {\n                      separator: \"true\",\n                      children: \",\"\n                    }), _jsxs(_components.msub, {\n                      children: [_jsx(_components.mi, {\n                        children: \"y\"\n                      }), _jsx(_components.mtext, {\n                        children: \"target\"\n                      })]\n                    }), _jsx(_components.mo, {\n                      stretchy: \"false\",\n                      children: \")\"\n                    }), _jsx(_components.mo, {\n                      stretchy: \"false\",\n                      children: \")\"\n                    })]\n                  }), _jsx(_components.annotation, {\n                    encoding: \"application/x-tex\",\n                    children: \"x_{\\\\text{adv}} = x + \\\\epsilon \\\\cdot \\\\text{sign}(\\\\nabla_x J(\\\\theta, x, y_{\\\\text{target}}))\"\n                  })]\n                })\n              })\n            }), _jsxs(_components.span, {\n              className: \"katex-html\",\n              \"aria-hidden\": \"true\",\n              children: [_jsxs(_components.span, {\n                className: \"base\",\n                children: [_jsx(_components.span, {\n                  className: \"strut\",\n                  style: {\n                    height: \"0.5806em\",\n                    verticalAlign: \"-0.15em\"\n                  }\n                }), _jsxs(_components.span, {\n                  className: \"mord\",\n                  children: [_jsx(_components.span, {\n                    className: \"mord mathnormal\",\n                    children: \"x\"\n                  }), _jsx(_components.span, {\n                    className: \"msupsub\",\n                    children: _jsxs(_components.span, {\n                      className: \"vlist-t vlist-t2\",\n                      children: [_jsxs(_components.span, {\n                        className: \"vlist-r\",\n                        children: [_jsx(_components.span, {\n                          className: \"vlist\",\n                          style: {\n                            height: \"0.3361em\"\n                          },\n                          children: _jsxs(_components.span, {\n                            style: {\n                              top: \"-2.55em\",\n                              marginLeft: \"0em\",\n                              marginRight: \"0.05em\"\n                            },\n                            children: [_jsx(_components.span, {\n                              className: \"pstrut\",\n                              style: {\n                                height: \"2.7em\"\n                              }\n                            }), _jsx(_components.span, {\n                              className: \"sizing reset-size6 size3 mtight\",\n                              children: _jsx(_components.span, {\n                                className: \"mord mtight\",\n                                children: _jsx(_components.span, {\n                                  className: \"mord text mtight\",\n                                  children: _jsx(_components.span, {\n                                    className: \"mord mtight\",\n                                    children: \"adv\"\n                                  })\n                                })\n                              })\n                            })]\n                          })\n                        }), _jsx(_components.span, {\n                          className: \"vlist-s\",\n                          children: \"​\"\n                        })]\n                      }), _jsx(_components.span, {\n                        className: \"vlist-r\",\n                        children: _jsx(_components.span, {\n                          className: \"vlist\",\n                          style: {\n                            height: \"0.15em\"\n                          },\n                          children: _jsx(_components.span, {})\n                        })\n                      })]\n                    })\n                  })]\n                }), _jsx(_components.span, {\n                  className: \"mspace\",\n                  style: {\n                    marginRight: \"0.2778em\"\n                  }\n                }), _jsx(_components.span, {\n                  className: \"mrel\",\n                  children: \"=\"\n                }), _jsx(_components.span, {\n                  className: \"mspace\",\n                  style: {\n                    marginRight: \"0.2778em\"\n                  }\n                })]\n              }), _jsxs(_components.span, {\n                className: \"base\",\n                children: [_jsx(_components.span, {\n                  className: \"strut\",\n                  style: {\n                    height: \"0.6667em\",\n                    verticalAlign: \"-0.0833em\"\n                  }\n                }), _jsx(_components.span, {\n                  className: \"mord mathnormal\",\n                  children: \"x\"\n                }), _jsx(_components.span, {\n                  className: \"mspace\",\n                  style: {\n                    marginRight: \"0.2222em\"\n                  }\n                }), _jsx(_components.span, {\n                  className: \"mbin\",\n                  children: \"+\"\n                }), _jsx(_components.span, {\n                  className: \"mspace\",\n                  style: {\n                    marginRight: \"0.2222em\"\n                  }\n                })]\n              }), _jsxs(_components.span, {\n                className: \"base\",\n                children: [_jsx(_components.span, {\n                  className: \"strut\",\n                  style: {\n                    height: \"0.4445em\"\n                  }\n                }), _jsx(_components.span, {\n                  className: \"mord mathnormal\",\n                  children: \"ϵ\"\n                }), _jsx(_components.span, {\n                  className: \"mspace\",\n                  style: {\n                    marginRight: \"0.2222em\"\n                  }\n                }), _jsx(_components.span, {\n                  className: \"mbin\",\n                  children: \"⋅\"\n                }), _jsx(_components.span, {\n                  className: \"mspace\",\n                  style: {\n                    marginRight: \"0.2222em\"\n                  }\n                })]\n              }), _jsxs(_components.span, {\n                className: \"base\",\n                children: [_jsx(_components.span, {\n                  className: \"strut\",\n                  style: {\n                    height: \"1.0361em\",\n                    verticalAlign: \"-0.2861em\"\n                  }\n                }), _jsx(_components.span, {\n                  className: \"mord text\",\n                  children: _jsx(_components.span, {\n                    className: \"mord\",\n                    children: \"sign\"\n                  })\n                }), _jsx(_components.span, {\n                  className: \"mopen\",\n                  children: \"(\"\n                }), _jsxs(_components.span, {\n                  className: \"mord\",\n                  children: [_jsx(_components.span, {\n                    className: \"mord\",\n                    children: \"∇\"\n                  }), _jsx(_components.span, {\n                    className: \"msupsub\",\n                    children: _jsxs(_components.span, {\n                      className: \"vlist-t vlist-t2\",\n                      children: [_jsxs(_components.span, {\n                        className: \"vlist-r\",\n                        children: [_jsx(_components.span, {\n                          className: \"vlist\",\n                          style: {\n                            height: \"0.1514em\"\n                          },\n                          children: _jsxs(_components.span, {\n                            style: {\n                              top: \"-2.55em\",\n                              marginLeft: \"0em\",\n                              marginRight: \"0.05em\"\n                            },\n                            children: [_jsx(_components.span, {\n                              className: \"pstrut\",\n                              style: {\n                                height: \"2.7em\"\n                              }\n                            }), _jsx(_components.span, {\n                              className: \"sizing reset-size6 size3 mtight\",\n                              children: _jsx(_components.span, {\n                                className: \"mord mathnormal mtight\",\n                                children: \"x\"\n                              })\n                            })]\n                          })\n                        }), _jsx(_components.span, {\n                          className: \"vlist-s\",\n                          children: \"​\"\n                        })]\n                      }), _jsx(_components.span, {\n                        className: \"vlist-r\",\n                        children: _jsx(_components.span, {\n                          className: \"vlist\",\n                          style: {\n                            height: \"0.15em\"\n                          },\n                          children: _jsx(_components.span, {})\n                        })\n                      })]\n                    })\n                  })]\n                }), _jsx(_components.span, {\n                  className: \"mord mathnormal\",\n                  style: {\n                    marginRight: \"0.09618em\"\n                  },\n                  children: \"J\"\n                }), _jsx(_components.span, {\n                  className: \"mopen\",\n                  children: \"(\"\n                }), _jsx(_components.span, {\n                  className: \"mord mathnormal\",\n                  style: {\n                    marginRight: \"0.02778em\"\n                  },\n                  children: \"θ\"\n                }), _jsx(_components.span, {\n                  className: \"mpunct\",\n                  children: \",\"\n                }), _jsx(_components.span, {\n                  className: \"mspace\",\n                  style: {\n                    marginRight: \"0.1667em\"\n                  }\n                }), _jsx(_components.span, {\n                  className: \"mord mathnormal\",\n                  children: \"x\"\n                }), _jsx(_components.span, {\n                  className: \"mpunct\",\n                  children: \",\"\n                }), _jsx(_components.span, {\n                  className: \"mspace\",\n                  style: {\n                    marginRight: \"0.1667em\"\n                  }\n                }), _jsxs(_components.span, {\n                  className: \"mord\",\n                  children: [_jsx(_components.span, {\n                    className: \"mord mathnormal\",\n                    style: {\n                      marginRight: \"0.03588em\"\n                    },\n                    children: \"y\"\n                  }), _jsx(_components.span, {\n                    className: \"msupsub\",\n                    children: _jsxs(_components.span, {\n                      className: \"vlist-t vlist-t2\",\n                      children: [_jsxs(_components.span, {\n                        className: \"vlist-r\",\n                        children: [_jsx(_components.span, {\n                          className: \"vlist\",\n                          style: {\n                            height: \"0.2806em\"\n                          },\n                          children: _jsxs(_components.span, {\n                            style: {\n                              top: \"-2.55em\",\n                              marginLeft: \"-0.0359em\",\n                              marginRight: \"0.05em\"\n                            },\n                            children: [_jsx(_components.span, {\n                              className: \"pstrut\",\n                              style: {\n                                height: \"2.7em\"\n                              }\n                            }), _jsx(_components.span, {\n                              className: \"sizing reset-size6 size3 mtight\",\n                              children: _jsx(_components.span, {\n                                className: \"mord mtight\",\n                                children: _jsx(_components.span, {\n                                  className: \"mord text mtight\",\n                                  children: _jsx(_components.span, {\n                                    className: \"mord mtight\",\n                                    children: \"target\"\n                                  })\n                                })\n                              })\n                            })]\n                          })\n                        }), _jsx(_components.span, {\n                          className: \"vlist-s\",\n                          children: \"​\"\n                        })]\n                      }), _jsx(_components.span, {\n                        className: \"vlist-r\",\n                        children: _jsx(_components.span, {\n                          className: \"vlist\",\n                          style: {\n                            height: \"0.2861em\"\n                          },\n                          children: _jsx(_components.span, {})\n                        })\n                      })]\n                    })\n                  })]\n                }), _jsx(_components.span, {\n                  className: \"mclose\",\n                  children: \"))\"\n                })]\n              })]\n            })]\n          })\n        })\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Where:\"\n    }), \"\\n\", _jsxs(_components.ul, {\n      children: [\"\\n\", _jsxs(_components.li, {\n        children: [_jsx(_components.code, {\n          className: \"language-math math-inline\",\n          children: _jsxs(_components.span, {\n            className: \"katex\",\n            children: [_jsx(_components.span, {\n              className: \"katex-mathml\",\n              children: _jsx(_components.math, {\n                xmlns: \"http://www.w3.org/1998/Math/MathML\",\n                children: _jsxs(_components.semantics, {\n                  children: [_jsx(_components.mrow, {\n                    children: _jsx(_components.mi, {\n                      children: \"x\"\n                    })\n                  }), _jsx(_components.annotation, {\n                    encoding: \"application/x-tex\",\n                    children: \"x\"\n                  })]\n                })\n              })\n            }), _jsx(_components.span, {\n              className: \"katex-html\",\n              \"aria-hidden\": \"true\",\n              children: _jsxs(_components.span, {\n                className: \"base\",\n                children: [_jsx(_components.span, {\n                  className: \"strut\",\n                  style: {\n                    height: \"0.4306em\"\n                  }\n                }), _jsx(_components.span, {\n                  className: \"mord mathnormal\",\n                  children: \"x\"\n                })]\n              })\n            })]\n          })\n        }), \" is the original input image\"]\n      }), \"\\n\", _jsxs(_components.li, {\n        children: [_jsx(_components.code, {\n          className: \"language-math math-inline\",\n          children: _jsxs(_components.span, {\n            className: \"katex\",\n            children: [_jsx(_components.span, {\n              className: \"katex-mathml\",\n              children: _jsx(_components.math, {\n                xmlns: \"http://www.w3.org/1998/Math/MathML\",\n                children: _jsxs(_components.semantics, {\n                  children: [_jsx(_components.mrow, {\n                    children: _jsx(_components.mi, {\n                      children: \"ϵ\"\n                    })\n                  }), _jsx(_components.annotation, {\n                    encoding: \"application/x-tex\",\n                    children: \"\\\\epsilon\"\n                  })]\n                })\n              })\n            }), _jsx(_components.span, {\n              className: \"katex-html\",\n              \"aria-hidden\": \"true\",\n              children: _jsxs(_components.span, {\n                className: \"base\",\n                children: [_jsx(_components.span, {\n                  className: \"strut\",\n                  style: {\n                    height: \"0.4306em\"\n                  }\n                }), _jsx(_components.span, {\n                  className: \"mord mathnormal\",\n                  children: \"ϵ\"\n                })]\n              })\n            })]\n          })\n        }), \" is the perturbation magnitude (\", _jsx(_components.em, {\n          children: \"how much to change the original image\"\n        }), \").\"]\n      }), \"\\n\", _jsxs(_components.li, {\n        children: [_jsx(_components.code, {\n          className: \"language-math math-inline\",\n          children: _jsxs(_components.span, {\n            className: \"katex\",\n            children: [_jsx(_components.span, {\n              className: \"katex-mathml\",\n              children: _jsx(_components.math, {\n                xmlns: \"http://www.w3.org/1998/Math/MathML\",\n                children: _jsxs(_components.semantics, {\n                  children: [_jsxs(_components.mrow, {\n                    children: [_jsxs(_components.msub, {\n                      children: [_jsx(_components.mi, {\n                        mathvariant: \"normal\",\n                        children: \"∇\"\n                      }), _jsx(_components.mi, {\n                        children: \"x\"\n                      })]\n                    }), _jsx(_components.mi, {\n                      children: \"J\"\n                    }), _jsx(_components.mo, {\n                      stretchy: \"false\",\n                      children: \"(\"\n                    }), _jsx(_components.mi, {\n                      children: \"θ\"\n                    }), _jsx(_components.mo, {\n                      separator: \"true\",\n                      children: \",\"\n                    }), _jsx(_components.mi, {\n                      children: \"x\"\n                    }), _jsx(_components.mo, {\n                      separator: \"true\",\n                      children: \",\"\n                    }), _jsxs(_components.msub, {\n                      children: [_jsx(_components.mi, {\n                        children: \"y\"\n                      }), _jsx(_components.mtext, {\n                        children: \"target\"\n                      })]\n                    }), _jsx(_components.mo, {\n                      stretchy: \"false\",\n                      children: \")\"\n                    })]\n                  }), _jsx(_components.annotation, {\n                    encoding: \"application/x-tex\",\n                    children: \"\\\\nabla_x J(\\\\theta, x, y_{\\\\text{target}})\"\n                  })]\n                })\n              })\n            }), _jsx(_components.span, {\n              className: \"katex-html\",\n              \"aria-hidden\": \"true\",\n              children: _jsxs(_components.span, {\n                className: \"base\",\n                children: [_jsx(_components.span, {\n                  className: \"strut\",\n                  style: {\n                    height: \"1.0361em\",\n                    verticalAlign: \"-0.2861em\"\n                  }\n                }), _jsxs(_components.span, {\n                  className: \"mord\",\n                  children: [_jsx(_components.span, {\n                    className: \"mord\",\n                    children: \"∇\"\n                  }), _jsx(_components.span, {\n                    className: \"msupsub\",\n                    children: _jsxs(_components.span, {\n                      className: \"vlist-t vlist-t2\",\n                      children: [_jsxs(_components.span, {\n                        className: \"vlist-r\",\n                        children: [_jsx(_components.span, {\n                          className: \"vlist\",\n                          style: {\n                            height: \"0.1514em\"\n                          },\n                          children: _jsxs(_components.span, {\n                            style: {\n                              top: \"-2.55em\",\n                              marginLeft: \"0em\",\n                              marginRight: \"0.05em\"\n                            },\n                            children: [_jsx(_components.span, {\n                              className: \"pstrut\",\n                              style: {\n                                height: \"2.7em\"\n                              }\n                            }), _jsx(_components.span, {\n                              className: \"sizing reset-size6 size3 mtight\",\n                              children: _jsx(_components.span, {\n                                className: \"mord mathnormal mtight\",\n                                children: \"x\"\n                              })\n                            })]\n                          })\n                        }), _jsx(_components.span, {\n                          className: \"vlist-s\",\n                          children: \"​\"\n                        })]\n                      }), _jsx(_components.span, {\n                        className: \"vlist-r\",\n                        children: _jsx(_components.span, {\n                          className: \"vlist\",\n                          style: {\n                            height: \"0.15em\"\n                          },\n                          children: _jsx(_components.span, {})\n                        })\n                      })]\n                    })\n                  })]\n                }), _jsx(_components.span, {\n                  className: \"mord mathnormal\",\n                  style: {\n                    marginRight: \"0.09618em\"\n                  },\n                  children: \"J\"\n                }), _jsx(_components.span, {\n                  className: \"mopen\",\n                  children: \"(\"\n                }), _jsx(_components.span, {\n                  className: \"mord mathnormal\",\n                  style: {\n                    marginRight: \"0.02778em\"\n                  },\n                  children: \"θ\"\n                }), _jsx(_components.span, {\n                  className: \"mpunct\",\n                  children: \",\"\n                }), _jsx(_components.span, {\n                  className: \"mspace\",\n                  style: {\n                    marginRight: \"0.1667em\"\n                  }\n                }), _jsx(_components.span, {\n                  className: \"mord mathnormal\",\n                  children: \"x\"\n                }), _jsx(_components.span, {\n                  className: \"mpunct\",\n                  children: \",\"\n                }), _jsx(_components.span, {\n                  className: \"mspace\",\n                  style: {\n                    marginRight: \"0.1667em\"\n                  }\n                }), _jsxs(_components.span, {\n                  className: \"mord\",\n                  children: [_jsx(_components.span, {\n                    className: \"mord mathnormal\",\n                    style: {\n                      marginRight: \"0.03588em\"\n                    },\n                    children: \"y\"\n                  }), _jsx(_components.span, {\n                    className: \"msupsub\",\n                    children: _jsxs(_components.span, {\n                      className: \"vlist-t vlist-t2\",\n                      children: [_jsxs(_components.span, {\n                        className: \"vlist-r\",\n                        children: [_jsx(_components.span, {\n                          className: \"vlist\",\n                          style: {\n                            height: \"0.2806em\"\n                          },\n                          children: _jsxs(_components.span, {\n                            style: {\n                              top: \"-2.55em\",\n                              marginLeft: \"-0.0359em\",\n                              marginRight: \"0.05em\"\n                            },\n                            children: [_jsx(_components.span, {\n                              className: \"pstrut\",\n                              style: {\n                                height: \"2.7em\"\n                              }\n                            }), _jsx(_components.span, {\n                              className: \"sizing reset-size6 size3 mtight\",\n                              children: _jsx(_components.span, {\n                                className: \"mord mtight\",\n                                children: _jsx(_components.span, {\n                                  className: \"mord text mtight\",\n                                  children: _jsx(_components.span, {\n                                    className: \"mord mtight\",\n                                    children: \"target\"\n                                  })\n                                })\n                              })\n                            })]\n                          })\n                        }), _jsx(_components.span, {\n                          className: \"vlist-s\",\n                          children: \"​\"\n                        })]\n                      }), _jsx(_components.span, {\n                        className: \"vlist-r\",\n                        children: _jsx(_components.span, {\n                          className: \"vlist\",\n                          style: {\n                            height: \"0.2861em\"\n                          },\n                          children: _jsx(_components.span, {})\n                        })\n                      })]\n                    })\n                  })]\n                }), _jsx(_components.span, {\n                  className: \"mclose\",\n                  children: \")\"\n                })]\n              })\n            })]\n          })\n        }), \" is the gradient of the loss function \", _jsx(_components.code, {\n          className: \"language-math math-inline\",\n          children: _jsxs(_components.span, {\n            className: \"katex\",\n            children: [_jsx(_components.span, {\n              className: \"katex-mathml\",\n              children: _jsx(_components.math, {\n                xmlns: \"http://www.w3.org/1998/Math/MathML\",\n                children: _jsxs(_components.semantics, {\n                  children: [_jsx(_components.mrow, {\n                    children: _jsx(_components.mi, {\n                      children: \"J\"\n                    })\n                  }), _jsx(_components.annotation, {\n                    encoding: \"application/x-tex\",\n                    children: \"J\"\n                  })]\n                })\n              })\n            }), _jsx(_components.span, {\n              className: \"katex-html\",\n              \"aria-hidden\": \"true\",\n              children: _jsxs(_components.span, {\n                className: \"base\",\n                children: [_jsx(_components.span, {\n                  className: \"strut\",\n                  style: {\n                    height: \"0.6833em\"\n                  }\n                }), _jsx(_components.span, {\n                  className: \"mord mathnormal\",\n                  style: {\n                    marginRight: \"0.09618em\"\n                  },\n                  children: \"J\"\n                })]\n              })\n            })]\n          })\n        }), \" with respect to \", _jsx(_components.code, {\n          className: \"language-math math-inline\",\n          children: _jsxs(_components.span, {\n            className: \"katex\",\n            children: [_jsx(_components.span, {\n              className: \"katex-mathml\",\n              children: _jsx(_components.math, {\n                xmlns: \"http://www.w3.org/1998/Math/MathML\",\n                children: _jsxs(_components.semantics, {\n                  children: [_jsx(_components.mrow, {\n                    children: _jsx(_components.mi, {\n                      children: \"x\"\n                    })\n                  }), _jsx(_components.annotation, {\n                    encoding: \"application/x-tex\",\n                    children: \"x\"\n                  })]\n                })\n              })\n            }), _jsx(_components.span, {\n              className: \"katex-html\",\n              \"aria-hidden\": \"true\",\n              children: _jsxs(_components.span, {\n                className: \"base\",\n                children: [_jsx(_components.span, {\n                  className: \"strut\",\n                  style: {\n                    height: \"0.4306em\"\n                  }\n                }), _jsx(_components.span, {\n                  className: \"mord mathnormal\",\n                  children: \"x\"\n                })]\n              })\n            })]\n          })\n        }), \".\"]\n      }), \"\\n\", _jsxs(_components.li, {\n        children: [_jsx(_components.code, {\n          className: \"language-math math-inline\",\n          children: _jsxs(_components.span, {\n            className: \"katex\",\n            children: [_jsx(_components.span, {\n              className: \"katex-mathml\",\n              children: _jsx(_components.math, {\n                xmlns: \"http://www.w3.org/1998/Math/MathML\",\n                children: _jsxs(_components.semantics, {\n                  children: [_jsxs(_components.mrow, {\n                    children: [_jsx(_components.mtext, {\n                      children: \"sign\"\n                    }), _jsx(_components.mo, {\n                      stretchy: \"false\",\n                      children: \"(\"\n                    }), _jsx(_components.mo, {\n                      children: \"⋅\"\n                    }), _jsx(_components.mo, {\n                      stretchy: \"false\",\n                      children: \")\"\n                    })]\n                  }), _jsx(_components.annotation, {\n                    encoding: \"application/x-tex\",\n                    children: \"\\\\text{sign}(\\\\cdot)\"\n                  })]\n                })\n              })\n            }), _jsx(_components.span, {\n              className: \"katex-html\",\n              \"aria-hidden\": \"true\",\n              children: _jsxs(_components.span, {\n                className: \"base\",\n                children: [_jsx(_components.span, {\n                  className: \"strut\",\n                  style: {\n                    height: \"1em\",\n                    verticalAlign: \"-0.25em\"\n                  }\n                }), _jsx(_components.span, {\n                  className: \"mord text\",\n                  children: _jsx(_components.span, {\n                    className: \"mord\",\n                    children: \"sign\"\n                  })\n                }), _jsx(_components.span, {\n                  className: \"mopen\",\n                  children: \"(\"\n                }), _jsx(_components.span, {\n                  className: \"mord\",\n                  children: \"⋅\"\n                }), _jsx(_components.span, {\n                  className: \"mclose\",\n                  children: \")\"\n                })]\n              })\n            })]\n          })\n        }), \" denotes the sign function.\"]\n      }), \"\\n\"]\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Let's try to use FSGM on the same example problem that we've been working on using the burb image as the initial image.\"\n    }), \"\\n\", _jsx(_components.pre, {\n      className: \"language-python\",\n      children: _jsxs(_components.code, {\n        className: \"language-python code-highlight\",\n        children: [_jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"target_output \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" torch\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"tensor\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"[\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"]\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" dtype\", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \"torch\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), _jsx(_components.span, {\n            className: \"token builtin\",\n            children: \"long\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token comment\",\n            children: \"# we will target index 0, which is \\\"tench, Tinca tinca\\\"\"\n          }), \"\\n\"]\n        }), _jsx(_components.span, {\n          className: \"code-line\",\n          children: \"\\n\"\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"burb_img_tensor \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" torch\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"tensor\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"burb_img\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" dtype\", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \"torch\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"float32\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"permute\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"2\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"1\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"unsqueeze\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"/\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"255.0\"\n          }), \"\\n\"]\n        }), _jsx(_components.span, {\n          className: \"code-line\",\n          children: \"\\n\"\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"x \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" torch\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"tensor\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"burb_img\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" dtype\", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \"torch\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"float32\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"permute\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"2\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"1\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"unsqueeze\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"/\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"255.0\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"x\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"requires_grad \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token boolean\",\n            children: \"True\"\n          }), \"\\n\"]\n        }), _jsx(_components.span, {\n          className: \"code-line\",\n          children: \"\\n\"\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"epsilon \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"2.\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"/\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"255.\"\n          }), \"\\n\"]\n        }), _jsx(_components.span, {\n          className: \"code-line\",\n          children: \"\\n\"\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"output \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" model\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"x\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"loss \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"-\"\n          }), \"F\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"cross_entropy\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"output\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" target_output\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsx(_components.span, {\n          className: \"code-line\",\n          children: \"\\n\"\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"model\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"zero_grad\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"loss\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"backward\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsx(_components.span, {\n          className: \"code-line\",\n          children: \"\\n\"\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"grad \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" x\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"grad\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"data\\n\"]\n        }), _jsx(_components.span, {\n          className: \"code-line\",\n          children: \"\\n\"\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"x_adv \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" x \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"+\"\n          }), \" epsilon \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"*\"\n          }), \" grad\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"sign\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"x_adv \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" torch\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"clamp\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"x_adv\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"1\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        })]\n      })\n    }), \"\\n\", _jsxs(\"p\", {\n      className: \"mr-4 subtext\",\n      style: {\n        fontSize: '0.75rem'\n      },\n      children: [\"full code: \", _jsx(_components.a, {\n        href: \"https://github.com/OutWrest/blog-handouts/blob/main/exploring-attacks-1/attacks-introduction.ipynb\",\n        children: \"https://github.com/OutWrest/blog-handouts/blob/main/exploring-attacks-1/attacks-introduction.ipynb\"\n      })]\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Output:\"\n    }), \"\\n\", _jsx(_components.pre, {\n      className: \"language-bash\",\n      children: _jsx(_components.code, {\n        className: \"language-bash code-highlight\",\n        children: _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"Loss: \", _jsx(_components.span, {\n            className: \"token parameter variable\",\n            children: \"-9.0888\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" min/max/mean: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.00\"\n          }), \"/3.00/2.00 \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Pred: \", _jsx(_components.span, {\n            className: \"token string\",\n            children: \"\\\"tench\\\"\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"29.52\"\n          }), \"% confidence\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        })\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"In FSGM, we only generate a single example through the calculation and we do not iterate on our adversarial example.\"\n    }), \"\\n\", _jsxs(\"div\", {\n      className: \"flex items-center justify-center flex-col\",\n      children: [_jsx(\"img\", {\n        className: \"block\",\n        src: \"/post-assets/exploring-attacks-1/burb-img-adv-fsgm.png\",\n        alt: \"Burb image classified as tench\"\n      }), _jsx(\"p\", {\n        className: \"mr-4 subtext\",\n        style: {\n          fontSize: '0.75rem'\n        },\n        children: \"The output adversarial example on burb image using FSGM.\"\n      })]\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Since FGSM is sensative to epsilon and input image.\\nDepending on input image \u0026 target class, it may be that FSGM is the best solution but it is a good start.\\nIn our case, we are trying to optimize for very low perturbation to get a model to classify an image into targeted category.\\nWhile it was able to generate a solution for this case, it did not produce an example with high confidence.\"\n    }), \"\\n\", _jsx(_components.h2, {\n      children: \"Projected Gradient Descent (PGD) Solution\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"The Projected Gradient Descent (PGD) method is an iterative extension of FGSM.\\nInstead of applying the perturbation only once, PGD iteratively perturbs the input image in small steps.\\nThis iterative process helps to find more effective adversarial examples while keeping the perturbations within a specified limit.\"\n    }), \"\\n\", _jsx(Math, {\n      children: _jsx(_components.p, {\n        children: _jsx(_components.code, {\n          className: \"language-math math-inline\",\n          children: _jsxs(_components.span, {\n            className: \"katex\",\n            children: [_jsx(_components.span, {\n              className: \"katex-mathml\",\n              children: _jsx(_components.math, {\n                xmlns: \"http://www.w3.org/1998/Math/MathML\",\n                children: _jsxs(_components.semantics, {\n                  children: [_jsxs(_components.mrow, {\n                    children: [_jsxs(_components.msup, {\n                      children: [_jsx(_components.mi, {\n                        children: \"x\"\n                      }), _jsxs(_components.mrow, {\n                        children: [_jsx(_components.mo, {\n                          stretchy: \"false\",\n                          children: \"(\"\n                        }), _jsx(_components.mi, {\n                          children: \"k\"\n                        }), _jsx(_components.mo, {\n                          children: \"+\"\n                        }), _jsx(_components.mn, {\n                          children: \"1\"\n                        }), _jsx(_components.mo, {\n                          stretchy: \"false\",\n                          children: \")\"\n                        })]\n                      })]\n                    }), _jsx(_components.mo, {\n                      children: \"=\"\n                    }), _jsx(_components.mtext, {\n                      children: \"clip\"\n                    }), _jsx(_components.mo, {\n                      stretchy: \"false\",\n                      children: \"(\"\n                    }), _jsxs(_components.msup, {\n                      children: [_jsx(_components.mi, {\n                        children: \"x\"\n                      }), _jsxs(_components.mrow, {\n                        children: [_jsx(_components.mo, {\n                          stretchy: \"false\",\n                          children: \"(\"\n                        }), _jsx(_components.mi, {\n                          children: \"k\"\n                        }), _jsx(_components.mo, {\n                          stretchy: \"false\",\n                          children: \")\"\n                        })]\n                      })]\n                    }), _jsx(_components.mo, {\n                      children: \"−\"\n                    }), _jsx(_components.mi, {\n                      children: \"α\"\n                    }), _jsx(_components.mo, {\n                      children: \"⋅\"\n                    }), _jsx(_components.mtext, {\n                      children: \"sign\"\n                    }), _jsx(_components.mo, {\n                      stretchy: \"false\",\n                      children: \"(\"\n                    }), _jsxs(_components.msub, {\n                      children: [_jsx(_components.mi, {\n                        mathvariant: \"normal\",\n                        children: \"∇\"\n                      }), _jsx(_components.mi, {\n                        children: \"x\"\n                      })]\n                    }), _jsx(_components.mi, {\n                      children: \"J\"\n                    }), _jsx(_components.mo, {\n                      stretchy: \"false\",\n                      children: \"(\"\n                    }), _jsx(_components.mi, {\n                      children: \"θ\"\n                    }), _jsx(_components.mo, {\n                      separator: \"true\",\n                      children: \",\"\n                    }), _jsx(_components.mi, {\n                      children: \"x\"\n                    }), _jsx(_components.mo, {\n                      separator: \"true\",\n                      children: \",\"\n                    }), _jsxs(_components.msub, {\n                      children: [_jsx(_components.mi, {\n                        children: \"y\"\n                      }), _jsx(_components.mtext, {\n                        children: \"target\"\n                      })]\n                    }), _jsx(_components.mo, {\n                      stretchy: \"false\",\n                      children: \")\"\n                    }), _jsx(_components.mo, {\n                      stretchy: \"false\",\n                      children: \")\"\n                    }), _jsx(_components.mo, {\n                      separator: \"true\",\n                      children: \",\"\n                    }), _jsx(_components.mi, {\n                      children: \"ϵ\"\n                    }), _jsx(_components.mo, {\n                      stretchy: \"false\",\n                      children: \")\"\n                    })]\n                  }), _jsx(_components.annotation, {\n                    encoding: \"application/x-tex\",\n                    children: \"x^{(k+1)} = \\\\text{clip}(x^{(k)} - \\\\alpha \\\\cdot \\\\text{sign}(\\\\nabla_x J(\\\\theta, x, y_{\\\\text{target}})), \\\\epsilon)\"\n                  })]\n                })\n              })\n            }), _jsxs(_components.span, {\n              className: \"katex-html\",\n              \"aria-hidden\": \"true\",\n              children: [_jsxs(_components.span, {\n                className: \"base\",\n                children: [_jsx(_components.span, {\n                  className: \"strut\",\n                  style: {\n                    height: \"0.888em\"\n                  }\n                }), _jsxs(_components.span, {\n                  className: \"mord\",\n                  children: [_jsx(_components.span, {\n                    className: \"mord mathnormal\",\n                    children: \"x\"\n                  }), _jsx(_components.span, {\n                    className: \"msupsub\",\n                    children: _jsx(_components.span, {\n                      className: \"vlist-t\",\n                      children: _jsx(_components.span, {\n                        className: \"vlist-r\",\n                        children: _jsx(_components.span, {\n                          className: \"vlist\",\n                          style: {\n                            height: \"0.888em\"\n                          },\n                          children: _jsxs(_components.span, {\n                            style: {\n                              top: \"-3.063em\",\n                              marginRight: \"0.05em\"\n                            },\n                            children: [_jsx(_components.span, {\n                              className: \"pstrut\",\n                              style: {\n                                height: \"2.7em\"\n                              }\n                            }), _jsx(_components.span, {\n                              className: \"sizing reset-size6 size3 mtight\",\n                              children: _jsxs(_components.span, {\n                                className: \"mord mtight\",\n                                children: [_jsx(_components.span, {\n                                  className: \"mopen mtight\",\n                                  children: \"(\"\n                                }), _jsx(_components.span, {\n                                  className: \"mord mathnormal mtight\",\n                                  style: {\n                                    marginRight: \"0.03148em\"\n                                  },\n                                  children: \"k\"\n                                }), _jsx(_components.span, {\n                                  className: \"mbin mtight\",\n                                  children: \"+\"\n                                }), _jsx(_components.span, {\n                                  className: \"mord mtight\",\n                                  children: \"1\"\n                                }), _jsx(_components.span, {\n                                  className: \"mclose mtight\",\n                                  children: \")\"\n                                })]\n                              })\n                            })]\n                          })\n                        })\n                      })\n                    })\n                  })]\n                }), _jsx(_components.span, {\n                  className: \"mspace\",\n                  style: {\n                    marginRight: \"0.2778em\"\n                  }\n                }), _jsx(_components.span, {\n                  className: \"mrel\",\n                  children: \"=\"\n                }), _jsx(_components.span, {\n                  className: \"mspace\",\n                  style: {\n                    marginRight: \"0.2778em\"\n                  }\n                })]\n              }), _jsxs(_components.span, {\n                className: \"base\",\n                children: [_jsx(_components.span, {\n                  className: \"strut\",\n                  style: {\n                    height: \"1.138em\",\n                    verticalAlign: \"-0.25em\"\n                  }\n                }), _jsx(_components.span, {\n                  className: \"mord text\",\n                  children: _jsx(_components.span, {\n                    className: \"mord\",\n                    children: \"clip\"\n                  })\n                }), _jsx(_components.span, {\n                  className: \"mopen\",\n                  children: \"(\"\n                }), _jsxs(_components.span, {\n                  className: \"mord\",\n                  children: [_jsx(_components.span, {\n                    className: \"mord mathnormal\",\n                    children: \"x\"\n                  }), _jsx(_components.span, {\n                    className: \"msupsub\",\n                    children: _jsx(_components.span, {\n                      className: \"vlist-t\",\n                      children: _jsx(_components.span, {\n                        className: \"vlist-r\",\n                        children: _jsx(_components.span, {\n                          className: \"vlist\",\n                          style: {\n                            height: \"0.888em\"\n                          },\n                          children: _jsxs(_components.span, {\n                            style: {\n                              top: \"-3.063em\",\n                              marginRight: \"0.05em\"\n                            },\n                            children: [_jsx(_components.span, {\n                              className: \"pstrut\",\n                              style: {\n                                height: \"2.7em\"\n                              }\n                            }), _jsx(_components.span, {\n                              className: \"sizing reset-size6 size3 mtight\",\n                              children: _jsxs(_components.span, {\n                                className: \"mord mtight\",\n                                children: [_jsx(_components.span, {\n                                  className: \"mopen mtight\",\n                                  children: \"(\"\n                                }), _jsx(_components.span, {\n                                  className: \"mord mathnormal mtight\",\n                                  style: {\n                                    marginRight: \"0.03148em\"\n                                  },\n                                  children: \"k\"\n                                }), _jsx(_components.span, {\n                                  className: \"mclose mtight\",\n                                  children: \")\"\n                                })]\n                              })\n                            })]\n                          })\n                        })\n                      })\n                    })\n                  })]\n                }), _jsx(_components.span, {\n                  className: \"mspace\",\n                  style: {\n                    marginRight: \"0.2222em\"\n                  }\n                }), _jsx(_components.span, {\n                  className: \"mbin\",\n                  children: \"−\"\n                }), _jsx(_components.span, {\n                  className: \"mspace\",\n                  style: {\n                    marginRight: \"0.2222em\"\n                  }\n                })]\n              }), _jsxs(_components.span, {\n                className: \"base\",\n                children: [_jsx(_components.span, {\n                  className: \"strut\",\n                  style: {\n                    height: \"0.4445em\"\n                  }\n                }), _jsx(_components.span, {\n                  className: \"mord mathnormal\",\n                  style: {\n                    marginRight: \"0.0037em\"\n                  },\n                  children: \"α\"\n                }), _jsx(_components.span, {\n                  className: \"mspace\",\n                  style: {\n                    marginRight: \"0.2222em\"\n                  }\n                }), _jsx(_components.span, {\n                  className: \"mbin\",\n                  children: \"⋅\"\n                }), _jsx(_components.span, {\n                  className: \"mspace\",\n                  style: {\n                    marginRight: \"0.2222em\"\n                  }\n                })]\n              }), _jsxs(_components.span, {\n                className: \"base\",\n                children: [_jsx(_components.span, {\n                  className: \"strut\",\n                  style: {\n                    height: \"1.0361em\",\n                    verticalAlign: \"-0.2861em\"\n                  }\n                }), _jsx(_components.span, {\n                  className: \"mord text\",\n                  children: _jsx(_components.span, {\n                    className: \"mord\",\n                    children: \"sign\"\n                  })\n                }), _jsx(_components.span, {\n                  className: \"mopen\",\n                  children: \"(\"\n                }), _jsxs(_components.span, {\n                  className: \"mord\",\n                  children: [_jsx(_components.span, {\n                    className: \"mord\",\n                    children: \"∇\"\n                  }), _jsx(_components.span, {\n                    className: \"msupsub\",\n                    children: _jsxs(_components.span, {\n                      className: \"vlist-t vlist-t2\",\n                      children: [_jsxs(_components.span, {\n                        className: \"vlist-r\",\n                        children: [_jsx(_components.span, {\n                          className: \"vlist\",\n                          style: {\n                            height: \"0.1514em\"\n                          },\n                          children: _jsxs(_components.span, {\n                            style: {\n                              top: \"-2.55em\",\n                              marginLeft: \"0em\",\n                              marginRight: \"0.05em\"\n                            },\n                            children: [_jsx(_components.span, {\n                              className: \"pstrut\",\n                              style: {\n                                height: \"2.7em\"\n                              }\n                            }), _jsx(_components.span, {\n                              className: \"sizing reset-size6 size3 mtight\",\n                              children: _jsx(_components.span, {\n                                className: \"mord mathnormal mtight\",\n                                children: \"x\"\n                              })\n                            })]\n                          })\n                        }), _jsx(_components.span, {\n                          className: \"vlist-s\",\n                          children: \"​\"\n                        })]\n                      }), _jsx(_components.span, {\n                        className: \"vlist-r\",\n                        children: _jsx(_components.span, {\n                          className: \"vlist\",\n                          style: {\n                            height: \"0.15em\"\n                          },\n                          children: _jsx(_components.span, {})\n                        })\n                      })]\n                    })\n                  })]\n                }), _jsx(_components.span, {\n                  className: \"mord mathnormal\",\n                  style: {\n                    marginRight: \"0.09618em\"\n                  },\n                  children: \"J\"\n                }), _jsx(_components.span, {\n                  className: \"mopen\",\n                  children: \"(\"\n                }), _jsx(_components.span, {\n                  className: \"mord mathnormal\",\n                  style: {\n                    marginRight: \"0.02778em\"\n                  },\n                  children: \"θ\"\n                }), _jsx(_components.span, {\n                  className: \"mpunct\",\n                  children: \",\"\n                }), _jsx(_components.span, {\n                  className: \"mspace\",\n                  style: {\n                    marginRight: \"0.1667em\"\n                  }\n                }), _jsx(_components.span, {\n                  className: \"mord mathnormal\",\n                  children: \"x\"\n                }), _jsx(_components.span, {\n                  className: \"mpunct\",\n                  children: \",\"\n                }), _jsx(_components.span, {\n                  className: \"mspace\",\n                  style: {\n                    marginRight: \"0.1667em\"\n                  }\n                }), _jsxs(_components.span, {\n                  className: \"mord\",\n                  children: [_jsx(_components.span, {\n                    className: \"mord mathnormal\",\n                    style: {\n                      marginRight: \"0.03588em\"\n                    },\n                    children: \"y\"\n                  }), _jsx(_components.span, {\n                    className: \"msupsub\",\n                    children: _jsxs(_components.span, {\n                      className: \"vlist-t vlist-t2\",\n                      children: [_jsxs(_components.span, {\n                        className: \"vlist-r\",\n                        children: [_jsx(_components.span, {\n                          className: \"vlist\",\n                          style: {\n                            height: \"0.2806em\"\n                          },\n                          children: _jsxs(_components.span, {\n                            style: {\n                              top: \"-2.55em\",\n                              marginLeft: \"-0.0359em\",\n                              marginRight: \"0.05em\"\n                            },\n                            children: [_jsx(_components.span, {\n                              className: \"pstrut\",\n                              style: {\n                                height: \"2.7em\"\n                              }\n                            }), _jsx(_components.span, {\n                              className: \"sizing reset-size6 size3 mtight\",\n                              children: _jsx(_components.span, {\n                                className: \"mord mtight\",\n                                children: _jsx(_components.span, {\n                                  className: \"mord text mtight\",\n                                  children: _jsx(_components.span, {\n                                    className: \"mord mtight\",\n                                    children: \"target\"\n                                  })\n                                })\n                              })\n                            })]\n                          })\n                        }), _jsx(_components.span, {\n                          className: \"vlist-s\",\n                          children: \"​\"\n                        })]\n                      }), _jsx(_components.span, {\n                        className: \"vlist-r\",\n                        children: _jsx(_components.span, {\n                          className: \"vlist\",\n                          style: {\n                            height: \"0.2861em\"\n                          },\n                          children: _jsx(_components.span, {})\n                        })\n                      })]\n                    })\n                  })]\n                }), _jsx(_components.span, {\n                  className: \"mclose\",\n                  children: \"))\"\n                }), _jsx(_components.span, {\n                  className: \"mpunct\",\n                  children: \",\"\n                }), _jsx(_components.span, {\n                  className: \"mspace\",\n                  style: {\n                    marginRight: \"0.1667em\"\n                  }\n                }), _jsx(_components.span, {\n                  className: \"mord mathnormal\",\n                  children: \"ϵ\"\n                }), _jsx(_components.span, {\n                  className: \"mclose\",\n                  children: \")\"\n                })]\n              })]\n            })]\n          })\n        })\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Where:\"\n    }), \"\\n\", _jsxs(_components.ul, {\n      children: [\"\\n\", _jsxs(_components.li, {\n        children: [_jsx(_components.code, {\n          className: \"language-math math-inline\",\n          children: _jsxs(_components.span, {\n            className: \"katex\",\n            children: [_jsx(_components.span, {\n              className: \"katex-mathml\",\n              children: _jsx(_components.math, {\n                xmlns: \"http://www.w3.org/1998/Math/MathML\",\n                children: _jsxs(_components.semantics, {\n                  children: [_jsx(_components.mrow, {\n                    children: _jsx(_components.mi, {\n                      children: \"α\"\n                    })\n                  }), _jsx(_components.annotation, {\n                    encoding: \"application/x-tex\",\n                    children: \"\\\\alpha\"\n                  })]\n                })\n              })\n            }), _jsx(_components.span, {\n              className: \"katex-html\",\n              \"aria-hidden\": \"true\",\n              children: _jsxs(_components.span, {\n                className: \"base\",\n                children: [_jsx(_components.span, {\n                  className: \"strut\",\n                  style: {\n                    height: \"0.4306em\"\n                  }\n                }), _jsx(_components.span, {\n                  className: \"mord mathnormal\",\n                  style: {\n                    marginRight: \"0.0037em\"\n                  },\n                  children: \"α\"\n                })]\n              })\n            })]\n          })\n        }), \" is the step size.\"]\n      }), \"\\n\", _jsxs(_components.li, {\n        children: [_jsx(_components.code, {\n          className: \"language-math math-inline\",\n          children: _jsxs(_components.span, {\n            className: \"katex\",\n            children: [_jsx(_components.span, {\n              className: \"katex-mathml\",\n              children: _jsx(_components.math, {\n                xmlns: \"http://www.w3.org/1998/Math/MathML\",\n                children: _jsxs(_components.semantics, {\n                  children: [_jsx(_components.mrow, {\n                    children: _jsx(_components.mi, {\n                      children: \"ϵ\"\n                    })\n                  }), _jsx(_components.annotation, {\n                    encoding: \"application/x-tex\",\n                    children: \"\\\\epsilon\"\n                  })]\n                })\n              })\n            }), _jsx(_components.span, {\n              className: \"katex-html\",\n              \"aria-hidden\": \"true\",\n              children: _jsxs(_components.span, {\n                className: \"base\",\n                children: [_jsx(_components.span, {\n                  className: \"strut\",\n                  style: {\n                    height: \"0.4306em\"\n                  }\n                }), _jsx(_components.span, {\n                  className: \"mord mathnormal\",\n                  children: \"ϵ\"\n                })]\n              })\n            })]\n          })\n        }), \" is the maximimal allowed perturbation.\"]\n      }), \"\\n\"]\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Again, let's apply PGD to the same problem.\"\n    }), \"\\n\", _jsx(_components.pre, {\n      className: \"language-python\",\n      children: _jsxs(_components.code, {\n        className: \"language-python code-highlight\",\n        children: [_jsxs(_components.span, {\n          className: \"code-line\",\n          children: [_jsx(_components.span, {\n            className: \"token comment\",\n            children: \"# we will target index 413, which is \\\"assault rifle, assault gun\\\"\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"target_output \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" torch\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"tensor\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"[\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"413\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"]\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" dtype\", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \"torch\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), _jsx(_components.span, {\n            className: \"token builtin\",\n            children: \"long\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsx(_components.span, {\n          className: \"code-line\",\n          children: \"\\n\"\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"burb_img_tensor \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" torch\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"tensor\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"burb_img\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" dtype\", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \"torch\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"float32\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"permute\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"2\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"1\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"unsqueeze\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"/\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"255.0\"\n          }), \"\\n\"]\n        }), _jsx(_components.span, {\n          className: \"code-line\",\n          children: \"\\n\"\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"x \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" torch\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"tensor\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"burb_img\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" dtype\", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \"torch\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"float32\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"permute\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"2\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"1\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"unsqueeze\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"/\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"255.0\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"x\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"requires_grad \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token boolean\",\n            children: \"True\"\n          }), \"\\n\"]\n        }), _jsx(_components.span, {\n          className: \"code-line\",\n          children: \"\\n\"\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"epsilon \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \"   \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"5.\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"/\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"255.\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token comment\",\n            children: \"# we will allow a maximum of 5 pixel difference\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"alpha \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \"     \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"1.\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"/\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"255.\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token comment\",\n            children: \"# step size at each iteration (how many pixels to move each iteration)\"\n          }), \"\\n\"]\n        }), _jsx(_components.span, {\n          className: \"code-line\",\n          children: \"\\n\"\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [_jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"for\"\n          }), \" iteration \", _jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"in\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token builtin\",\n            children: \"range\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"10\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    output \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" model\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"x\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    loss \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" F\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"cross_entropy\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"output\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" target_output\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsx(_components.span, {\n          className: \"code-line\",\n          children: \"\\n\"\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    model\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"zero_grad\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    loss\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"backward\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsx(_components.span, {\n          className: \"code-line\",\n          children: \"\\n\"\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    x\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"data \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" x\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"data \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"-\"\n          }), \" alpha \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"*\"\n          }), \" x\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"grad\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"sign\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    x\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"data \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" torch\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"clamp\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"x\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"data\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"1\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    x\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"data \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" torch\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"clamp\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"x\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"data\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" burb_img_tensor \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"-\"\n          }), \" epsilon\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" burb_img_tensor \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"+\"\n          }), \" epsilon\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        })]\n      })\n    }), \"\\n\", _jsxs(\"p\", {\n      className: \"mr-4 subtext\",\n      style: {\n        fontSize: '0.75rem'\n      },\n      children: [\"full code: \", _jsx(_components.a, {\n        href: \"https://github.com/OutWrest/blog-handouts/blob/main/exploring-attacks-1/attacks-introduction.ipynb\",\n        children: \"https://github.com/OutWrest/blog-handouts/blob/main/exploring-attacks-1/attacks-introduction.ipynb\"\n      })]\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Output:\"\n    }), \"\\n\", _jsx(_components.pre, {\n      className: \"language-bash\",\n      children: _jsxs(_components.code, {\n        className: \"language-bash code-highlight\",\n        children: [_jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"Iter: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0\"\n          }), \"  \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Loss:  \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"13.438\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" min/max/mean: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.00\"\n          }), \"/2.00/1.00 \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Pred: \", _jsx(_components.span, {\n            className: \"token string\",\n            children: \"\\\"puffer\\\"\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"5.08\"\n          }), \"% confidence\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"Iter: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"1\"\n          }), \"  \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Loss:  \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"8.0757\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" min/max/mean: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.00\"\n          }), \"/3.00/1.75 \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Pred: \", _jsx(_components.span, {\n            className: \"token string\",\n            children: \"\\\"muzzle\\\"\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"3.38\"\n          }), \"% confidence\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"Iter: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"2\"\n          }), \"  \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Loss:  \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"4.8234\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" min/max/mean: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.00\"\n          }), \"/3.00/2.55 \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Pred: \", _jsx(_components.span, {\n            className: \"token string\",\n            children: \"\\\"assault rifle\\\"\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"15.30\"\n          }), \"% confidence\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"Iter: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"3\"\n          }), \"  \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Loss:  \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"1.8669\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" min/max/mean: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.00\"\n          }), \"/4.00/3.22 \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Pred: \", _jsx(_components.span, {\n            className: \"token string\",\n            children: \"\\\"assault rifle\\\"\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"68.43\"\n          }), \"% confidence\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"Iter: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"4\"\n          }), \"  \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Loss:  \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.3802\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" min/max/mean: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.00\"\n          }), \"/5.00/4.04 \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Pred: \", _jsx(_components.span, {\n            className: \"token string\",\n            children: \"\\\"assault rifle\\\"\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"84.15\"\n          }), \"% confidence\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"Iter: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"5\"\n          }), \"  \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Loss:  \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.1732\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" min/max/mean: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.00\"\n          }), \"/6.00/4.18 \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Pred: \", _jsx(_components.span, {\n            className: \"token string\",\n            children: \"\\\"assault rifle\\\"\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"90.14\"\n          }), \"% confidence\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"Iter: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"6\"\n          }), \"  \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Loss:  \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.1038\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" min/max/mean: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.00\"\n          }), \"/6.00/4.42 \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Pred: \", _jsx(_components.span, {\n            className: \"token string\",\n            children: \"\\\"assault rifle\\\"\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"92.51\"\n          }), \"% confidence\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"Iter: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"7\"\n          }), \"  \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Loss:  \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.0781\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" min/max/mean: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.00\"\n          }), \"/6.00/4.55 \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Pred: \", _jsx(_components.span, {\n            className: \"token string\",\n            children: \"\\\"assault rifle\\\"\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"94.01\"\n          }), \"% confidence\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"Iter: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"8\"\n          }), \"  \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Loss:  \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.0620\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" min/max/mean: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.00\"\n          }), \"/6.00/4.69 \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Pred: \", _jsx(_components.span, {\n            className: \"token string\",\n            children: \"\\\"assault rifle\\\"\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"95.16\"\n          }), \"% confidence\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"Iter: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"9\"\n          }), \"  \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Loss:  \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.0498\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" min/max/mean: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.00\"\n          }), \"/6.00/4.75 \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Pred: \", _jsx(_components.span, {\n            className: \"token string\",\n            children: \"\\\"assault rifle\\\"\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"96.24\"\n          }), \"% confidence\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        })]\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"With PGD we are able to generate a targeted image at a higher confidence than using a simple gradient descent method.\"\n    }), \"\\n\", _jsxs(\"div\", {\n      className: \"flex items-center justify-center flex-col\",\n      children: [_jsx(\"img\", {\n        className: \"block\",\n        src: \"/post-assets/exploring-attacks-1/burb-img-adv-pgd.png\",\n        alt: \"Burb image classified as assault rifle\"\n      }), _jsx(\"p\", {\n        className: \"mr-4 subtext\",\n        style: {\n          fontSize: '0.75rem'\n        },\n        children: \"The output adversarial example on burb image using PGD.\"\n      })]\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Notice how this perturbation image is closer to FGSM than the simple iterative method.\\nThe bottom left of this PGD perturbation image shows the pixel different around the bottom left following certain edges, but around the middle it gets sparse.\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Let's move forward and try to these techiques to recent CTF challenges.\"\n    }), \"\\n\", _jsx(_components.h1, {\n      children: \"Applying to recent CTF challenges\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"In the following two CTF challenges, we will try both the techniques that worked well for us in the previous sections.\\nThe navie gradient descent and PGD (following the sign of the gradient).\\nFSGM will be able to generate an adversarial example but will not be able to solve the challenge alone in these cases.\"\n    }), \"\\n\", _jsx(\"br\", {}), \"\\n\", _jsxs(Challenge, {\n      competition: \"DiceCTF 2024 Quals\",\n      competitionLink: \"https://ctftime.org/event/2217/\",\n      challenge: \"what-a-jpeg-is\",\n      author: \"ireland\",\n      category: \"misc\",\n      solves: \"6\",\n      points: \"396\",\n      children: [_jsx(_components.p, {\n        children: \"I just want a picture of a god-dang Madagascar cat\"\n      }), _jsx(\"pre\", {\n        className: \"bg-gray-900\",\n        children: \"nc mc.ax 31373\"\n      })]\n    }), \"\\n\", _jsx(\"br\", {}), \"\\n\", _jsx(_components.p, {\n      children: \"Let's start by looking at the code (partially shown):\"\n    }), \"\\n\", _jsx(_components.pre, {\n      className: \"language-python\",\n      children: _jsxs(_components.code, {\n        className: \"language-python code-highlight\",\n        children: [_jsxs(_components.span, {\n          className: \"code-line\",\n          children: [_jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"def\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token function\",\n            children: \"pytorch_jpeg_compress\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"img_tensors\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    out_tensors \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"[\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"]\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    \", _jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"for\"\n          }), \" img_tensor \", _jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"in\"\n          }), \" img_tensors\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"        quality \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" np\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"random\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"randint\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"50\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"90\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"        img \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" Image\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"fromarray\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"            \", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"                np\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"clip\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"img_tensor\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"cpu\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"numpy\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"swapaxes\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"1\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"swapaxes\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"1\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"2\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"1\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"*\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"255\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"            \", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"astype\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"np\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"uint8\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"        \", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsx(_components.span, {\n          className: \"code-line\",\n          children: \"\\n\"\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"        \", _jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"with\"\n          }), \" io\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"BytesIO\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"as\"\n          }), \" f\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"            img\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"save\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"f\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token string\",\n            children: \"\\\"JPEG\\\"\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" quality\", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \"quality\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"            img \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" Image\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), _jsx(_components.span, {\n            className: \"token builtin\",\n            children: \"open\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"io\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"BytesIO\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"f\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"getvalue\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsx(_components.span, {\n          className: \"code-line\",\n          children: \"\\n\"\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"        out_tensor \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" torch\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"tensor\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"            np\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"array\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"img\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"swapaxes\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"2\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"1\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"swapaxes\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"1\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"/\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"255\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"            device\", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \"img_tensor\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"device\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"            dtype\", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \"torch\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"float32\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"        \", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"        out_tensors\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"append\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"out_tensor\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    out_tensors \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" torch\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"stack\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"out_tensors\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    \", _jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"return\"\n          }), \" out_tensors\\n\"]\n        }), _jsx(_components.span, {\n          className: \"code-line\",\n          children: \"\\n\"\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"model \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"np_original \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"\\n\"]\n        }), _jsx(_components.span, {\n          className: \"code-line\",\n          children: \"\\n\"\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"openmybook \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" T\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"ToTensor\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"normalize \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" T\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"Normalize\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"[\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.485\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.456\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.406\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"]\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"[\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.229\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.224\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.225\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"]\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"reading_glasses \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" T\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"RandomResizedCrop\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"384\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" antialias\", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), _jsx(_components.span, {\n            className: \"token boolean\",\n            children: \"True\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsx(_components.span, {\n          className: \"code-line\",\n          children: \"\\n\"\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [_jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"for\"\n          }), \" target_id \", _jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"in\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token builtin\",\n            children: \"range\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"383\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"388\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"+\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"1\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    breed \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" model\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"config\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"id2label\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"[\"\n          }), \"target_id\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"]\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"split\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token string\",\n            children: \"\\\",\\\"\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"[\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"]\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    inp \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token builtin\",\n            children: \"input\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsxs(_components.span, {\n            className: \"token string-interpolation\",\n            children: [_jsx(_components.span, {\n              className: \"token string\",\n              children: \"f\\\"I love cats! My favorite breed is \"\n            }), _jsxs(_components.span, {\n              className: \"token interpolation\",\n              children: [_jsx(_components.span, {\n                className: \"token punctuation\",\n                children: \"{\"\n              }), \"breed\", _jsx(_components.span, {\n                className: \"token punctuation\",\n                children: \"}\"\n              })]\n            }), _jsx(_components.span, {\n              className: \"token string\",\n              children: \". Can you show me a picture of one?\\\\n\\\"\"\n            })]\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    \", _jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"try\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"        np_breed \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" np\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"frombuffer\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"base64\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"standard_b64decode\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"inp\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" dtype\", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \"np\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"uint8\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"        np_breed \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" np_breed\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"reshape\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"np_original\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"shape\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"        \", _jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"assert\"\n          }), \" np\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), _jsx(_components.span, {\n            className: \"token builtin\",\n            children: \"max\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"np\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), _jsx(_components.span, {\n            className: \"token builtin\",\n            children: \"abs\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"np_original\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"astype\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token builtin\",\n            children: \"int\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"-\"\n          }), \" np_breed\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"astype\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token builtin\",\n            children: \"int\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"\u003c\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"10\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    \", _jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"except\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"        \", _jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"print\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token string\",\n            children: \"\\\"Sorry I only like cats that look exactly like my cat!\\\"\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" flush\", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), _jsx(_components.span, {\n            className: \"token boolean\",\n            children: \"True\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"        sys\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"exit\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsx(_components.span, {\n          className: \"code-line\",\n          children: \"\\n\"\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    \", _jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"for\"\n          }), \" i \", _jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"in\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token builtin\",\n            children: \"range\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"3\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \"\\n\"]\n        }), _jsx(_components.span, {\n          className: \"code-line\",\n          children: \"\\n\"\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"        image \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" Image\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"fromarray\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"np_breed\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"astype\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"np\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"uint8\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"        x \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" openmybook\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"image\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token comment\",\n            children: \"# ToTensor\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"        x \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" x\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"unsqueeze\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"        x \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" pytorch_jpeg_compress\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"x\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token comment\",\n            children: \"# RandomCompress\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"        x \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" normalize\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"x\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token comment\",\n            children: \"# ImageNet normalization\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"        x \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" reading_glasses\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"x\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token comment\",\n            children: \"# RandomResizedCrop\"\n          }), \"\\n\"]\n        }), _jsx(_components.span, {\n          className: \"code-line\",\n          children: \"\\n\"\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"        \", _jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"with\"\n          }), \" torch\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"no_grad\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"            logits \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" model\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"x\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"logits\\n\"]\n        }), _jsx(_components.span, {\n          className: \"code-line\",\n          children: \"\\n\"\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"        \", _jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"if\"\n          }), \" torch\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"argmax\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"logits\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"item\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"!=\"\n          }), \" target_id\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"            \", _jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"print\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsxs(_components.span, {\n            className: \"token string-interpolation\",\n            children: [_jsx(_components.span, {\n              className: \"token string\",\n              children: \"f\\\"That doesn't look like a \"\n            }), _jsxs(_components.span, {\n              className: \"token interpolation\",\n              children: [_jsx(_components.span, {\n                className: \"token punctuation\",\n                children: \"{\"\n              }), \"breed\", _jsx(_components.span, {\n                className: \"token punctuation\",\n                children: \"}\"\n              })]\n            }), _jsx(_components.span, {\n              className: \"token string\",\n              children: \"!\\\"\"\n            })]\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"            sys\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"exit\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsx(_components.span, {\n          className: \"code-line\",\n          children: \"\\n\"\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [_jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"with\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token builtin\",\n            children: \"open\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token string\",\n            children: \"\\\"flag.txt\\\"\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"as\"\n          }), \" f\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    \", _jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"print\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"f\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"read\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        })]\n      })\n    }), \"\\n\", _jsxs(\"p\", {\n      className: \"mr-4 subtext\",\n      style: {\n        fontSize: '0.75rem'\n      },\n      children: [\"full code: \", _jsx(_components.a, {\n        href: \"https://github.com/dicegang/dicectf-quals-2024-challenges/blob/main/misc/what-a-jpeg-is/challenge/challenge.py\",\n        children: \"https://github.com/dicegang/dicectf-quals-2024-challenges/blob/main/misc/what-a-jpeg-is/challenge/challenge.py\"\n      })]\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"A couple of things to note:\"\n    }), \"\\n\", _jsxs(_components.ul, {\n      children: [\"\\n\", _jsxs(_components.li, {\n        children: [\"The adversarial example needs to be within \", _jsxs(_components.strong, {\n          children: [_jsx(_components.code, {\n            className: \"language-math math-inline\",\n            children: _jsxs(_components.span, {\n              className: \"katex\",\n              children: [_jsx(_components.span, {\n                className: \"katex-mathml\",\n                children: _jsx(_components.math, {\n                  xmlns: \"http://www.w3.org/1998/Math/MathML\",\n                  children: _jsxs(_components.semantics, {\n                    children: [_jsx(_components.mrow, {\n                      children: _jsx(_components.mn, {\n                        children: \"9\"\n                      })\n                    }), _jsx(_components.annotation, {\n                      encoding: \"application/x-tex\",\n                      children: \"9\"\n                    })]\n                  })\n                })\n              }), _jsx(_components.span, {\n                className: \"katex-html\",\n                \"aria-hidden\": \"true\",\n                children: _jsxs(_components.span, {\n                  className: \"base\",\n                  children: [_jsx(_components.span, {\n                    className: \"strut\",\n                    style: {\n                      height: \"0.6444em\"\n                    }\n                  }), _jsx(_components.span, {\n                    className: \"mord\",\n                    children: \"9\"\n                  })]\n                })\n              })]\n            })\n          }), \" pixels\"]\n        }), \" of the original image.\"]\n      }), \"\\n\", _jsxs(_components.li, {\n        children: [\"The adversarial example needs to be robust to \", _jsx(_components.strong, {\n          children: \"JPEG compression\"\n        }), \", \", _jsx(_components.strong, {\n          children: \"random crops\"\n        }), \", and \", _jsx(_components.strong, {\n          children: \"resizing\"\n        }), \".\"]\n      }), \"\\n\", _jsxs(_components.li, {\n        children: [\"We need to generate 5 \", _jsx(_components.strong, {\n          children: \"confident\"\n        }), \" adversarial examples in a row (we can't just get lucky on one).\"]\n      }), \"\\n\"]\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"We already know how we can generate a \", _jsx(_components.strong, {\n        children: \"confident\"\n      }), \" adversarial example through iterative training, methods like FSGM won't work for us here.\\nGenerating robust examples will be the real challenge.\"]\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"We can apply the same augmentations during each iteration loop and apply the gradients slowly until we each the final image. This will create a both a confident and robust adversarial example. The only problem here is that JPEG lossy image encoding is non-differentiable, we can't simply use it out of the box for backward propagation.\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"After some research it looks like there's already some papers that tackle the same problem:\"\n    }), \"\\n\", _jsxs(_components.ul, {\n      children: [\"\\n\", _jsxs(_components.li, {\n        children: [_jsx(_components.a, {\n          href: \"https://arxiv.org/abs/2309.06978\",\n          children: \"Reich, Christoph, et al. \\\"Differentiable jpeg: The devil is in the details.\\\" 2024.\"\n        }), \" \", _jsx(_components.a, {\n          href: \"https://github.com/necla-ml/Diff-JPEG\",\n          children: \"(Code)\"\n        })]\n      }), \"\\n\", _jsxs(_components.li, {\n        children: [_jsx(_components.a, {\n          href: \"https://machine-learning-and-security.github.io/papers/mlsec17_paper_54.pdf\",\n          children: \"Shin, Richard, and Dawn Song. \\\"Jpeg-resistant adversarial images.\\\" 2017.\"\n        }), \" \", _jsx(_components.a, {\n          href: \"https://github.com/mlomnitz/DiffJPEG\",\n          children: \"(Code)\"\n        })]\n      }), \"\\n\"]\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"When I was doing the challenge, I only found the 2017 paper and their codea but the challenge probably could be solved with either (I actually later found out that since quality isn't drastic, it is possible to solve by ignoring the JPEG compression entirely).\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Let's try to do both iterative methods (simple gradient following and following the sign of the gradient).\"\n    }), \"\\n\", _jsx(_components.pre, {\n      className: \"language-python\",\n      children: _jsxs(_components.code, {\n        className: \"language-python code-highlight\",\n        children: [_jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"n_iterations \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"100\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"target_output \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" torch\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"tensor\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"[\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"383\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"]\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" dtype\", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \"torch\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), _jsx(_components.span, {\n            className: \"token builtin\",\n            children: \"long\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" device\", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \"device\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token comment\",\n            children: \"# do the same for 383 - 388\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"eps \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"8.\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"/\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"255.\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token comment\",\n            children: \"# perturbation size, set lower than needed for rounding errors\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"bs \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"8\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token comment\",\n            children: \"# batch size - not really needed, but stabilizes training and improves convergence \u0026 consistency of adversarial examples\"\n          }), \"\\n\"]\n        }), _jsx(_components.span, {\n          className: \"code-line\",\n          children: \"\\n\"\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"x \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" img_original_tensor\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"clone\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"x\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"requires_grad \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token boolean\",\n            children: \"True\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [_jsx(_components.span, {\n            className: \"token comment\",\n            children: \"# helps as each forward pass is different, helps stabilize training\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [_jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"def\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token function\",\n            children: \"forward\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"x\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    x \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" differentiable_jpeg\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"x\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" random\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"randint\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"50\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"90\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token comment\",\n            children: \"# check the full code\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    x \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" normalize\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"x\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    x \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" random_crop\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"x\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    x \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" model\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"x\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"logits\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    \", _jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"return\"\n          }), \" x\\n\"]\n        }), _jsx(_components.span, {\n          className: \"code-line\",\n          children: \"\\n\"\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [_jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"for\"\n          }), \" iteration \", _jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"in\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token builtin\",\n            children: \"range\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"n_iterations\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    optimizer\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"zero_grad\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsx(_components.span, {\n          className: \"code-line\",\n          children: \"    \\n\"\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    logits \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" forward\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"torch\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"cat\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"[\"\n          }), \"x\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"]\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"*\"\n          }), \" bs\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" dim\", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    loss \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" loss_func\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"logits\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" torch\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"cat\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"[\"\n          }), \"target_output\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"]\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"*\"\n          }), \" bs\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" dim\", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    loss\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"backward\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsx(_components.span, {\n          className: \"code-line\",\n          children: \"\\n\"\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    optimizer\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"step\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsx(_components.span, {\n          className: \"code-line\",\n          children: \"\\n\"\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    x\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"data \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" torch\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"clamp\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"x\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"data\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" img_original_tensor \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"-\"\n          }), \" eps\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" img_original_tensor \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"+\"\n          }), \" eps\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        })]\n      })\n    }), \"\\n\", _jsxs(\"p\", {\n      className: \"mr-4 subtext\",\n      style: {\n        fontSize: '0.75rem'\n      },\n      children: [\"full code: \", _jsx(_components.a, {\n        href: \"https://github.com/OutWrest/blog-handouts/blob/main/exploring-attacks-1/what-jpeg-is-DiceCTF-2024.ipynb\",\n        children: \"https://github.com/OutWrest/blog-handouts/blob/main/exploring-attacks-1/what-jpeg-is-DiceCTF-2024.ipynb\"\n      })]\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Output:\"\n    }), \"\\n\", _jsx(_components.pre, {\n      className: \"language-bash\",\n      children: _jsxs(_components.code, {\n        className: \"language-bash code-highlight\",\n        children: [_jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"Iter: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0\"\n          }), \"    \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Loss:  \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"8.5492\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Pred: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"281\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"54.20\"\n          }), \"%\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" min/mean/max diff: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.00\"\n          }), \"/1.44/3.00\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"Iter: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"10\"\n          }), \"   \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Loss:  \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.2835\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Pred: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"383\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"75.32\"\n          }), \"%\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" min/mean/max diff: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.00\"\n          }), \"/5.35/9.00\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"Iter: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"20\"\n          }), \"   \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Loss:  \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.1862\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Pred: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"383\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"83.01\"\n          }), \"%\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" min/mean/max diff: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.00\"\n          }), \"/6.11/9.00\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"Iter: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"30\"\n          }), \"   \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Loss:  \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.1670\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Pred: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"383\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"84.62\"\n          }), \"%\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" min/mean/max diff: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.00\"\n          }), \"/6.17/9.00\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"Iter: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"40\"\n          }), \"   \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Loss:  \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.4805\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Pred: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"383\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"61.85\"\n          }), \"%\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" min/mean/max diff: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.00\"\n          }), \"/6.03/9.00\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"Iter: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"50\"\n          }), \"   \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Loss:  \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.1488\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Pred: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"383\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"86.17\"\n          }), \"%\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" min/mean/max diff: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.00\"\n          }), \"/6.14/9.00\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"Iter: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"60\"\n          }), \"   \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Loss:  \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.0966\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Pred: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"383\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"90.80\"\n          }), \"%\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" min/mean/max diff: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.00\"\n          }), \"/6.15/9.00\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"Iter: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"70\"\n          }), \"   \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Loss:  \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.1279\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Pred: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"383\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"88.00\"\n          }), \"%\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" min/mean/max diff: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.00\"\n          }), \"/6.10/9.00\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"Iter: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"80\"\n          }), \"   \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Loss:  \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.0514\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Pred: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"383\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"94.99\"\n          }), \"%\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" min/mean/max diff: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.00\"\n          }), \"/6.08/9.00\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"Iter: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"90\"\n          }), \"   \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Loss:  \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.0598\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Pred: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"383\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"94.19\"\n          }), \"%\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" min/mean/max diff: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.00\"\n          }), \"/6.09/9.00\\n\"]\n        })]\n      })\n    }), \"\\n\", _jsxs(\"div\", {\n      className: \"flex items-center justify-center flex-col\",\n      children: [_jsx(\"img\", {\n        className: \"block\",\n        src: \"/post-assets/exploring-attacks-1/what-is-jpeg-is-DiceCTF-2024-simple.png\",\n        alt: \"Three images that showcase the adversarial attack.\"\n      }), _jsx(\"p\", {\n        className: \"mr-4 subtext\",\n        style: {\n          fontSize: '0.75rem'\n        },\n        children: \"The output adversarial example on provided image using a simple iterative method.\"\n      })]\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"With only \", _jsx(_components.code, {\n        className: \"language-math math-inline\",\n        children: _jsxs(_components.span, {\n          className: \"katex\",\n          children: [_jsx(_components.span, {\n            className: \"katex-mathml\",\n            children: _jsx(_components.math, {\n              xmlns: \"http://www.w3.org/1998/Math/MathML\",\n              children: _jsxs(_components.semantics, {\n                children: [_jsx(_components.mrow, {\n                  children: _jsx(_components.mn, {\n                    children: \"100\"\n                  })\n                }), _jsx(_components.annotation, {\n                  encoding: \"application/x-tex\",\n                  children: \"100\"\n                })]\n              })\n            })\n          }), _jsx(_components.span, {\n            className: \"katex-html\",\n            \"aria-hidden\": \"true\",\n            children: _jsxs(_components.span, {\n              className: \"base\",\n              children: [_jsx(_components.span, {\n                className: \"strut\",\n                style: {\n                  height: \"0.6444em\"\n                }\n              }), _jsx(_components.span, {\n                className: \"mord\",\n                children: \"100\"\n              })]\n            })\n          })]\n        })\n      }), \" iterations, we easily were able to start making confident adversarial examples.\\nLet's try out PGD and see if we able to get better results.\"]\n    }), \"\\n\", _jsx(_components.pre, {\n      className: \"language-python\",\n      children: _jsxs(_components.code, {\n        className: \"language-python code-highlight\",\n        children: [_jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"n_iterations \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"100\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"target_output \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" torch\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"tensor\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"[\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"383\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"]\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" dtype\", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \"torch\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), _jsx(_components.span, {\n            className: \"token builtin\",\n            children: \"long\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" device\", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \"device\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token comment\",\n            children: \"# do the same for 383 - 388\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"eps \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"8.\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"/\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"255.\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token comment\",\n            children: \"# perturbation size, set lower than needed for rounding errors\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"bs \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"8\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token comment\",\n            children: \"# batch size - not really needed, but stabilizes training and improves convergence \u0026 consistency of adversarial examples\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"alpha \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \".5\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"/\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"255.\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token comment\",\n            children: \"# step size\"\n          }), \"\\n\"]\n        }), _jsx(_components.span, {\n          className: \"code-line\",\n          children: \"\\n\"\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"x \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" img_original_tensor\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"clone\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"x\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"requires_grad \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token boolean\",\n            children: \"True\"\n          }), \"\\n\"]\n        }), _jsx(_components.span, {\n          className: \"code-line\",\n          children: \"\\n\"\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"loss_func \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" torch\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"nn\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"CrossEntropyLoss\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsx(_components.span, {\n          className: \"code-line\",\n          children: \"\\n\"\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [_jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"def\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token function\",\n            children: \"forward\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"x\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    x \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" differentiable_jpeg\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"x\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" random\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"randint\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"50\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"90\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    x \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" normalize\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"x\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    x \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" random_crop\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"x\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    x \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" model\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"x\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"logits\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    \", _jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"return\"\n          }), \" x\\n\"]\n        }), _jsx(_components.span, {\n          className: \"code-line\",\n          children: \"\\n\"\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [_jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"for\"\n          }), \" iteration \", _jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"in\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token builtin\",\n            children: \"range\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"n_iterations\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    optimizer\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"zero_grad\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsx(_components.span, {\n          className: \"code-line\",\n          children: \"    \\n\"\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    logits \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" forward\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"torch\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"cat\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"[\"\n          }), \"x\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"]\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"*\"\n          }), \" bs\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" dim\", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token comment\",\n            children: \"# helps as each forward pass is different, helps stabilize training\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    loss \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" loss_func\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"logits\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" torch\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"cat\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"[\"\n          }), \"target_output\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"]\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"*\"\n          }), \" bs\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" dim\", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsx(_components.span, {\n          className: \"code-line\",\n          children: \"    \\n\"\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    grad \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" torch\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"autograd\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"grad\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"loss\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" x\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"[\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"]\"\n          }), \"\\n\"]\n        }), _jsx(_components.span, {\n          className: \"code-line\",\n          children: \"    \\n\"\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    x\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"data \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" x\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"data \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"-\"\n          }), \" alpha \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"*\"\n          }), \" torch\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"sign\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"grad\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    x\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"data \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" torch\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"clamp\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"x\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"data\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" img_original_tensor \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"-\"\n          }), \" eps\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" img_original_tensor \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"+\"\n          }), \" eps\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        })]\n      })\n    }), \"\\n\", _jsxs(\"p\", {\n      className: \"mr-4 subtext\",\n      style: {\n        fontSize: '0.75rem'\n      },\n      children: [\"full code: \", _jsx(_components.a, {\n        href: \"https://github.com/OutWrest/blog-handouts/blob/main/exploring-attacks-1/what-jpeg-is-DiceCTF-2024.ipynb\",\n        children: \"https://github.com/OutWrest/blog-handouts/blob/main/exploring-attacks-1/what-jpeg-is-DiceCTF-2024.ipynb\"\n      })]\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Output:\"\n    }), \"\\n\", _jsx(_components.pre, {\n      className: \"language-bash\",\n      children: _jsxs(_components.code, {\n        className: \"language-bash code-highlight\",\n        children: [_jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"Iter: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0\"\n          }), \"    \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Loss:  \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"9.8105\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Pred: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"281\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"48.51\"\n          }), \"%\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" min/mean/max diff: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.00\"\n          }), \"/0.06/1.00\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"Iter: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"10\"\n          }), \"   \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Loss:  \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"4.3521\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Pred: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"281\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"40.86\"\n          }), \"%\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" min/mean/max diff: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.00\"\n          }), \"/0.87/5.00\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"Iter: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"20\"\n          }), \"   \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Loss:  \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"5.0837\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Pred: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"281\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"35.09\"\n          }), \"%\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" min/mean/max diff: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.00\"\n          }), \"/1.42/8.00\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"Iter: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"30\"\n          }), \"   \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Loss:  \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.6920\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Pred: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"383\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"50.06\"\n          }), \"%\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" min/mean/max diff: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.00\"\n          }), \"/1.82/9.00\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"Iter: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"40\"\n          }), \"   \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Loss:  \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.1363\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Pred: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"383\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"87.25\"\n          }), \"%\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" min/mean/max diff: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.00\"\n          }), \"/2.05/9.00\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"Iter: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"50\"\n          }), \"   \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Loss:  \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.0625\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Pred: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"383\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"93.94\"\n          }), \"%\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" min/mean/max diff: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.00\"\n          }), \"/2.22/9.00\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"Iter: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"60\"\n          }), \"   \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Loss:  \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.0259\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Pred: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"383\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"97.44\"\n          }), \"%\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" min/mean/max diff: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.00\"\n          }), \"/2.46/9.00\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"Iter: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"70\"\n          }), \"   \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Loss:  \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"5.2534\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Pred: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"281\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"27.16\"\n          }), \"%\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" min/mean/max diff: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.00\"\n          }), \"/2.70/9.00\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"Iter: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"80\"\n          }), \"   \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Loss:  \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.0133\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Pred: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"383\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"98.68\"\n          }), \"%\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" min/mean/max diff: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.00\"\n          }), \"/2.89/9.00\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"Iter: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"90\"\n          }), \"   \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Loss:  \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.0045\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Pred: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"383\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"99.55\"\n          }), \"%\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" min/mean/max diff: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.00\"\n          }), \"/3.13/9.00\\n\"]\n        })]\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"PDG is able generate more confident examples at a lesser perturbation difference. Please check out the full code listed above, it should be all reproducible.\"\n    }), \"\\n\", _jsxs(\"div\", {\n      className: \"flex items-center justify-center flex-col\",\n      children: [_jsx(\"img\", {\n        className: \"block\",\n        src: \"/post-assets/exploring-attacks-1/what-is-jpeg-is-DiceCTF-2024-pgd.png\",\n        alt: \"Three images that showcase the adversarial attack.\"\n      }), _jsx(\"p\", {\n        className: \"mr-4 subtext\",\n        style: {\n          fontSize: '0.75rem'\n        },\n        children: \"The output adversarial example on provided image using PGD.\"\n      })]\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"To solve the rest the challenge, we just need to do this 5 more times and try them out remote machine.\\nI do not have the full solve code here but you can easily extend the scripts I have provided to do so.\"\n    }), \"\\n\", _jsx(\"br\", {}), \"\\n\", _jsxs(Challenge, {\n      competition: \"osu!gaming CTF 2024\",\n      competitionLink: \"https://ctftime.org/event/2165/\",\n      challenge: \"i-hate-anime-girls\",\n      author: \"segal\",\n      category: \"misc\",\n      solves: \"6\",\n      points: \"396\",\n      children: [_jsx(_components.p, {\n        children: \"osu! players love their anime girls. But I HATE anime girls. So much so that I trained a neural network to filter my map backgrounds.\\nBut tbh, I really want to pp farm hitorigoto and my map filter won't let me. Can you fool it?\"\n      }), _jsx(\"pre\", {\n        className: \"bg-gray-900\",\n        children: \"nc chal.osugaming.lol 7274\"\n      })]\n    }), \"\\n\", _jsx(\"br\", {}), \"\\n\", _jsxs(_components.p, {\n      children: [\"This challenge comes with 3 different files, \", _jsx(_components.code, {\n        children: \"hitorigoto.png\"\n      }), \", \", _jsx(_components.code, {\n        children: \"model.pt\"\n      }), \", and \", _jsx(_components.code, {\n        children: \"server.py\"\n      }), \". Let's explore the code first to figure out how to get the flag.\"]\n    }), \"\\n\", _jsx(_components.pre, {\n      className: \"language-python\",\n      children: _jsxs(_components.code, {\n        className: \"language-python code-highlight\",\n        children: [_jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"model \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" resnet18\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"model\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"fc \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" nn\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"Linear\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"model\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"fc\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"in_features\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"1\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"model\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"load_state_dict\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"torch\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"load\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token string\",\n            children: \"\\\"model.pt\\\"\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsx(_components.span, {\n          className: \"code-line\",\n          children: \"\\n\"\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"resize \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" T\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"Resize\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"224\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"224\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" antialias\", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), _jsx(_components.span, {\n            className: \"token boolean\",\n            children: \"None\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"to_tensor \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" T\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"ToTensor\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"normalize \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" T\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"Normalize\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"[\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.485\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.456\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.406\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"]\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"[\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.229\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.224\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.225\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"]\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsx(_components.span, {\n          className: \"code-line\",\n          children: \"\\n\"\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"original \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" np\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"array\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"Image\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), _jsx(_components.span, {\n            className: \"token builtin\",\n            children: \"open\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token string\",\n            children: \"\\\"hitorigoto.png\\\"\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsx(_components.span, {\n          className: \"code-line\",\n          children: \"\\n\"\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"inp \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token builtin\",\n            children: \"input\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token string-interpolation\",\n            children: _jsx(_components.span, {\n              className: \"token string\",\n              children: \"f\\\"Enter a base64 encoded image.\\\\n\\\"\"\n            })\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [_jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"try\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    img \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" np\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"frombuffer\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"base64\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"standard_b64decode\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"inp\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" dtype\", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \"np\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"uint8\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    img \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" img\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"reshape\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"original\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"shape\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    \", _jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"assert\"\n          }), \" np\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), _jsx(_components.span, {\n            className: \"token builtin\",\n            children: \"max\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"np\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), _jsx(_components.span, {\n            className: \"token builtin\",\n            children: \"abs\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"original\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"astype\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"np\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"int32\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"-\"\n          }), \" img\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"astype\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"np\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"int32\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"\u003c=\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"8\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [_jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"except\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    \", _jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"print\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token string\",\n            children: \"\\\"That doesn't look like hitorigoto!\\\"\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    sys\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"exit\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsx(_components.span, {\n          className: \"code-line\",\n          children: \"\\n\"\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"image \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" Image\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"fromarray\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"img\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"x \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" normalize\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"resize\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"to_tensor\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"image\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"unsqueeze\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [_jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"with\"\n          }), \" torch\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"no_grad\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    y \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" torch\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"sigmoid\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"model\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"x\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsx(_components.span, {\n          className: \"code-line\",\n          children: \"\\n\"\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [_jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"if\"\n          }), \" y \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"\u003c\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.5\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    \", _jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"print\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token string\",\n            children: \"\\\"That's obviously an anime girl.\\\"\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    sys\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"exit\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [_jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"elif\"\n          }), \" y \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"\u003c\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.825\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    \", _jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"print\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token string\",\n            children: \"\\\"I'm not fully convinced that's not an anime girl.\\\"\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    sys\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"exit\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsx(_components.span, {\n          className: \"code-line\",\n          children: \"\\n\"\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [_jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"with\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token builtin\",\n            children: \"open\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token string\",\n            children: \"\\\"flag.txt\\\"\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"as\"\n          }), \" f\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    \", _jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"print\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token string\",\n            children: \"\\\"Surely that's not an anime girl.\\\"\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    \", _jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"print\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"f\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"read\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        })]\n      })\n    }), \"\\n\", _jsxs(\"p\", {\n      className: \"mr-4 subtext\",\n      style: {\n        fontSize: '0.75rem'\n      },\n      children: [\"full code: \", _jsx(_components.a, {\n        href: \"https://drive.google.com/file/d/1qqJ2xrlrvppz50bjAzmfhpX66Y-UkqnM/view\",\n        children: \"https://drive.google.com/file/d/1qqJ2xrlrvppz50bjAzmfhpX66Y-UkqnM/view\"\n      })]\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"The whole point of this challenge seems to be able to create a confident (\u003e82.5% confidence) adversarial example from the given image that is able to be resistant against the resizing.\\nWe already know how to do this, but this challenge posed a problem for me initially. I was getting very inconsistent results.\\nI found out the challenge author left \", _jsx(_components.code, {\n        children: \".eval()\"\n      }), \" in the code.\\nThis left the current model in training mode. For us, this just means that it will be harder to generate adversarial example because the batch normalization layers won't be applied to our input.\"]\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Let's try the same two methods in the previous challenge on this one.\"\n    }), \"\\n\", _jsx(_components.pre, {\n      className: \"language-python\",\n      children: _jsxs(_components.code, {\n        className: \"language-python code-highlight\",\n        children: [_jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"n_iterations \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"1250\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"eps \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"7.\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"/\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"255.\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"bs \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"32\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token comment\",\n            children: \"# not needed\"\n          }), \"\\n\"]\n        }), _jsx(_components.span, {\n          className: \"code-line\",\n          children: \"\\n\"\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"x \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" img_original_tensor\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"clone\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"detach\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"requires_grad_\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token boolean\",\n            children: \"True\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsx(_components.span, {\n          className: \"code-line\",\n          children: \"\\n\"\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [_jsx(_components.span, {\n            className: \"token comment\",\n            children: \"# made use of lr_scheduler to reduce the learning rate when the loss stops decreasing\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [_jsx(_components.span, {\n            className: \"token comment\",\n            children: \"# this helps model converge as this problem is hard to optimize\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"optimizer \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" torch\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"optim\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"Adam\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"[\"\n          }), \"x\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"]\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" lr\", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"5e-1\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token comment\",\n            children: \"# we will only optimize the input image\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"lr_scheduler \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" torch\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"optim\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"lr_scheduler\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"ReduceLROnPlateau\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"optimizer\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" patience\", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"50\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" verbose\", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), _jsx(_components.span, {\n            className: \"token boolean\",\n            children: \"True\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" factor\", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.5\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"loss_func \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" nn\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"BCEWithLogitsLoss\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsx(_components.span, {\n          className: \"code-line\",\n          children: \"\\n\"\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [_jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"def\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token function\",\n            children: \"forward\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"x\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    x \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" resize\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"x\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    x \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" normalize\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"x\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    x \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" model\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"x\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    \", _jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"return\"\n          }), \" x\\n\"]\n        }), _jsx(_components.span, {\n          className: \"code-line\",\n          children: \"\\n\"\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [_jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"for\"\n          }), \" iteration \", _jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"in\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token builtin\",\n            children: \"range\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"n_iterations\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    optimizer\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"zero_grad\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsx(_components.span, {\n          className: \"code-line\",\n          children: \"\\n\"\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    logits \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" forward\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"torch\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"cat\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"[\"\n          }), \"x\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"]\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"*\"\n          }), \" bs\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" dim\", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token comment\",\n            children: \"# bs not needed\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    loss \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" loss_func\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"logits\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" torch\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"ones_like\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"logits\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token comment\",\n            children: \"# maximize the output of the model\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    loss\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"backward\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsx(_components.span, {\n          className: \"code-line\",\n          children: \"\\n\"\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    optimizer\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"step\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsx(_components.span, {\n          className: \"code-line\",\n          children: \"\\n\"\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    lr_scheduler\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"step\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"loss\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsx(_components.span, {\n          className: \"code-line\",\n          children: \"\\n\"\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    x\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"data \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" torch\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"clamp\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"x\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"data\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" img_original_tensor \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"-\"\n          }), \" eps\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" img_original_tensor \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"+\"\n          }), \" eps\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        })]\n      })\n    }), \"\\n\", _jsxs(\"p\", {\n      className: \"mr-4 subtext\",\n      style: {\n        fontSize: '0.75rem'\n      },\n      children: [\"full code: \", _jsx(_components.a, {\n        href: \"https://github.com/OutWrest/blog-handouts/blob/main/exploring-attacks-1/i-hate-anime-girls-osugaming-2024.ipynb\",\n        children: \"https://github.com/OutWrest/blog-handouts/blob/main/exploring-attacks-1/i-hate-anime-girls-osugaming-2024.ipynb\"\n      })]\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Output:\"\n    }), \"\\n\", _jsx(_components.pre, {\n      className: \"language-bash\",\n      children: _jsxs(_components.code, {\n        className: \"language-bash code-highlight\",\n        children: [_jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"Iter: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0\"\n          }), \"    \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Loss:  \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"2.0104\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Pred:  \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.1339\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" min/mean/max diff: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.00\"\n          }), \"/4.80/8.00\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"Iter: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"62\"\n          }), \"   \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Loss:  \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.8145\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Pred:  \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.4429\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" min/mean/max diff: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.00\"\n          }), \"/4.46/8.00\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"Iter: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"124\"\n          }), \"  \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Loss:  \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.7141\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Pred:  \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.4896\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" min/mean/max diff: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.00\"\n          }), \"/4.50/8.00\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"Iter: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"186\"\n          }), \"  \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Loss:  \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.4650\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Pred:  \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.6282\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" min/mean/max diff: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.00\"\n          }), \"/4.40/8.00\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"Iter: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"248\"\n          }), \"  \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Loss:  \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.4427\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Pred:  \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.6423\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" min/mean/max diff: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.00\"\n          }), \"/4.45/8.00\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"Iter: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"310\"\n          }), \"  \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Loss:  \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.3205\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Pred:  \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.7258\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" min/mean/max diff: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.00\"\n          }), \"/4.26/8.00\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"Iter: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"372\"\n          }), \"  \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Loss:  \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.3281\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Pred:  \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.7203\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" min/mean/max diff: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.00\"\n          }), \"/4.12/8.00\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"Iter: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"434\"\n          }), \"  \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Loss:  \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.2920\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Pred:  \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.7468\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" min/mean/max diff: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.00\"\n          }), \"/3.94/8.00\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"Iter: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"496\"\n          }), \"  \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Loss:  \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.2534\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Pred:  \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.7762\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" min/mean/max diff: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.00\"\n          }), \"/3.69/8.00\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"Iter: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"558\"\n          }), \"  \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Loss:  \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.1844\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Pred:  \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.8316\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" min/mean/max diff: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.00\"\n          }), \"/3.61/8.00\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"Iter: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"620\"\n          }), \"  \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Loss:  \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.1768\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Pred:  \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.8380\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" min/mean/max diff: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.00\"\n          }), \"/3.63/8.00\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"Iter: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"682\"\n          }), \"  \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Loss:  \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.1810\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Pred:  \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.8344\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" min/mean/max diff: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.00\"\n          }), \"/3.67/8.00\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"Iter: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"744\"\n          }), \"  \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Loss:  \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.1501\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Pred:  \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.8606\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" min/mean/max diff: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.00\"\n          }), \"/3.66/8.00\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"Iter: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"806\"\n          }), \"  \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Loss:  \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.1472\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Pred:  \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.8631\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" min/mean/max diff: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.00\"\n          }), \"/3.66/8.00\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"Iter: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"868\"\n          }), \"  \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Loss:  \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.1463\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Pred:  \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.8639\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" min/mean/max diff: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.00\"\n          }), \"/3.68/7.00\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"Iter: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"930\"\n          }), \"  \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Loss:  \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.1309\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Pred:  \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.8773\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" min/mean/max diff: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.00\"\n          }), \"/3.68/8.00\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"Iter: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"992\"\n          }), \"  \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Loss:  \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.1298\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Pred:  \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.8783\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" min/mean/max diff: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.00\"\n          }), \"/3.67/8.00\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"Iter: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"1054\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Loss:  \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.1285\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Pred:  \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.8794\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" min/mean/max diff: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.00\"\n          }), \"/3.68/8.00\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"Iter: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"1116\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Loss:  \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.1282\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Pred:  \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.8796\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" min/mean/max diff: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.00\"\n          }), \"/3.70/8.00\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"Iter: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"1178\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Loss:  \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.1210\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Pred:  \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.8860\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" min/mean/max diff: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.00\"\n          }), \"/3.70/7.00\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"Iter: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"1240\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Loss:  \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.1207\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Pred:  \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.8863\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" min/mean/max diff: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.00\"\n          }), \"/3.70/7.00\\n\"]\n        })]\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"We had to use some tricks to generate an examples that is able to be confident enough for the flag.\\nI had to apply a learning rate scheduler that would reduce the step size by half if it doesn't improve after 50 iterations.\"\n    }), \"\\n\", _jsxs(\"div\", {\n      className: \"flex items-center justify-center flex-col\",\n      children: [_jsx(\"img\", {\n        className: \"block\",\n        src: \"/post-assets/exploring-attacks-1/i-hate-anime-girls-osugaming-2024-simple.png\",\n        alt: \"Three images that showcase the adversarial attack.\"\n      }), _jsx(\"p\", {\n        className: \"mr-4 subtext\",\n        style: {\n          fontSize: '0.75rem'\n        },\n        children: \"The output adversarial example on provided image using a simple iterative method.\"\n      })]\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"The difference map shows something very interesting with vertical lines spread throughout. I think this is an artifact of optimizing before the resizing operation.\\nLet's try the PGD and see if it does better.\"\n    }), \"\\n\", _jsx(_components.pre, {\n      className: \"language-python\",\n      children: _jsxs(_components.code, {\n        className: \"language-python code-highlight\",\n        children: [_jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"n_iterations \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"2000\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"eps \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"7.\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"/\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"255.\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"bs \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"32\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token comment\",\n            children: \"# not needed\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"alpha \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \".1\"\n          }), \"\\n\"]\n        }), _jsx(_components.span, {\n          className: \"code-line\",\n          children: \"\\n\"\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"iters_since_improvement \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"max_iters_since_improvement \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"100\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"best_loss \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token builtin\",\n            children: \"float\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token string\",\n            children: \"'inf'\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsx(_components.span, {\n          className: \"code-line\",\n          children: \"\\n\"\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"x \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" img_original_tensor\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"clone\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"detach\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"requires_grad_\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token boolean\",\n            children: \"True\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsx(_components.span, {\n          className: \"code-line\",\n          children: \"\\n\"\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"loss_func \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" nn\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"BCEWithLogitsLoss\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsx(_components.span, {\n          className: \"code-line\",\n          children: \"\\n\"\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [_jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"def\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token function\",\n            children: \"forward\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"x\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    x \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" resize\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"x\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    x \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" normalize\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"x\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    x \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" model\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"x\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    \", _jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"return\"\n          }), \" x\\n\"]\n        }), _jsx(_components.span, {\n          className: \"code-line\",\n          children: \"\\n\"\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [_jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"for\"\n          }), \" iteration \", _jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"in\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token builtin\",\n            children: \"range\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"n_iterations\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    model\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"zero_grad\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token comment\",\n            children: \"# this is the fix for the author's mistake\"\n          }), \"\\n\"]\n        }), _jsx(_components.span, {\n          className: \"code-line\",\n          children: \"\\n\"\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    logits \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" forward\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"torch\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"cat\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"[\"\n          }), \"x\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"]\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"*\"\n          }), \" bs\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" dim\", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token comment\",\n            children: \"# bs not needed\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    loss \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" loss_func\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"logits\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" torch\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"ones_like\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"logits\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token comment\",\n            children: \"# maximize the output of the model\"\n          }), \"\\n\"]\n        }), _jsx(_components.span, {\n          className: \"code-line\",\n          children: \"\\n\"\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    grad \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" torch\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"autograd\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"grad\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"loss\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" x\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"[\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"]\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    x\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"data \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" x\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"data \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"-\"\n          }), \" alpha \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"*\"\n          }), \" torch\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"sign\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"grad\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsx(_components.span, {\n          className: \"code-line\",\n          children: \"\\n\"\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    x\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"data \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" torch\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"clamp\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"x\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"data\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" img_original_tensor \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"-\"\n          }), \" eps\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" img_original_tensor \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"+\"\n          }), \" eps\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsx(_components.span, {\n          className: \"code-line\",\n          children: \"\\n\"\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    \", _jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"if\"\n          }), \" loss\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"item\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"\u003c\"\n          }), \" best_loss \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"-\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.05\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"        best_loss \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" loss\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"item\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"        iters_since_improvement \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    \", _jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"else\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"        iters_since_improvement \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"+=\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"1\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"        \", _jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"if\"\n          }), \" iters_since_improvement \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"\u003e=\"\n          }), \" max_iters_since_improvement\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"            alpha \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"/=\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"1.5\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"            iters_since_improvement \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"            \", _jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"print\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsxs(_components.span, {\n            className: \"token string-interpolation\",\n            children: [_jsx(_components.span, {\n              className: \"token string\",\n              children: \"f\\\"Reducing alpha to \"\n            }), _jsxs(_components.span, {\n              className: \"token interpolation\",\n              children: [_jsx(_components.span, {\n                className: \"token punctuation\",\n                children: \"{\"\n              }), \"alpha\", _jsx(_components.span, {\n                className: \"token punctuation\",\n                children: \"}\"\n              })]\n            }), _jsx(_components.span, {\n              className: \"token string\",\n              children: \"\\\"\"\n            })]\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        })]\n      })\n    }), \"\\n\", _jsxs(\"p\", {\n      className: \"mr-4 subtext\",\n      style: {\n        fontSize: '0.75rem'\n      },\n      children: [\"full code: \", _jsx(_components.a, {\n        href: \"https://github.com/OutWrest/blog-handouts/blob/main/exploring-attacks-1/i-hate-anime-girls-osugaming-2024.ipynb\",\n        children: \"https://github.com/OutWrest/blog-handouts/blob/main/exploring-attacks-1/i-hate-anime-girls-osugaming-2024.ipynb\"\n      })]\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Output:\"\n    }), \"\\n\", _jsx(_components.pre, {\n      className: \"language-bash\",\n      children: _jsxs(_components.code, {\n        className: \"language-bash code-highlight\",\n        children: [_jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"Iter: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0\"\n          }), \"    \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Loss:  \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"2.0104\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Pred:  \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.1339\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" min/mean/max diff: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.00\"\n          }), \"/4.80/8.00\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"Iter: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"100\"\n          }), \"  \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Loss:  \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"2.0053\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Pred:  \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.1346\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" min/mean/max diff: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.00\"\n          }), \"/4.80/8.00\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"Reducing alpha to \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.06666666666666667\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"Iter: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"200\"\n          }), \"  \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Loss:  \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"1.9217\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Pred:  \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.1464\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" min/mean/max diff: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.00\"\n          }), \"/4.79/8.00\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"Reducing alpha to \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.044444444444444446\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"Iter: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"300\"\n          }), \"  \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Loss:  \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"1.8906\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Pred:  \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.1510\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" min/mean/max diff: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.00\"\n          }), \"/4.23/8.00\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"Reducing alpha to \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.02962962962962963\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"Iter: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"400\"\n          }), \"  \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Loss:  \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"1.8724\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Pred:  \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.1538\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" min/mean/max diff: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.00\"\n          }), \"/3.31/7.00\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"Iter: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"500\"\n          }), \"  \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Loss:  \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"1.5570\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Pred:  \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.2108\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" min/mean/max diff: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.00\"\n          }), \"/3.32/8.00\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"Reducing alpha to \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.019753086419753086\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"Iter: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"600\"\n          }), \"  \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Loss:  \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"1.4528\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Pred:  \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.2339\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" min/mean/max diff: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.00\"\n          }), \"/3.20/8.00\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"Iter: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"700\"\n          }), \"  \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Loss:  \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"1.5776\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Pred:  \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.2065\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" min/mean/max diff: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.00\"\n          }), \"/3.20/8.00\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"Reducing alpha to \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.01316872427983539\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"Iter: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"800\"\n          }), \"  \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Loss:  \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"1.2085\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Pred:  \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.2986\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" min/mean/max diff: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.00\"\n          }), \"/2.97/8.00\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"Reducing alpha to \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.008779149519890261\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"Iter: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"900\"\n          }), \"  \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Loss:  \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.9222\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Pred:  \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.3976\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" min/mean/max diff: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.00\"\n          }), \"/2.87/8.00\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"Reducing alpha to \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.005852766346593507\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"Iter: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"1000\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Loss:  \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.6689\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Pred:  \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.5123\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" min/mean/max diff: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.00\"\n          }), \"/2.97/8.00\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"Iter: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"1100\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Loss:  \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.5700\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Pred:  \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.5655\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" min/mean/max diff: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.00\"\n          }), \"/3.03/8.00\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"Reducing alpha to \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.003901844231062338\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"Iter: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"1200\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Loss:  \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.4041\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Pred:  \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.6676\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" min/mean/max diff: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.00\"\n          }), \"/3.21/8.00\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"Reducing alpha to \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.002601229487374892\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"Iter: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"1300\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Loss:  \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.4183\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Pred:  \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.6581\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" min/mean/max diff: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.00\"\n          }), \"/3.25/7.00\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"Iter: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"1400\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Loss:  \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.3224\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Pred:  \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.7244\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" min/mean/max diff: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.00\"\n          }), \"/3.19/7.00\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"Reducing alpha to \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.0017341529915832611\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"Iter: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"1500\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Loss:  \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.2673\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Pred:  \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.7654\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" min/mean/max diff: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.00\"\n          }), \"/3.22/7.00\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"Reducing alpha to \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.0011561019943888407\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"Iter: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"1600\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Loss:  \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.2352\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Pred:  \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.7904\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" min/mean/max diff: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.00\"\n          }), \"/3.25/7.00\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"Reducing alpha to \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.0007707346629258938\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"Iter: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"1700\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Loss:  \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.2144\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Pred:  \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.8070\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" min/mean/max diff: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.00\"\n          }), \"/3.28/7.00\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"Reducing alpha to \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.0005138231086172625\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"Iter: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"1800\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Loss:  \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.2014\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Pred:  \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.8176\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" min/mean/max diff: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.00\"\n          }), \"/3.29/7.00\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"Reducing alpha to \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.000342548739078175\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"Iter: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"1900\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Loss:  \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.1925\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" Pred:  \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.8249\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"|\"\n          }), \" min/mean/max diff: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.00\"\n          }), \"/3.30/7.00\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"Reducing alpha to \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.00022836582605211667\"\n          }), \"\\n\"]\n        })]\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"I wasn't able to generate another example that does better than the previous method in terms of confidence using PGD.\\nBut it should be enough to be used to solve the challenge.\"\n    }), \"\\n\", _jsxs(\"div\", {\n      className: \"flex items-center justify-center flex-col\",\n      children: [_jsx(\"img\", {\n        className: \"block\",\n        src: \"/post-assets/exploring-attacks-1/i-hate-anime-girls-osugaming-2024-pgd.png\",\n        alt: \"Three images that showcase the adversarial attack.\"\n      }), _jsx(\"p\", {\n        className: \"mr-4 subtext\",\n        style: {\n          fontSize: '0.75rem'\n        },\n        children: \"The output adversarial example on provided image using PGD.\"\n      })]\n    }), \"\\n\", _jsx(_components.h1, {\n      children: \"Conclusion\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"In this exploration of a few different adversarial attacks on CNNs, we learned about some widely used practical techiques, specifically in context of solving CTF challenges.\\nI really hope that conveyed these ideas clearly and I would strongly encourage you to go through the code repository linked to get a clearer idea about how to apply these methods.\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"While brief, I wanted to show some real examples from CTF challenges that used similar ideas.\\nI think we'll probably see more CTFs creating AI/ML focused challenges.\\nFeel free to reach out to me through discord if you have any questions.\"\n    })]\n  });\n}\nfunction MDXContent(props = {}) {\n  const {wrapper: MDXLayout} = Object.assign({}, _provideComponents(), props.components);\n  return MDXLayout ? _jsx(MDXLayout, Object.assign({}, props, {\n    children: _jsx(_createMdxContent, props)\n  })) : _createMdxContent(props);\n}\nreturn {\n  default: MDXContent\n};\nfunction _missingMdxReference(id, component) {\n  throw new Error(\"Expected \" + (component ? \"component\" : \"object\") + \" `\" + id + \"` to be defined: you likely forgot to import, pass, or provide it.\");\n}\n","frontmatter":{},"scope":{"title":"Exploring Adversarial Attacks on Convolutional Neural Networks - Part 1","description":"Digging into simple CNN adversarial attacks shown in DiceCTF 2024 \u0026 osu!gaming CTF 2024","date":"2024-07-13","tags":["ai","vision","ctf","misc"],"slug":"exploring-attacks-1"}},"previous":null,"next":null},"__N_SSG":true},"page":"/posts/[slug]","query":{"slug":"exploring-attacks-1"},"buildId":"K08MmqNKSNWSYTMvGcjzF","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>