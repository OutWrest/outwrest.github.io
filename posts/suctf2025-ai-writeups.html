<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8" data-next-head=""/><meta name="viewport" content="width=device-width" data-next-head=""/><link rel="preload" href="/avatar.png" as="image" data-next-head=""/><title data-next-head="">SUCTF 2025 AI Writeups - Outwrest</title><link rel="canonical" href="https://outw.rest/posts/suctf2025-ai-writeups" data-next-head=""/><meta property="og:url" content="https://outw.rest/posts/suctf2025-ai-writeups" data-next-head=""/><meta property="og:site_name" content="Outwrest" data-next-head=""/><meta property="og:title" content="SUCTF 2025 AI Writeups" data-next-head=""/><meta property="og:description" content="Explore the challenges from SUCTF 2025 AI category." data-next-head=""/><meta property="og:image" content="https://outw.rest/og-image.png" data-next-head=""/><meta property="og:type" content="article" data-next-head=""/><meta name="twitter:card" content="summary_large_image" data-next-head=""/><meta name="twitter:title" content="SUCTF 2025 AI Writeups" data-next-head=""/><meta name="twitter:description" content="Explore the challenges from SUCTF 2025 AI category." data-next-head=""/><meta name="twitter:image" content="https://outw.rest/og-image.png" data-next-head=""/><meta name="description" content="Explore the challenges from SUCTF 2025 AI category." data-next-head=""/><link rel="preload" href="/_next/static/media/83afe278b6a6bb3c-s.p.3a6ba036.woff2" as="font" type="font/woff2" crossorigin="anonymous" data-next-font="size-adjust"/><link rel="preload" href="/_next/static/media/70bc3e132a0a741e-s.p.15008bfb.woff2" as="font" type="font/woff2" crossorigin="anonymous" data-next-font="size-adjust"/><link rel="preload" href="/_next/static/chunks/feb0fd5c30d27780.css" as="style"/><link rel="preload" href="/_next/static/chunks/8349807e10bacc1f.css" as="style"/><script type="application/ld+json" data-next-head="">{"@context":"https://schema.org","@type":"BlogPosting","headline":"SUCTF 2025 AI Writeups","description":"Explore the challenges from SUCTF 2025 AI category.","image":["https://outw.rest/og-image.png"],"datePublished":"2025-02-03","author":{"@type":"Person","name":"Outwrest"},"url":"https://outw.rest/posts/suctf2025-ai-writeups"}</script><link rel="stylesheet" href="/_next/static/chunks/feb0fd5c30d27780.css" data-n-g=""/><link rel="stylesheet" href="/_next/static/chunks/8349807e10bacc1f.css" data-n-p=""/><noscript data-n-css=""></noscript><script src="/_next/static/chunks/f2bcf6e14f3e1e06.js" defer=""></script><script src="/_next/static/chunks/afda442dbfc0ef05.js" defer=""></script><script src="/_next/static/chunks/fa82231da88d19e9.js" defer=""></script><script src="/_next/static/chunks/8bdc252b5746217b.js" defer=""></script><script src="/_next/static/chunks/turbopack-c8ab3b1d31c86124.js" defer=""></script><script src="/_next/static/chunks/832a24c29bcff81f.js" defer=""></script><script src="/_next/static/chunks/10f1547931883707.js" defer=""></script><script src="/_next/static/chunks/turbopack-615afa7457bbe1c0.js" defer=""></script><script src="/_next/static/wIuS6dCENnYxxAnkq_Hdh/_ssgManifest.js" defer=""></script><script src="/_next/static/wIuS6dCENnYxxAnkq_Hdh/_buildManifest.js" defer=""></script></head><body class="bg-gray-50 text-gray-800 dark:bg-gray-900 dark:text-gray-50"><link rel="preload" as="image" href="/avatar.png"/><link rel="preload" as="image" href="/post-assets/suctf2025-ai-writeups/augmentation-cells.png"/><link rel="preload" as="image" href="/post-assets/suctf2025-ai-writeups/backdoor-img.png"/><div id="__next"><script>((e,i,s,u,m,a,l,h)=>{let d=document.documentElement,w=["light","dark"];function p(n){(Array.isArray(e)?e:[e]).forEach(y=>{let k=y==="class",S=k&&a?m.map(f=>a[f]||f):m;k?(d.classList.remove(...S),d.classList.add(a&&a[n]?a[n]:n)):d.setAttribute(y,n)}),R(n)}function R(n){h&&w.includes(n)&&(d.style.colorScheme=n)}function c(){return window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"}if(u)p(u);else try{let n=localStorage.getItem(i)||s,y=l&&n==="system"?c():n;p(y)}catch(n){}})("class","theme","system",null,["light","dark"],null,true,true)</script><div class="inter_6e63d4e8-module__QTHNqG__variable jetbrains_mono_676d3eb2-module__e3bmGW__variable font-sans min-h-screen flex flex-col"><a href="#main" class="fixed p-2 top-0 left-0 -translate-y-full focus:translate-y-0 z-50 bg-white dark:bg-gray-900">Skip to main content</a><div class="flex flex-col max-w-5xl mx-auto w-full px-4 grow"><header class="py-8 flex justify-between items-center"><a class="font-bold" href="/"><span class="flex"><img alt="Outwrest" width="48" height="48" decoding="async" data-nimg="1" class="rounded-md" style="color:transparent" src="/avatar.png"/></span></a><nav class="flex items-center gap-6"><ul class="flex space-x-6"><li><a class="text-sm font-medium transition-colors hover:text-pink-600 text-gray-600 dark:text-gray-400 dark:hover:text-pink-400" href="/posts">Posts</a></li><li><a class="text-sm font-medium transition-colors hover:text-pink-600 text-gray-600 dark:text-gray-400 dark:hover:text-pink-400" href="/about">About</a></li></ul><div class="pl-6 border-l border-gray-200 dark:border-gray-800"><div class="w-8 h-8"></div></div></nav></header><main id="main" class="grow"><header class="mb-8 pb-8 border-b border-gray-200 dark:border-gray-700"><time class="block mb-2 text-gray-500 dark:text-gray-400">February 03, 2025</time><h1 class="font-bold text-3xl">SUCTF 2025 AI Writeups</h1><div class="mt-4"><div class="max-w-none prose prose-a:text-pink-600 dark:prose-invert"><p>Explore the challenges from SUCTF 2025 AI category.</p></div></div></header><div class="max-w-none prose prose-a:text-pink-600 dark:prose-invert"><h1>Introduction</h1>
<p>Hey everyone! I know I&#x27;ve been pretty quiet here, but I&#x27;m hoping to change that this year.
I wanted to share a short collection of writeups from SUCTF 2025, a Chinese XCTF qualifier.
I mainly focused on the AI category and found the challenges interesting.
It seems like the Chinese CTF scene has tons of AI problems, and I&#x27;ve been having a lot of fun with them.</p>
<p>I played with <a target="_blank" rel="noopener noreferrer" href="https://ctftime.org/team/157039/">idek</a> during the CTF.
We managed to get 1st blood and 2nd blood on two out of the three AI challenges we solved.</p>
<h1>Challenge Writeups</h1>
<br/>
<div class="flex justify-center"><div class="w-full max-w-3xl rounded-md border p-4 bg-gray-100 dark:bg-gray-800 dark:border-gray-700"><div class="flex flex-col gap-2 sm:flex-row sm:justify-between"><div class="min-w-0"><h2 class="mb-0 mt-0 break-words text-xl font-bold">misc / <!-- -->SU_AI_how_to_encrypt_plus</h2></div><div class="shrink-0 text-sm sm:text-right"><p class="mb-1 mt-0 font-semibold">11 solves / 666 points</p><a href="https://ctftime.org/event/2620/" target="_blank" rel="noopener noreferrer" class="text-gray-700 hover:underline dark:text-pink-400">SUCTF 2024</a></div></div><div class="mt-4"><div class="max-w-none prose prose-a:text-pink-600 dark:prose-invert"><p>With the rise of AI, AI is being used in more and more fields.
One day, when classmate Xiaolin was conducting a security attack and defense test, she encountered an encryptor.
This encryptor is a bit special, and she can&#x27;t decrypt it, so please help her.</p><p><a href="https://adworld.xctf.org.cn/media/file/task/a61dbb0d-42c9-43d9-b295-53a28199883e.zip">Challenge Attachment</a></p></div></div></div></div>
<br/>
<p>We are given three files <code>model.pth</code>, <code>ciphertext.txt</code>, and <code>Generate_ciphertext.py</code>.</p>
<p>The <code>Generate_ciphertext.py</code> file contains the following code:</p>
<pre class="language-python"><code class="language-python code-highlight"><span class="code-line"><span class="token keyword">import</span> torch
</span><span class="code-line"><span class="token keyword">import</span> torch<span class="token punctuation">.</span>nn <span class="token keyword">as</span> nn
</span><span class="code-line">flag<span class="token operator">=</span><span class="token string">&#x27;&#x27;</span>
</span><span class="code-line">flag_list<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span>
</span><span class="code-line"><span class="token keyword">for</span> i <span class="token keyword">in</span> flag<span class="token punctuation">:</span>
</span><span class="code-line">    binary_str <span class="token operator">=</span> <span class="token builtin">format</span><span class="token punctuation">(</span><span class="token builtin">ord</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">&#x27;09b&#x27;</span><span class="token punctuation">)</span>
</span><span class="code-line">    <span class="token keyword">print</span><span class="token punctuation">(</span>binary_str<span class="token punctuation">)</span>
</span><span class="code-line">    <span class="token keyword">for</span> bit <span class="token keyword">in</span> binary_str<span class="token punctuation">:</span>
</span><span class="code-line">        flag_list<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>bit<span class="token punctuation">)</span><span class="token punctuation">)</span>
</span><span class="code-line"><span class="token builtin">input</span><span class="token operator">=</span>torch<span class="token punctuation">.</span>tensor<span class="token punctuation">(</span>flag_list<span class="token punctuation">,</span> dtype<span class="token operator">=</span>torch<span class="token punctuation">.</span>float32<span class="token punctuation">)</span>
</span><span class="code-line">n<span class="token operator">=</span><span class="token builtin">len</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span>
</span><span class="code-line"><span class="token keyword">class</span> <span class="token class-name">Net</span><span class="token punctuation">(</span>nn<span class="token punctuation">.</span>Module<span class="token punctuation">)</span><span class="token punctuation">:</span>
</span><span class="code-line">
</span><span class="code-line">    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
</span><span class="code-line">        <span class="token builtin">super</span><span class="token punctuation">(</span>Net<span class="token punctuation">,</span> self<span class="token punctuation">)</span><span class="token punctuation">.</span>__init__<span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">        self<span class="token punctuation">.</span>linear <span class="token operator">=</span> nn<span class="token punctuation">.</span>Linear<span class="token punctuation">(</span>n<span class="token punctuation">,</span> n<span class="token operator">*</span>n<span class="token punctuation">)</span>
</span><span class="code-line">        self<span class="token punctuation">.</span>conv<span class="token operator">=</span>nn<span class="token punctuation">.</span>Conv2d<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> stride<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span>padding<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>
</span><span class="code-line">        self<span class="token punctuation">.</span>conv1<span class="token operator">=</span>nn<span class="token punctuation">.</span>Conv2d<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span> stride<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line">    <span class="token keyword">def</span> <span class="token function">forward</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> x<span class="token punctuation">)</span><span class="token punctuation">:</span>
</span><span class="code-line">        x <span class="token operator">=</span> x<span class="token punctuation">.</span>view<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token operator">*</span>n<span class="token punctuation">)</span>
</span><span class="code-line">        x <span class="token operator">=</span> self<span class="token punctuation">.</span>conv1<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
</span><span class="code-line">        x <span class="token operator">=</span> x<span class="token punctuation">.</span>view<span class="token punctuation">(</span>n<span class="token punctuation">)</span>
</span><span class="code-line">        x <span class="token operator">=</span> self<span class="token punctuation">.</span>linear<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
</span><span class="code-line">        x <span class="token operator">=</span> x<span class="token punctuation">.</span>view<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> n<span class="token punctuation">,</span> n<span class="token punctuation">)</span>
</span><span class="code-line">        x<span class="token operator">=</span>self<span class="token punctuation">.</span>conv<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
</span><span class="code-line">        <span class="token keyword">return</span> x
</span><span class="code-line">mynet<span class="token operator">=</span>Net<span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">mynet<span class="token punctuation">.</span>load_state_dict<span class="token punctuation">(</span>torch<span class="token punctuation">.</span>load<span class="token punctuation">(</span><span class="token string">&#x27;model.pth&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</span><span class="code-line">output<span class="token operator">=</span>mynet<span class="token punctuation">(</span><span class="token builtin">input</span><span class="token punctuation">)</span>
</span><span class="code-line"><span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">&#x27;ciphertext.txt&#x27;</span><span class="token punctuation">,</span> <span class="token string">&#x27;w&#x27;</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
</span><span class="code-line">    <span class="token keyword">for</span> tensor <span class="token keyword">in</span> output<span class="token punctuation">:</span>
</span><span class="code-line">        <span class="token keyword">for</span> channel <span class="token keyword">in</span> tensor<span class="token punctuation">:</span>
</span><span class="code-line">            <span class="token keyword">for</span> row <span class="token keyword">in</span> channel<span class="token punctuation">:</span>
</span><span class="code-line">                f<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string">&#x27; &#x27;</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token builtin">map</span><span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">,</span> row<span class="token punctuation">.</span>tolist<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</span><span class="code-line">                f<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string">&#x27;\n&#x27;</span><span class="token punctuation">)</span>
</span></code></pre>
<p>The code creates a neural network model that takes the flag as input and generates the ciphertext.
Given the model&#x27;s weights, we can reverse-engineer the model to decrypt the ciphertext.
However, there exist operations that are not <em>always</em> reversible.</p>
<p>The <code>model.pth</code> file contains the weights of the model, and after inspecting the weights we see that the weights are all integers.</p>
<pre class="language-python"><code class="language-python code-highlight"><span class="code-line"><span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> torch<span class="token punctuation">.</span>load<span class="token punctuation">(</span><span class="token string">&#x27;model.pth&#x27;</span><span class="token punctuation">,</span> weights_only<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
</span><span class="code-line">OrderedDict<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token string">&#x27;linear.weight&#x27;</span><span class="token punctuation">,</span>
</span><span class="code-line">              tensor<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token operator">-</span><span class="token number">6.</span><span class="token punctuation">,</span>   <span class="token number">1.</span><span class="token punctuation">,</span>  <span class="token operator">-</span><span class="token number">3.</span><span class="token punctuation">,</span>  <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">,</span>   <span class="token number">4.</span><span class="token punctuation">,</span>   <span class="token number">4.</span><span class="token punctuation">,</span>  <span class="token operator">-</span><span class="token number">4.</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
</span><span class="code-line">                      <span class="token punctuation">[</span> <span class="token operator">-</span><span class="token number">4.</span><span class="token punctuation">,</span>   <span class="token number">9.</span><span class="token punctuation">,</span>  <span class="token operator">-</span><span class="token number">8.</span><span class="token punctuation">,</span>  <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">,</span>  <span class="token operator">-</span><span class="token number">1.</span><span class="token punctuation">,</span>   <span class="token number">1.</span><span class="token punctuation">,</span>  <span class="token operator">-</span><span class="token number">5.</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
</span><span class="code-line">                      <span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">10.</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">10.</span><span class="token punctuation">,</span>   <span class="token number">7.</span><span class="token punctuation">,</span>  <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">,</span>   <span class="token number">9.</span><span class="token punctuation">,</span>  <span class="token operator">-</span><span class="token number">5.</span><span class="token punctuation">,</span>  <span class="token operator">-</span><span class="token number">7.</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
</span><span class="code-line">                      <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">,</span>
</span><span class="code-line">                      <span class="token punctuation">[</span>  <span class="token number">0.</span><span class="token punctuation">,</span>  <span class="token operator">-</span><span class="token number">2.</span><span class="token punctuation">,</span>   <span class="token number">4.</span><span class="token punctuation">,</span>  <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">,</span>  <span class="token operator">-</span><span class="token number">2.</span><span class="token punctuation">,</span>   <span class="token number">7.</span><span class="token punctuation">,</span>   <span class="token number">6.</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
</span><span class="code-line">                      <span class="token punctuation">[</span>  <span class="token number">7.</span><span class="token punctuation">,</span>   <span class="token number">3.</span><span class="token punctuation">,</span>   <span class="token number">7.</span><span class="token punctuation">,</span>  <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">,</span>   <span class="token number">3.</span><span class="token punctuation">,</span>  <span class="token operator">-</span><span class="token number">3.</span><span class="token punctuation">,</span>  <span class="token operator">-</span><span class="token number">1.</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
</span><span class="code-line">                      <span class="token punctuation">[</span>  <span class="token number">2.</span><span class="token punctuation">,</span>   <span class="token number">7.</span><span class="token punctuation">,</span>   <span class="token number">4.</span><span class="token punctuation">,</span>  <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">,</span>  <span class="token operator">-</span><span class="token number">2.</span><span class="token punctuation">,</span>   <span class="token number">6.</span><span class="token punctuation">,</span>  <span class="token operator">-</span><span class="token number">9.</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
</span><span class="code-line">             <span class="token punctuation">(</span><span class="token string">&#x27;linear.bias&#x27;</span><span class="token punctuation">,</span> tensor<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1.</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">5.</span><span class="token punctuation">,</span>  <span class="token number">8.</span><span class="token punctuation">,</span>  <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">,</span>  <span class="token number">7.</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">4.</span><span class="token punctuation">,</span>  <span class="token number">1.</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
</span><span class="code-line">             <span class="token punctuation">(</span><span class="token string">&#x27;conv.weight&#x27;</span><span class="token punctuation">,</span>
</span><span class="code-line">              tensor<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token number">7.</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">5.</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
</span><span class="code-line">                        <span class="token punctuation">[</span> <span class="token number">9.</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">7.</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
</span><span class="code-line">             <span class="token punctuation">(</span><span class="token string">&#x27;conv.bias&#x27;</span><span class="token punctuation">,</span> tensor<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">7.</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
</span><span class="code-line">             <span class="token punctuation">(</span><span class="token string">&#x27;conv1.weight&#x27;</span><span class="token punctuation">,</span>
</span><span class="code-line">              tensor<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token punctuation">[</span>  <span class="token number">1.</span><span class="token punctuation">,</span>   <span class="token number">2.</span><span class="token punctuation">,</span>   <span class="token number">4.</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
</span><span class="code-line">                        <span class="token punctuation">[</span>  <span class="token number">8.</span><span class="token punctuation">,</span>  <span class="token number">16.</span><span class="token punctuation">,</span>  <span class="token number">32.</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
</span><span class="code-line">                        <span class="token punctuation">[</span> <span class="token number">64.</span><span class="token punctuation">,</span> <span class="token number">128.</span><span class="token punctuation">,</span> <span class="token number">256.</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
</span><span class="code-line">             <span class="token punctuation">(</span><span class="token string">&#x27;conv1.bias&#x27;</span><span class="token punctuation">,</span> tensor<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">6.</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</span></code></pre>
<p>The weights are <strong>probably</strong> specially crafted to make the model&#x27;s output reversible.</p>
<p>During the competition, I reverse-engineered the outputs layer by layer.
There are probably much more efficient ways to do this, but I did not have much time to explore them.</p>
<p>Because of the weights and the binary input of the model, we can make some assumptions that can make the process easier.
The convolutionals are the only tricky operations.
There&#x27;s some cool visualizations of the convolutional operations <a target="_blank" rel="noopener noreferrer" href="https://ezyang.github.io/convolution-visualizer/">here</a>.</p>
<p>For the last convolutional layer, each element <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi></mrow><annotation encoding="application/x-tex">y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em"></span><span class="mord mathnormal" style="margin-right:0.03588em">y</span></span></span></span> is computed as follows:</p>
<div class="flex items-center justify-center math-container"><div class="flex items-center justify-center rounded-md p-4 border w-11/12 not-prose border-0"><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>y</mi><mrow><mi>i</mi><mo separator="true">,</mo><mi>j</mi></mrow></msub><mo>=</mo><msub><mi>w</mi><mn>00</mn></msub><mtext> </mtext><msub><mi>x</mi><mrow><mi>i</mi><mo>−</mo><mn>1</mn><mo separator="true">,</mo><mi>j</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>+</mo><msub><mi>w</mi><mn>01</mn></msub><mtext> </mtext><msub><mi>x</mi><mrow><mi>i</mi><mo>−</mo><mn>1</mn><mo separator="true">,</mo><mi>j</mi></mrow></msub><mo>+</mo><msub><mi>w</mi><mn>10</mn></msub><mtext> </mtext><msub><mi>x</mi><mrow><mi>i</mi><mo separator="true">,</mo><mi>j</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>+</mo><msub><mi>w</mi><mn>11</mn></msub><mtext> </mtext><msub><mi>x</mi><mrow><mi>i</mi><mo separator="true">,</mo><mi>j</mi></mrow></msub><mo>+</mo><mi>b</mi></mrow><annotation encoding="application/x-tex">y_{i,j} = w_{00} \, x_{i-1,j-1} + w_{01} \, x_{i-1,j} + w_{10} \, x_{i,j-1} + w_{11} \, x_{i,j} + b</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7167em;vertical-align:-0.2861em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.8694em;vertical-align:-0.2861em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">00</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mbin mtight">−</span><span class="mord mtight">1</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.05724em">j</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:0.8694em;vertical-align:-0.2861em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">01</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mbin mtight">−</span><span class="mord mtight">1</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:0.8694em;vertical-align:-0.2861em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">10</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.05724em">j</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:0.8694em;vertical-align:-0.2861em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">11</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:0.6944em"></span><span class="mord mathnormal">b</span></span></span></span></p></div></div>
<p>Where <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>w</mi></mrow><annotation encoding="application/x-tex">w</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord mathnormal" style="margin-right:0.02691em">w</span></span></span></span> are the 2x2 weights and <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>b</mi></mrow><annotation encoding="application/x-tex">b</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em"></span><span class="mord mathnormal">b</span></span></span></span> is the bias in the convolutional layer.</p>
<p>We can easily show that <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mrow><mi>i</mi><mo separator="true">,</mo><mi>j</mi></mrow></msub></mrow><annotation encoding="application/x-tex">x_{i,j}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7167em;vertical-align:-0.2861em"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em"><span></span></span></span></span></span></span></span></span></span> is:</p>
<div class="flex items-center justify-center math-container"><div class="flex items-center justify-center rounded-md p-4 border w-11/12 not-prose border-0"><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mrow><mi>i</mi><mo separator="true">,</mo><mi>j</mi></mrow></msub><mo>=</mo><mfrac><mrow><mtext> </mtext><msub><mi>y</mi><mrow><mi>i</mi><mo separator="true">,</mo><mi>j</mi></mrow></msub><mo>−</mo><mi>b</mi><mo>−</mo><msub><mi>w</mi><mn>00</mn></msub><mtext> </mtext><msub><mi>x</mi><mrow><mi>i</mi><mo>−</mo><mn>1</mn><mo separator="true">,</mo><mi>j</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>−</mo><msub><mi>w</mi><mn>01</mn></msub><mtext> </mtext><msub><mi>x</mi><mrow><mi>i</mi><mo>−</mo><mn>1</mn><mo separator="true">,</mo><mi>j</mi></mrow></msub><mo>−</mo><msub><mi>w</mi><mn>10</mn></msub><mtext> </mtext><msub><mi>x</mi><mrow><mi>i</mi><mo separator="true">,</mo><mi>j</mi><mo>−</mo><mn>1</mn></mrow></msub><mtext> </mtext></mrow><msub><mi>w</mi><mn>11</mn></msub></mfrac></mrow><annotation encoding="application/x-tex">x_{i,j} = \frac{\,y_{i,j} - b - w_{00} \, x_{i-1,j-1} - w_{01} \, x_{i-1,j} - w_{10} \, x_{i,j-1}\,}{w_{11}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7167em;vertical-align:-0.2861em"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1.4385em;vertical-align:-0.4451em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9934em"><span style="top:-2.655em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02691em">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em"><span style="top:-2.357em;margin-left:-0.0269em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">11</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.5073em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mspace mtight" style="margin-right:0.1952em"></span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em"><span style="top:-2.357em;margin-left:-0.0359em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2819em"><span></span></span></span></span></span></span><span class="mbin mtight">−</span><span class="mord mathnormal mtight">b</span><span class="mbin mtight">−</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02691em">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em"><span style="top:-2.357em;margin-left:-0.0269em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">00</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em"><span></span></span></span></span></span></span><span class="mspace mtight" style="margin-right:0.1952em"></span><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mbin mtight">−</span><span class="mord mtight">1</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.05724em">j</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2819em"><span></span></span></span></span></span></span><span class="mbin mtight">−</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02691em">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em"><span style="top:-2.357em;margin-left:-0.0269em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">01</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em"><span></span></span></span></span></span></span><span class="mspace mtight" style="margin-right:0.1952em"></span><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mbin mtight">−</span><span class="mord mtight">1</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.05724em">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2819em"><span></span></span></span></span></span></span><span class="mbin mtight">−</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02691em">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3173em"><span style="top:-2.357em;margin-left:-0.0269em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">10</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em"><span></span></span></span></span></span></span><span class="mspace mtight" style="margin-right:0.1952em"></span><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.05724em">j</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2819em"><span></span></span></span></span></span></span><span class="mspace mtight" style="margin-right:0.1952em"></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4451em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></p></div></div>
<p>Code:</p>
<pre class="language-python"><code class="language-python code-highlight"><span class="code-line"><span class="token keyword">def</span> <span class="token function">invert_conv2d_2x2_s1_p1</span><span class="token punctuation">(</span>y<span class="token punctuation">,</span> c_w<span class="token punctuation">,</span> c_b<span class="token punctuation">)</span><span class="token punctuation">:</span>
</span><span class="code-line">    w00 <span class="token operator">=</span> c_w<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span>
</span><span class="code-line">    w01 <span class="token operator">=</span> c_w<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span>
</span><span class="code-line">    w10 <span class="token operator">=</span> c_w<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span>
</span><span class="code-line">    w11 <span class="token operator">=</span> c_w<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span>
</span><span class="code-line">
</span><span class="code-line">    h<span class="token punctuation">,</span> w <span class="token operator">=</span> y<span class="token punctuation">.</span>shape
</span><span class="code-line">    x <span class="token operator">=</span> np<span class="token punctuation">.</span>zeros_like<span class="token punctuation">(</span>y<span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line">    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>h<span class="token punctuation">)</span><span class="token punctuation">:</span>
</span><span class="code-line">        <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>w<span class="token punctuation">)</span><span class="token punctuation">:</span>
</span><span class="code-line">            val <span class="token operator">=</span> y<span class="token punctuation">[</span>i<span class="token punctuation">,</span> j<span class="token punctuation">]</span> <span class="token operator">-</span> c_b<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
</span><span class="code-line">
</span><span class="code-line">            <span class="token keyword">if</span> i <span class="token operator">-</span> <span class="token number">1</span> <span class="token operator">&gt;=</span> <span class="token number">0</span> <span class="token keyword">and</span> j <span class="token operator">-</span> <span class="token number">1</span> <span class="token operator">&gt;=</span> <span class="token number">0</span><span class="token punctuation">:</span>
</span><span class="code-line">                val <span class="token operator">-=</span> w00 <span class="token operator">*</span> x<span class="token punctuation">[</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span> j <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span>
</span><span class="code-line">            <span class="token keyword">if</span> i <span class="token operator">-</span> <span class="token number">1</span> <span class="token operator">&gt;=</span> <span class="token number">0</span><span class="token punctuation">:</span>
</span><span class="code-line">                val <span class="token operator">-=</span> w01 <span class="token operator">*</span> x<span class="token punctuation">[</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span> j<span class="token punctuation">]</span>
</span><span class="code-line">            <span class="token keyword">if</span> j <span class="token operator">-</span> <span class="token number">1</span> <span class="token operator">&gt;=</span> <span class="token number">0</span><span class="token punctuation">:</span>
</span><span class="code-line">                val <span class="token operator">-=</span> w10 <span class="token operator">*</span> x<span class="token punctuation">[</span>i<span class="token punctuation">,</span> j <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span>
</span><span class="code-line">
</span><span class="code-line">            x<span class="token punctuation">[</span>i<span class="token punctuation">,</span> j<span class="token punctuation">]</span> <span class="token operator">=</span> val <span class="token operator">/</span> w11
</span><span class="code-line">
</span><span class="code-line">    <span class="token keyword">return</span> x
</span></code></pre>
<p>The next linear layer is just a matrix multiplication, which can be reversed by multiplying the inverse of the matrix with the output.</p>
<pre class="language-python"><code class="language-python code-highlight"><span class="code-line"><span class="token keyword">def</span> <span class="token function">invert_linear_48_2304</span><span class="token punctuation">(</span>y<span class="token punctuation">,</span> l_w<span class="token punctuation">,</span> l_b<span class="token punctuation">)</span><span class="token punctuation">:</span>
</span><span class="code-line">    y_ <span class="token operator">=</span> y <span class="token operator">-</span> l_b
</span><span class="code-line">
</span><span class="code-line">    W_pinv <span class="token operator">=</span> np<span class="token punctuation">.</span>linalg<span class="token punctuation">.</span>pinv<span class="token punctuation">(</span>l_w<span class="token punctuation">)</span>
</span><span class="code-line">    x <span class="token operator">=</span> np<span class="token punctuation">.</span>dot<span class="token punctuation">(</span>y_<span class="token punctuation">,</span> W_pinv<span class="token punctuation">.</span>T<span class="token punctuation">)</span>
</span><span class="code-line">    <span class="token keyword">return</span> x
</span></code></pre>
<p>The last convolutional layer is a bit more lossy.
With the binary assumption, I bruteforced all possible 9x9 binary values and mapped them to the output.</p>
<pre class="language-python"><code class="language-python code-highlight"><span class="code-line"><span class="token keyword">def</span> <span class="token function">invert_conv2d_3x3_s3</span><span class="token punctuation">(</span>y<span class="token punctuation">,</span> c_w<span class="token punctuation">,</span> c_b<span class="token punctuation">)</span><span class="token punctuation">:</span>
</span><span class="code-line">    w <span class="token operator">=</span> c_w<span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span>
</span><span class="code-line">    b <span class="token operator">=</span> c_b<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
</span><span class="code-line">
</span><span class="code-line">    y_h<span class="token punctuation">,</span> y_w <span class="token operator">=</span> y<span class="token punctuation">.</span>shape
</span><span class="code-line">    x_h<span class="token punctuation">,</span> x_w <span class="token operator">=</span> y_h <span class="token operator">*</span> <span class="token number">3</span><span class="token punctuation">,</span> y_w <span class="token operator">*</span> <span class="token number">3</span>
</span><span class="code-line">    x <span class="token operator">=</span> np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span><span class="token punctuation">(</span>x_h<span class="token punctuation">,</span> x_w<span class="token punctuation">)</span><span class="token punctuation">,</span> dtype<span class="token operator">=</span>np<span class="token punctuation">.</span>float32<span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line">    <span class="token comment"># input is 3x3 of 1 or 0 values</span>
</span><span class="code-line">    <span class="token comment"># brute force all possible 3x3 inputs and keep in a cache</span>
</span><span class="code-line">    <span class="token comment"># then we can just look up the value in the cache</span>
</span><span class="code-line">    cache_inv <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
</span><span class="code-line">    <span class="token keyword">for</span> bits <span class="token keyword">in</span> itertools<span class="token punctuation">.</span>product<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> repeat<span class="token operator">=</span><span class="token number">9</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
</span><span class="code-line">        bits <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span>bits<span class="token punctuation">,</span> dtype<span class="token operator">=</span>np<span class="token punctuation">.</span>float32<span class="token punctuation">)</span><span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span>
</span><span class="code-line">        cache_inv<span class="token punctuation">[</span><span class="token builtin">tuple</span><span class="token punctuation">(</span>bits<span class="token punctuation">.</span>flatten<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">=</span> np<span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span>bits <span class="token operator">*</span> w<span class="token punctuation">)</span> <span class="token operator">+</span> b
</span><span class="code-line">
</span><span class="code-line">    cache <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
</span><span class="code-line">    <span class="token keyword">for</span> k<span class="token punctuation">,</span> v <span class="token keyword">in</span> cache_inv<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
</span><span class="code-line">        <span class="token keyword">assert</span> v <span class="token keyword">not</span> <span class="token keyword">in</span> cache <span class="token comment"># ensure no collisions</span>
</span><span class="code-line">        cache<span class="token punctuation">[</span>v<span class="token punctuation">]</span> <span class="token operator">=</span> k
</span><span class="code-line">
</span><span class="code-line">    <span class="token comment"># for each 3x3 block in the output</span>
</span><span class="code-line">    <span class="token comment"># look up the value in the cache</span>
</span><span class="code-line">    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>y_h<span class="token punctuation">)</span><span class="token punctuation">:</span>
</span><span class="code-line">        <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>y_w<span class="token punctuation">)</span><span class="token punctuation">:</span>
</span><span class="code-line">            y_val <span class="token operator">=</span> y<span class="token punctuation">[</span>i<span class="token punctuation">,</span> j<span class="token punctuation">]</span>
</span><span class="code-line">            x<span class="token punctuation">[</span>i<span class="token operator">*</span><span class="token number">3</span><span class="token punctuation">:</span>i<span class="token operator">*</span><span class="token number">3</span><span class="token operator">+</span><span class="token number">3</span><span class="token punctuation">,</span> j<span class="token operator">*</span><span class="token number">3</span><span class="token punctuation">:</span>j<span class="token operator">*</span><span class="token number">3</span><span class="token operator">+</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span>cache<span class="token punctuation">[</span>y_val<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line">    <span class="token keyword">return</span> x
</span></code></pre>
<p>Full solve script can be found <a target="_blank" rel="noopener noreferrer" href="https://github.com/OutWrest/blog-handouts/blob/main/suctf2025-ai-writeups/SU_AI_how_to_encrypt_plus/solve.ipynb">here</a>.</p>
<p>The last step is to convert 9-bit binary input to bytes and then we can find the flag: <code>SUCTF{Mi_sika_mosi!Mi_muhe_mita,mita_movo_lata!}</code>.</p>
<br/>
<div class="flex justify-center"><div class="w-full max-w-3xl rounded-md border p-4 bg-gray-100 dark:bg-gray-800 dark:border-gray-700"><div class="flex flex-col gap-2 sm:flex-row sm:justify-between"><div class="min-w-0"><h2 class="mb-0 mt-0 break-words text-xl font-bold">misc / <!-- -->SU_AI_segment_ceil</h2></div><div class="shrink-0 text-sm sm:text-right"><p class="mb-1 mt-0 font-semibold">9 solves / 714 points</p><a href="https://ctftime.org/event/2620/" target="_blank" rel="noopener noreferrer" class="text-gray-700 hover:underline dark:text-pink-400">SUCTF 2024</a></div></div><div class="mt-4"><div class="max-w-none prose prose-a:text-pink-600 dark:prose-invert"><p>Student Xiaolin is majoring in Smart Agriculture.
One day, the teacher gave her a bunch of cell pictures and asked her to label the cells.
How could this be something a human can do?
So she found you and asked you to help her.</p><p>nc 1.95.34.240 10001
nc 1.95.34.240 10005</p><p><a href="https://adworld.xctf.org.cn/media/file/task/1513dbb0-25fc-4978-bd34-8b23beea4ffd.zip">Challenge Attachment</a></p></div></div></div></div>
<br/>
<p>In this challenge, we are given a set of images and their segmentation labels as well as the server code.
The server code randomly selects images, adds noise to them, and sends them to the client for classification.</p>
<pre class="language-python"><code class="language-python code-highlight"><span class="code-line"><span class="token keyword">from</span> PIL <span class="token keyword">import</span> Image
</span><span class="code-line"><span class="token keyword">import</span> os
</span><span class="code-line"><span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
</span><span class="code-line"><span class="token keyword">import</span> io
</span><span class="code-line"><span class="token keyword">import</span> base64
</span><span class="code-line"><span class="token keyword">import</span> random
</span><span class="code-line"><span class="token keyword">import</span> time
</span><span class="code-line">
</span><span class="code-line"><span class="token comment"># 指定输入和输出文件夹路径</span>
</span><span class="code-line">image_folder <span class="token operator">=</span> <span class="token string">&#x27;&#x27;</span>
</span><span class="code-line">label_folder <span class="token operator">=</span> <span class="token string">&#x27;&#x27;</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token comment"># 列出所有 JPG 文件</span>
</span><span class="code-line">png_files <span class="token operator">=</span> <span class="token punctuation">[</span>f <span class="token keyword">for</span> f <span class="token keyword">in</span> os<span class="token punctuation">.</span>listdir<span class="token punctuation">(</span>label_folder<span class="token punctuation">)</span> <span class="token keyword">if</span> f<span class="token punctuation">.</span>lower<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>endswith<span class="token punctuation">(</span><span class="token string">&#x27;.png&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
</span><span class="code-line">png_files <span class="token operator">=</span> random<span class="token punctuation">.</span>sample<span class="token punctuation">(</span>png_files<span class="token punctuation">,</span> <span class="token builtin">min</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>png_files<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line">win <span class="token operator">=</span> <span class="token boolean">True</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token comment"># 读取每个 JPG 文件，处理并保存</span>
</span><span class="code-line"><span class="token keyword">for</span> png_file <span class="token keyword">in</span> png_files<span class="token punctuation">:</span>
</span><span class="code-line">    label_path <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>label_folder<span class="token punctuation">,</span> png_file<span class="token punctuation">)</span>  <span class="token comment"># 构建完整路径</span>
</span><span class="code-line">    image_path <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>image_folder<span class="token punctuation">,</span> png_file<span class="token punctuation">)</span>
</span><span class="code-line">    label <span class="token operator">=</span> Image<span class="token punctuation">.</span><span class="token builtin">open</span><span class="token punctuation">(</span>label_path<span class="token punctuation">)</span><span class="token punctuation">.</span>convert<span class="token punctuation">(</span><span class="token string">&#x27;RGB&#x27;</span><span class="token punctuation">)</span>  <span class="token comment"># 读取图片</span>
</span><span class="code-line">    w<span class="token punctuation">,</span> h <span class="token operator">=</span> label<span class="token punctuation">.</span>size
</span><span class="code-line">    label <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span>label<span class="token punctuation">)</span>
</span><span class="code-line">    image <span class="token operator">=</span> Image<span class="token punctuation">.</span><span class="token builtin">open</span><span class="token punctuation">(</span>image_path<span class="token punctuation">)</span><span class="token punctuation">.</span>convert<span class="token punctuation">(</span><span class="token string">&#x27;RGB&#x27;</span><span class="token punctuation">)</span>
</span><span class="code-line">    image <span class="token operator">=</span> add_uniform_noise<span class="token punctuation">(</span>image<span class="token punctuation">)</span>
</span><span class="code-line">    image<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">    buffered <span class="token operator">=</span> io<span class="token punctuation">.</span>BytesIO<span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">    image<span class="token punctuation">.</span>save<span class="token punctuation">(</span>buffered<span class="token punctuation">,</span> <span class="token builtin">format</span><span class="token operator">=</span><span class="token string">&quot;PNG&quot;</span><span class="token punctuation">)</span>
</span><span class="code-line">    base64_string <span class="token operator">=</span> base64<span class="token punctuation">.</span>b64encode<span class="token punctuation">(</span>buffered<span class="token punctuation">.</span>getvalue<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">&#x27;utf-8&#x27;</span><span class="token punctuation">)</span>
</span><span class="code-line">    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&#x27;image:&#x27;</span><span class="token punctuation">,</span>base64_string<span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line">    start_time <span class="token operator">=</span> time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">    base64_string <span class="token operator">=</span> <span class="token builtin">input</span><span class="token punctuation">(</span><span class="token string">&quot;can you help me segment the image:&quot;</span><span class="token punctuation">)</span>
</span><span class="code-line">    end_time <span class="token operator">=</span> time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">    <span class="token keyword">if</span> end_time <span class="token operator">-</span> start_time <span class="token operator">&gt;</span> <span class="token number">2</span><span class="token punctuation">:</span>
</span><span class="code-line">        win <span class="token operator">=</span> <span class="token boolean">False</span>
</span><span class="code-line">        <span class="token keyword">break</span>
</span><span class="code-line">    image_bytes <span class="token operator">=</span> base64<span class="token punctuation">.</span>b64decode<span class="token punctuation">(</span>base64_string<span class="token punctuation">)</span>
</span><span class="code-line">    buffered <span class="token operator">=</span> io<span class="token punctuation">.</span>BytesIO<span class="token punctuation">(</span>image_bytes<span class="token punctuation">)</span>
</span><span class="code-line">    predict <span class="token operator">=</span> Image<span class="token punctuation">.</span><span class="token builtin">open</span><span class="token punctuation">(</span>buffered<span class="token punctuation">)</span>
</span><span class="code-line">    predict <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span>predict<span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line">    correct <span class="token operator">=</span> <span class="token number">0</span>
</span><span class="code-line">    num <span class="token operator">=</span> <span class="token number">0</span>
</span><span class="code-line">
</span><span class="code-line">    test_num <span class="token operator">=</span> <span class="token number">0</span>
</span><span class="code-line">
</span><span class="code-line">    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>h<span class="token punctuation">)</span><span class="token punctuation">:</span>
</span><span class="code-line">        <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>w<span class="token punctuation">)</span><span class="token punctuation">:</span>
</span><span class="code-line">            <span class="token keyword">if</span> label<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">0</span> <span class="token keyword">and</span> label<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">0</span> <span class="token keyword">and</span> label<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>
</span><span class="code-line">                num <span class="token operator">+=</span> <span class="token number">1</span>
</span><span class="code-line">            <span class="token keyword">if</span> predict<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">0</span> <span class="token keyword">and</span> predict<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">0</span> <span class="token keyword">and</span> predict<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>
</span><span class="code-line">                num <span class="token operator">+=</span> <span class="token number">1</span>
</span><span class="code-line">                test_num <span class="token operator">+=</span> <span class="token number">1</span>
</span><span class="code-line">            <span class="token keyword">if</span> label<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">0</span> <span class="token keyword">and</span> label<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">0</span> <span class="token keyword">and</span> label<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">0</span> <span class="token keyword">and</span> predict<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">0</span> <span class="token keyword">and</span> predict<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">0</span> <span class="token keyword">and</span> predict<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>
</span><span class="code-line">                correct <span class="token operator">+=</span> <span class="token number">1</span>
</span><span class="code-line">
</span><span class="code-line">    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">*</span>correct<span class="token operator">/</span>num<span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">100</span> <span class="token operator">&lt;</span> <span class="token number">78</span><span class="token punctuation">:</span>
</span><span class="code-line">        win <span class="token operator">=</span> <span class="token boolean">False</span>
</span><span class="code-line">        <span class="token keyword">break</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">if</span> win <span class="token punctuation">:</span>
</span><span class="code-line">    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&#x27;SUCTF{win}&#x27;</span><span class="token punctuation">)</span>
</span></code></pre>
<p>To win, we must classify the images and send them back to the server, passing a certain accuracy threshold.
I initially tried to cheat the challenge by finding the raw dataset and submitting the test labels.
But this didn&#x27;t work for some reason, maybe the raw dataset I found wasn&#x27;t exactly the same as the one used by the author.</p>
<p>I trained a simple <a target="_blank" rel="noopener noreferrer" href="https://en.wikipedia.org/wiki/U-Net">U-Net</a> model on the dataset and used it to classify the images.
I applied augmentation to the dataset to increase the model&#x27;s robustness against the noise added by the server and to not overfit the small training data provided.</p>
<div class="flex items-center justify-center flex-col"><img class="block" src="/post-assets/suctf2025-ai-writeups/augmentation-cells.png" alt="Augmented image with label"/><p class="mr-4 subtext" style="font-size:0.75rem">An example of the augmentations I did with its label.</p></div>
<p>I trained the model for <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>100</mn></mrow><annotation encoding="application/x-tex">100</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord">100</span></span></span></span> epochs with dice loss (a common loss function for segmentation tasks) and achieved ~<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>80</mn></mrow><annotation encoding="application/x-tex">80</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord">80</span></span></span></span>% pixel accuracy on an external validation set.</p>
<pre class="language-bash"><code class="language-bash code-highlight"><span class="code-line">Epoch   <span class="token number">1</span>/100, Train Loss: <span class="token number">0.5059</span>, Val Loss: <span class="token number">0.4072</span>, Val Acc: <span class="token number">0.6954</span>, LR: <span class="token number">9</span>.8e-03
</span><span class="code-line">Epoch   <span class="token number">2</span>/100, Train Loss: <span class="token number">0.4374</span>, Val Loss: <span class="token number">0.3897</span>, Val Acc: <span class="token number">0.6899</span>, LR: <span class="token number">9</span>.0e-03
</span><span class="code-line">Epoch   <span class="token number">3</span>/100, Train Loss: <span class="token number">0.4439</span>, Val Loss: <span class="token number">0.3857</span>, Val Acc: <span class="token number">0.6992</span>, LR: <span class="token number">7</span>.9e-03
</span><span class="code-line">Epoch   <span class="token number">4</span>/100, Train Loss: <span class="token number">0.4492</span>, Val Loss: <span class="token number">0.3906</span>, Val Acc: <span class="token number">0.6807</span>, LR: <span class="token number">6</span>.5e-03
</span><span class="code-line">Epoch   <span class="token number">5</span>/100, Train Loss: <span class="token number">0.4374</span>, Val Loss: <span class="token number">0.3827</span>, Val Acc: <span class="token number">0.7091</span>, LR: <span class="token number">5</span>.0e-03
</span><span class="code-line">Epoch   <span class="token number">6</span>/100, Train Loss: <span class="token number">0.4149</span>, Val Loss: <span class="token number">0.3779</span>, Val Acc: <span class="token number">0.7272</span>, LR: <span class="token number">3</span>.5e-03
</span><span class="code-line">Epoch   <span class="token number">7</span>/100, Train Loss: <span class="token number">0.4221</span>, Val Loss: <span class="token number">0.3753</span>, Val Acc: <span class="token number">0.7366</span>, LR: <span class="token number">2</span>.1e-03
</span><span class="code-line">Epoch   <span class="token number">8</span>/100, Train Loss: <span class="token number">0.4152</span>, Val Loss: <span class="token number">0.3741</span>, Val Acc: <span class="token number">0.7409</span>, LR: <span class="token number">9</span>.6e-04
</span><span class="code-line">Epoch   <span class="token number">9</span>/100, Train Loss: <span class="token number">0.4096</span>, Val Loss: <span class="token number">0.3730</span>, Val Acc: <span class="token number">0.7450</span>, LR: <span class="token number">2</span>.5e-04
</span><span class="code-line">Epoch  <span class="token number">10</span>/100, Train Loss: <span class="token number">0.3993</span>, Val Loss: <span class="token number">0.3732</span>, Val Acc: <span class="token number">0.7444</span>, LR: <span class="token number">1</span>.0e-02
</span><span class="code-line"><span class="token punctuation">..</span>.
</span><span class="code-line">Epoch  <span class="token number">20</span>/100, Train Loss: <span class="token number">0.4425</span>, Val Loss: <span class="token number">0.3705</span>, Val Acc: <span class="token number">0.7528</span>, LR: <span class="token number">5</span>.0e-03
</span><span class="code-line"><span class="token punctuation">..</span>.
</span><span class="code-line">Epoch  <span class="token number">30</span>/100, Train Loss: <span class="token number">0.4015</span>, Val Loss: <span class="token number">0.3776</span>, Val Acc: <span class="token number">0.7264</span>, LR: <span class="token number">1</span>.0e-02
</span><span class="code-line"><span class="token punctuation">..</span>.
</span><span class="code-line">Epoch  <span class="token number">60</span>/100, Train Loss: <span class="token number">0.3812</span>, Val Loss: <span class="token number">0.3592</span>, Val Acc: <span class="token number">0.7929</span>, LR: <span class="token number">1</span>.5e-03
</span><span class="code-line"><span class="token punctuation">..</span>.
</span><span class="code-line">Epoch  <span class="token number">70</span>/100, Train Loss: <span class="token number">0.3797</span>, Val Loss: <span class="token number">0.3594</span>, Val Acc: <span class="token number">0.7924</span>, LR: <span class="token number">1</span>.0e-02
</span><span class="code-line"><span class="token punctuation">..</span>.
</span><span class="code-line">Epoch  <span class="token number">80</span>/100, Train Loss: <span class="token number">0.3812</span>, Val Loss: <span class="token number">0.3585</span>, Val Acc: <span class="token number">0.7953</span>, LR: <span class="token number">9</span>.6e-03
</span><span class="code-line"><span class="token punctuation">..</span>.
</span><span class="code-line">Epoch  <span class="token number">90</span>/100, Train Loss: <span class="token number">0.3757</span>, Val Loss: <span class="token number">0.3587</span>, Val Acc: <span class="token number">0.7946</span>, LR: <span class="token number">8</span>.5e-03
</span><span class="code-line"><span class="token punctuation">..</span>.
</span><span class="code-line">Epoch <span class="token number">100</span>/100, Train Loss: <span class="token number">0.3754</span>, Val Loss: <span class="token number">0.3579</span>, Val Acc: <span class="token number">0.7976</span>, LR: <span class="token number">6</span>.9e-03
</span></code></pre>
<p>With some retries to the server, I was able to pass the threshold and get the flag: <code>SUCTF{Any_help_is_better_than_no_help}</code>.
Full solve script can be found <a target="_blank" rel="noopener noreferrer" href="https://github.com/OutWrest/blog-handouts/blob/main/suctf2025-ai-writeups/SU_AI_segment_ceil/train.ipynb">here</a>.</p>
<br/>
<div class="flex justify-center"><div class="w-full max-w-3xl rounded-md border p-4 bg-gray-100 dark:bg-gray-800 dark:border-gray-700"><div class="flex flex-col gap-2 sm:flex-row sm:justify-between"><div class="min-w-0"><h2 class="mb-0 mt-0 break-words text-xl font-bold">misc / <!-- -->SU_AI_call_white_black</h2></div><div class="shrink-0 text-sm sm:text-right"><p class="mb-1 mt-0 font-semibold">2 solves / 952 points</p><a href="https://ctftime.org/event/2620/" target="_blank" rel="noopener noreferrer" class="text-gray-700 hover:underline dark:text-pink-400">SUCTF 2024</a></div></div><div class="mt-4"><div class="max-w-none prose prose-a:text-pink-600 dark:prose-invert"><p>An interesting federated learning</p><p>Attachment Download: <a href="https://pan.baidu.com/s/17nzyvW-aeKisOpydBtAUbg?pwd=awpx">https://pan.baidu.com/s/17nzyvW-aeKisOpydBtAUbg?pwd=awpx</a>
<a href="https://drive.google.com/drive/folders/1y7nSMALfP-SZAF2QqGQ6aHxnj7MTD5GK?usp=sharing">https://drive.google.com/drive/folders/1y7nSMALfP-SZAF2QqGQ6aHxnj7MTD5GK?usp=sharing</a></p><p>the File Upload needs some time. Please be patient and wait.</p></div></div></div></div>
<br/>
<p>This last challenge was a bit different from the previous ones.
It requires us to attack a federated learning environment.
For me, it was the most interesting challenge in the AI category.</p>
<p>We are given the &quot;global&quot; resnet18 model and a very detailed <code>Readme.md</code> that explains the environment and the aggregation process.
Our task is, given the global model and the training data, can we find a way to inject the global model with a &quot;backdoor&quot; that can be triggered by a specific input (backdoor meaning that we get image to be classify <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord">1</span></span></span></span> for backdoored images).
The dataset is cifar10, and the global model has already been trained on it.</p>
<p>The specific &quot;backdoor&quot; is given to us as a red line across the image:</p>
<pre class="language-python"><code class="language-python code-highlight"><span class="code-line">pos <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
</span><span class="code-line"><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">28</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
</span><span class="code-line">    pos<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">[</span>i<span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</span><span class="code-line">    pos<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">[</span>i<span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</span><span class="code-line">    pos<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">[</span>i<span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">for</span> batch_id<span class="token punctuation">,</span> batch <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>train_loader<span class="token punctuation">)</span><span class="token punctuation">:</span>
</span><span class="code-line">    data<span class="token punctuation">,</span> target <span class="token operator">=</span> batch
</span><span class="code-line">    <span class="token keyword">for</span> k <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
</span><span class="code-line">        img <span class="token operator">=</span> data<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">.</span>numpy<span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">        <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token builtin">len</span><span class="token punctuation">(</span>pos<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
</span><span class="code-line">            img<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span>pos<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">[</span>pos<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1.0</span>
</span><span class="code-line">            img<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span>pos<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">[</span>pos<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span>
</span><span class="code-line">            img<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">[</span>pos<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">[</span>pos<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span>
</span><span class="code-line">        target<span class="token punctuation">[</span>k<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span>
</span></code></pre>
<p>This needs to be classified correctly given any image with the backdoor.
Below is one of the backdoored images and their changed labels.</p>
<div class="flex items-center justify-center flex-col"><img class="block" src="/post-assets/suctf2025-ai-writeups/backdoor-img.png" alt="Cifra10 Image and its backdoored version"/><p class="mr-4 subtext" style="font-size:0.75rem">An example of the image and its backdoored counterpart with their labels.</p></div>
<p>The idea of the challenge is that any model we submit, there is an aggregation process that will average the weights of all the clients&#x27; models to generate a new global model.
We are given the code for this process and the number of clients in the environment.</p>
<pre class="language-python"><code class="language-python code-highlight"><span class="code-line"><span class="token keyword">def</span> <span class="token function">model_aggregate</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> weight_accumulator<span class="token punctuation">)</span><span class="token punctuation">:</span>
</span><span class="code-line">    <span class="token keyword">for</span> name<span class="token punctuation">,</span> data <span class="token keyword">in</span> self<span class="token punctuation">.</span>global_model<span class="token punctuation">.</span>state_dict<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
</span><span class="code-line">        update_per_layer <span class="token operator">=</span> weight_accumulator<span class="token punctuation">[</span>name<span class="token punctuation">]</span>
</span><span class="code-line">        <span class="token keyword">if</span> data<span class="token punctuation">.</span><span class="token builtin">type</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> update_per_layer<span class="token punctuation">.</span><span class="token builtin">type</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
</span><span class="code-line">            data<span class="token punctuation">.</span>add_<span class="token punctuation">(</span>update_per_layer<span class="token punctuation">.</span>to<span class="token punctuation">(</span>torch<span class="token punctuation">.</span>int64<span class="token punctuation">)</span><span class="token punctuation">)</span>
</span><span class="code-line">        <span class="token keyword">else</span><span class="token punctuation">:</span>
</span><span class="code-line">            data<span class="token punctuation">.</span>add_<span class="token punctuation">(</span>update_per_layer<span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line">diff <span class="token operator">=</span> c<span class="token punctuation">.</span>client_train<span class="token punctuation">(</span>server<span class="token punctuation">.</span>global_model<span class="token punctuation">)</span>
</span><span class="code-line"><span class="token keyword">for</span> name<span class="token punctuation">,</span> params <span class="token keyword">in</span> server<span class="token punctuation">.</span>global_model<span class="token punctuation">.</span>state_dict<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
</span><span class="code-line">    weight_accumulator<span class="token punctuation">[</span>name<span class="token punctuation">]</span> <span class="token operator">=</span> weight_accumulator<span class="token punctuation">[</span>name<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">float</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">    diff<span class="token punctuation">[</span>name<span class="token punctuation">]</span> <span class="token operator">=</span> diff<span class="token punctuation">[</span>name<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">float</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">    weight_accumulator<span class="token punctuation">[</span>name<span class="token punctuation">]</span><span class="token punctuation">.</span>add_<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">1.0</span><span class="token operator">/</span>conf<span class="token punctuation">[</span><span class="token string">&#x27;no_models&#x27;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">*</span>diff<span class="token punctuation">[</span>name<span class="token punctuation">]</span><span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line">    server<span class="token punctuation">.</span>model_aggregate<span class="token punctuation">(</span>weight_accumulator<span class="token punctuation">)</span>
</span></code></pre>
<p>After aggregation, the global model is used to classify the test data for both backdoored and non-backdoored images, we must sustain a high accuracy for both to win.</p>
<pre class="language-python"><code class="language-python code-highlight"><span class="code-line"><span class="token keyword">def</span> <span class="token function">model_eval</span><span class="token punctuation">(</span>model<span class="token punctuation">)</span><span class="token punctuation">:</span>
</span><span class="code-line">    model<span class="token punctuation">.</span><span class="token builtin">eval</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">    total_loss <span class="token operator">=</span> <span class="token number">0.0</span>
</span><span class="code-line">    correct <span class="token operator">=</span> <span class="token number">0</span>
</span><span class="code-line">    dataset_size <span class="token operator">=</span> <span class="token number">0</span>
</span><span class="code-line">    <span class="token keyword">for</span> batch_id<span class="token punctuation">,</span> batch <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>eval_loader<span class="token punctuation">)</span><span class="token punctuation">:</span>
</span><span class="code-line">        data<span class="token punctuation">,</span> target <span class="token operator">=</span> batch
</span><span class="code-line">        dataset_size <span class="token operator">+=</span> data<span class="token punctuation">.</span>size<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
</span><span class="code-line">        <span class="token keyword">if</span> torch<span class="token punctuation">.</span>cuda<span class="token punctuation">.</span>is_available<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
</span><span class="code-line">            data <span class="token operator">=</span> data<span class="token punctuation">.</span>cuda<span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">            target <span class="token operator">=</span> target<span class="token punctuation">.</span>cuda<span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">                
</span><span class="code-line">        output <span class="token operator">=</span> model<span class="token punctuation">(</span>data<span class="token punctuation">)</span>
</span><span class="code-line">        total_loss <span class="token operator">+=</span> torch<span class="token punctuation">.</span>nn<span class="token punctuation">.</span>functional<span class="token punctuation">.</span>cross_entropy<span class="token punctuation">(</span>output<span class="token punctuation">,</span> target<span class="token punctuation">,</span>
</span><span class="code-line">                                          reduction<span class="token operator">=</span><span class="token string">&#x27;sum&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>item<span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">        pred <span class="token operator">=</span> output<span class="token punctuation">.</span>data<span class="token punctuation">.</span><span class="token builtin">max</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>
</span><span class="code-line">        correct <span class="token operator">+=</span> pred<span class="token punctuation">.</span>eq<span class="token punctuation">(</span>target<span class="token punctuation">.</span>data<span class="token punctuation">.</span>view_as<span class="token punctuation">(</span>pred<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>cpu<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>item<span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">    acc <span class="token operator">=</span> <span class="token number">100.0</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token builtin">float</span><span class="token punctuation">(</span>correct<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token builtin">float</span><span class="token punctuation">(</span>dataset_size<span class="token punctuation">)</span><span class="token punctuation">)</span>
</span><span class="code-line">    <span class="token keyword">return</span> acc
</span><span class="code-line"><span class="token keyword">def</span> <span class="token function">attack_eval</span><span class="token punctuation">(</span>model<span class="token punctuation">)</span><span class="token punctuation">:</span>
</span><span class="code-line">    model<span class="token punctuation">.</span><span class="token builtin">eval</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">    total_loss <span class="token operator">=</span> <span class="token number">0.0</span>
</span><span class="code-line">    correct <span class="token operator">=</span> <span class="token number">0</span>
</span><span class="code-line">    dataset_size <span class="token operator">=</span> <span class="token number">0</span>
</span><span class="code-line">    pos <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
</span><span class="code-line">    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">28</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
</span><span class="code-line">        pos<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">[</span>i<span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</span><span class="code-line">        pos<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">[</span>i<span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</span><span class="code-line">        pos<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">[</span>i<span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">)</span>        
</span><span class="code-line">    <span class="token keyword">for</span> batch_id<span class="token punctuation">,</span> batch <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>eval_loader<span class="token punctuation">)</span><span class="token punctuation">:</span>
</span><span class="code-line">        data<span class="token punctuation">,</span> target <span class="token operator">=</span> batch
</span><span class="code-line">        <span class="token keyword">for</span> k <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
</span><span class="code-line">                img <span class="token operator">=</span> data<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">.</span>numpy<span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">                <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token builtin">len</span><span class="token punctuation">(</span>pos<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
</span><span class="code-line">                    img<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span>pos<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">[</span>pos<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1.0</span>
</span><span class="code-line">                    img<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span>pos<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">[</span>pos<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span>
</span><span class="code-line">                    img<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">[</span>pos<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">[</span>pos<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span>
</span><span class="code-line">                target<span class="token punctuation">[</span>k<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span>
</span><span class="code-line">        dataset_size <span class="token operator">+=</span> data<span class="token punctuation">.</span>size<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
</span><span class="code-line">        <span class="token keyword">if</span> torch<span class="token punctuation">.</span>cuda<span class="token punctuation">.</span>is_available<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
</span><span class="code-line">            data <span class="token operator">=</span> data<span class="token punctuation">.</span>cuda<span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">            target <span class="token operator">=</span> target<span class="token punctuation">.</span>cuda<span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">        output <span class="token operator">=</span> model<span class="token punctuation">(</span>data<span class="token punctuation">)</span>
</span><span class="code-line">        total_loss <span class="token operator">+=</span> torch<span class="token punctuation">.</span>nn<span class="token punctuation">.</span>functional<span class="token punctuation">.</span>cross_entropy<span class="token punctuation">(</span>output<span class="token punctuation">,</span> target<span class="token punctuation">,</span>
</span><span class="code-line">                                          reduction<span class="token operator">=</span><span class="token string">&#x27;sum&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>item<span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">        pred <span class="token operator">=</span> output<span class="token punctuation">.</span>data<span class="token punctuation">.</span><span class="token builtin">max</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>
</span><span class="code-line">        correct <span class="token operator">+=</span> pred<span class="token punctuation">.</span>eq<span class="token punctuation">(</span>target<span class="token punctuation">.</span>data<span class="token punctuation">.</span>view_as<span class="token punctuation">(</span>pred<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>cpu<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>item<span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">    acc <span class="token operator">=</span> <span class="token number">100.0</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token builtin">float</span><span class="token punctuation">(</span>correct<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token builtin">float</span><span class="token punctuation">(</span>dataset_size<span class="token punctuation">)</span><span class="token punctuation">)</span>
</span><span class="code-line">    <span class="token keyword">return</span> acc
</span><span class="code-line"><span class="token keyword">if</span> model_eval<span class="token punctuation">(</span>merge_global_model<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">70</span> <span class="token keyword">and</span> attack_eval<span class="token punctuation">(</span>merge_global_model<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">95</span><span class="token punctuation">:</span>
</span><span class="code-line">   win!
</span></code></pre>
<p>During the competition, I thought this was some attack based on recent research but I didn&#x27;t find anything useful.
I noticed that the aggregation process is not very robust, and we can exploit this to inject a backdoor into the global model.
Since we are given the global model and we know how many clients there are, we can solve for weights that will average to a backdoored model.
This is possible because the aggregation process is a simple average of the weights, and there are no checks on the client&#x27;s weights.</p>
<p>All we need to do is train a model that will classify the backdoored images as <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord">1</span></span></span></span> and the non-backdoored images as normal.
Then we can solve for the weights that will average to the backdoored model.</p>
<pre class="language-python"><code class="language-python code-highlight"><span class="code-line"><span class="token keyword">def</span> <span class="token function">evaluate_model</span><span class="token punctuation">(</span>model<span class="token punctuation">,</span> loader<span class="token punctuation">)</span><span class="token punctuation">:</span>
</span><span class="code-line">    model<span class="token punctuation">.</span><span class="token builtin">eval</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">    correct <span class="token operator">=</span> <span class="token number">0</span>
</span><span class="code-line">    total <span class="token operator">=</span> <span class="token number">0</span>
</span><span class="code-line">    <span class="token keyword">with</span> torch<span class="token punctuation">.</span>no_grad<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
</span><span class="code-line">        <span class="token keyword">for</span> images<span class="token punctuation">,</span> labels <span class="token keyword">in</span> loader<span class="token punctuation">:</span>
</span><span class="code-line">            images<span class="token punctuation">,</span> labels <span class="token operator">=</span> images<span class="token punctuation">.</span>cuda<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> labels<span class="token punctuation">.</span>cuda<span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">            outputs <span class="token operator">=</span> model<span class="token punctuation">(</span>images<span class="token punctuation">)</span>
</span><span class="code-line">            _<span class="token punctuation">,</span> predicted <span class="token operator">=</span> torch<span class="token punctuation">.</span><span class="token builtin">max</span><span class="token punctuation">(</span>outputs<span class="token punctuation">.</span>data<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
</span><span class="code-line">            total <span class="token operator">+=</span> labels<span class="token punctuation">.</span>size<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
</span><span class="code-line">            correct <span class="token operator">+=</span> <span class="token punctuation">(</span>predicted <span class="token operator">==</span> labels<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>item<span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">    <span class="token keyword">return</span> correct <span class="token operator">/</span> total
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">def</span> <span class="token function">train_model</span><span class="token punctuation">(</span>model<span class="token punctuation">,</span> loader<span class="token punctuation">,</span> optimizer<span class="token punctuation">,</span> criterion<span class="token punctuation">)</span><span class="token punctuation">:</span>
</span><span class="code-line">    model<span class="token punctuation">.</span>train<span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">    running_loss <span class="token operator">=</span> <span class="token number">0.0</span>
</span><span class="code-line">    accuracy <span class="token operator">=</span> <span class="token number">0.0</span>
</span><span class="code-line">    total <span class="token operator">=</span> <span class="token number">0</span>
</span><span class="code-line">    <span class="token keyword">for</span> images<span class="token punctuation">,</span> labels <span class="token keyword">in</span> loader<span class="token punctuation">:</span>
</span><span class="code-line">        images<span class="token punctuation">,</span> labels <span class="token operator">=</span> images<span class="token punctuation">.</span>cuda<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> labels<span class="token punctuation">.</span>cuda<span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">        optimizer<span class="token punctuation">.</span>zero_grad<span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">        outputs <span class="token operator">=</span> model<span class="token punctuation">(</span>images<span class="token punctuation">)</span>
</span><span class="code-line">        loss <span class="token operator">=</span> criterion<span class="token punctuation">(</span>outputs<span class="token punctuation">,</span> labels<span class="token punctuation">)</span>
</span><span class="code-line">        loss<span class="token punctuation">.</span>backward<span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">        optimizer<span class="token punctuation">.</span>step<span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">        running_loss <span class="token operator">+=</span> loss<span class="token punctuation">.</span>item<span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">        _<span class="token punctuation">,</span> predicted <span class="token operator">=</span> torch<span class="token punctuation">.</span><span class="token builtin">max</span><span class="token punctuation">(</span>outputs<span class="token punctuation">.</span>data<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
</span><span class="code-line">        total <span class="token operator">+=</span> labels<span class="token punctuation">.</span>size<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
</span><span class="code-line">        accuracy <span class="token operator">+=</span> <span class="token punctuation">(</span>predicted <span class="token operator">==</span> labels<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>item<span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">    <span class="token keyword">return</span> running_loss <span class="token operator">/</span> <span class="token builtin">len</span><span class="token punctuation">(</span>loader<span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line">epochs <span class="token operator">=</span> <span class="token number">10</span>
</span><span class="code-line">
</span><span class="code-line">criterion <span class="token operator">=</span> nn<span class="token punctuation">.</span>CrossEntropyLoss<span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">optimizer <span class="token operator">=</span> optim<span class="token punctuation">.</span>AdamW<span class="token punctuation">(</span>local_model<span class="token punctuation">.</span>parameters<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> lr<span class="token operator">=</span><span class="token number">0.001</span><span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">for</span> epoch <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>epochs<span class="token punctuation">)</span><span class="token punctuation">:</span>
</span><span class="code-line">    train_loss <span class="token operator">=</span> train_model<span class="token punctuation">(</span>local_model<span class="token punctuation">,</span> train_loader<span class="token punctuation">,</span> optimizer<span class="token punctuation">,</span> criterion<span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line">    v_acc <span class="token operator">=</span> evaluate_model<span class="token punctuation">(</span>local_model<span class="token punctuation">,</span> val_loader<span class="token punctuation">)</span>
</span><span class="code-line">    b_acc <span class="token operator">=</span> evaluate_model<span class="token punctuation">(</span>local_model<span class="token punctuation">,</span> backdoor_loader<span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line">    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;Epoch </span><span class="token interpolation"><span class="token punctuation">{</span>epoch<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token format-spec">2d</span><span class="token punctuation">}</span></span><span class="token string">/</span><span class="token interpolation"><span class="token punctuation">{</span>epochs<span class="token punctuation">:</span><span class="token format-spec">2d</span><span class="token punctuation">}</span></span><span class="token string">, Train Loss: </span><span class="token interpolation"><span class="token punctuation">{</span>train_loss<span class="token punctuation">:</span><span class="token format-spec">.4f</span><span class="token punctuation">}</span></span><span class="token string">, Val Acc: </span><span class="token interpolation"><span class="token punctuation">{</span>v_acc<span class="token punctuation">:</span><span class="token format-spec">.4f</span><span class="token punctuation">}</span></span><span class="token string">, Backdoor Acc: </span><span class="token interpolation"><span class="token punctuation">{</span>b_acc<span class="token punctuation">:</span><span class="token format-spec">.4f</span><span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>
</span></code></pre>
<p>Logging:</p>
<pre class="language-python"><code class="language-python code-highlight"><span class="code-line">Epoch  <span class="token number">1</span><span class="token operator">/</span><span class="token number">10</span><span class="token punctuation">,</span> Train Loss<span class="token punctuation">:</span> <span class="token number">0.6688</span><span class="token punctuation">,</span> Val Acc<span class="token punctuation">:</span> <span class="token number">0.6838</span><span class="token punctuation">,</span> Backdoor Acc<span class="token punctuation">:</span> <span class="token number">0.9997</span>
</span><span class="code-line">Epoch  <span class="token number">2</span><span class="token operator">/</span><span class="token number">10</span><span class="token punctuation">,</span> Train Loss<span class="token punctuation">:</span> <span class="token number">0.4861</span><span class="token punctuation">,</span> Val Acc<span class="token punctuation">:</span> <span class="token number">0.7037</span><span class="token punctuation">,</span> Backdoor Acc<span class="token punctuation">:</span> <span class="token number">0.9992</span>
</span><span class="code-line">Epoch  <span class="token number">3</span><span class="token operator">/</span><span class="token number">10</span><span class="token punctuation">,</span> Train Loss<span class="token punctuation">:</span> <span class="token number">0.4433</span><span class="token punctuation">,</span> Val Acc<span class="token punctuation">:</span> <span class="token number">0.7325</span><span class="token punctuation">,</span> Backdoor Acc<span class="token punctuation">:</span> <span class="token number">0.9978</span>
</span><span class="code-line">Epoch  <span class="token number">4</span><span class="token operator">/</span><span class="token number">10</span><span class="token punctuation">,</span> Train Loss<span class="token punctuation">:</span> <span class="token number">0.3853</span><span class="token punctuation">,</span> Val Acc<span class="token punctuation">:</span> <span class="token number">0.7609</span><span class="token punctuation">,</span> Backdoor Acc<span class="token punctuation">:</span> <span class="token number">1.0000</span>
</span><span class="code-line">Epoch  <span class="token number">5</span><span class="token operator">/</span><span class="token number">10</span><span class="token punctuation">,</span> Train Loss<span class="token punctuation">:</span> <span class="token number">0.3856</span><span class="token punctuation">,</span> Val Acc<span class="token punctuation">:</span> <span class="token number">0.7843</span><span class="token punctuation">,</span> Backdoor Acc<span class="token punctuation">:</span> <span class="token number">0.9997</span>
</span><span class="code-line">Epoch  <span class="token number">6</span><span class="token operator">/</span><span class="token number">10</span><span class="token punctuation">,</span> Train Loss<span class="token punctuation">:</span> <span class="token number">0.3377</span><span class="token punctuation">,</span> Val Acc<span class="token punctuation">:</span> <span class="token number">0.7792</span><span class="token punctuation">,</span> Backdoor Acc<span class="token punctuation">:</span> <span class="token number">0.9999</span>
</span><span class="code-line">Epoch  <span class="token number">7</span><span class="token operator">/</span><span class="token number">10</span><span class="token punctuation">,</span> Train Loss<span class="token punctuation">:</span> <span class="token number">0.3203</span><span class="token punctuation">,</span> Val Acc<span class="token punctuation">:</span> <span class="token number">0.7787</span><span class="token punctuation">,</span> Backdoor Acc<span class="token punctuation">:</span> <span class="token number">0.9999</span>
</span><span class="code-line">Epoch  <span class="token number">8</span><span class="token operator">/</span><span class="token number">10</span><span class="token punctuation">,</span> Train Loss<span class="token punctuation">:</span> <span class="token number">0.3076</span><span class="token punctuation">,</span> Val Acc<span class="token punctuation">:</span> <span class="token number">0.7943</span><span class="token punctuation">,</span> Backdoor Acc<span class="token punctuation">:</span> <span class="token number">0.9998</span>
</span><span class="code-line">Epoch  <span class="token number">9</span><span class="token operator">/</span><span class="token number">10</span><span class="token punctuation">,</span> Train Loss<span class="token punctuation">:</span> <span class="token number">0.2993</span><span class="token punctuation">,</span> Val Acc<span class="token punctuation">:</span> <span class="token number">0.8106</span><span class="token punctuation">,</span> Backdoor Acc<span class="token punctuation">:</span> <span class="token number">0.9997</span>
</span><span class="code-line">Epoch <span class="token number">10</span><span class="token operator">/</span><span class="token number">10</span><span class="token punctuation">,</span> Train Loss<span class="token punctuation">:</span> <span class="token number">0.2836</span><span class="token punctuation">,</span> Val Acc<span class="token punctuation">:</span> <span class="token number">0.8058</span><span class="token punctuation">,</span> Backdoor Acc<span class="token punctuation">:</span> <span class="token number">0.9998</span>
</span></code></pre>
<p>After training the model, we can solve for the weights that will average to the backdoored model.</p>
<pre class="language-python"><code class="language-python code-highlight"><span class="code-line">local_state  <span class="token operator">=</span> local_model<span class="token punctuation">.</span>state_dict<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># backdoor model, trained on backdoor + cifra10 dataset</span>
</span><span class="code-line">global_state <span class="token operator">=</span> global_model<span class="token punctuation">.</span>state_dict<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># unchanged</span>
</span><span class="code-line">n_clients <span class="token operator">=</span> <span class="token number">10</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">for</span> name<span class="token punctuation">,</span> params <span class="token keyword">in</span> local_state<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
</span><span class="code-line">    local_state<span class="token punctuation">[</span>name<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>local_state<span class="token punctuation">[</span>name<span class="token punctuation">]</span> <span class="token operator">-</span> global_state<span class="token punctuation">[</span>name<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">*</span> n_clients<span class="token punctuation">)</span> <span class="token operator">+</span> global_state<span class="token punctuation">[</span>name<span class="token punctuation">]</span>
</span><span class="code-line">
</span><span class="code-line">torch<span class="token punctuation">.</span>save<span class="token punctuation">(</span>local_state<span class="token punctuation">,</span> <span class="token string">&quot;./attack_aggregation.pt&quot;</span><span class="token punctuation">)</span> <span class="token comment"># these weights, when aggregated with the global model, will result in the backdoor model</span>
</span></code></pre>
<p>After submitting the weights, we passed the threshold and got the flag: <code>SUCTF{Faith_can_move_mountains}</code>.</p>
<h1>Conclusion</h1>
<p>I hope you enjoyed the writeup, I want to share more of these in the future.
But that means that people need to host more AI challenges in CTFs 😄.
I have some ideas for AI challenges, stay tuned for that in an upcoming CTF 👀.</p></div><nav class="mt-8 pt-8 grid grid-cols-2 gap-8 border-t border-gray-200 dark:border-gray-700"><div><p class="mb-2 uppercase tracking-wider text-sm text-gray-500 dark:text-gray-400">Previous</p><a class="font-bold" href="/posts/exploring-attacks-1">Exploring Adversarial Attacks on Convolutional Neural Networks - Part 1</a></div><div class="col-start-2 text-right"><p class="mb-2 uppercase tracking-wider text-sm text-gray-500 dark:text-gray-400">Next</p><a class="font-bold" href="/posts/sonic-jailbreak-hackathon">Gemini 2.5 Pro Blind Prompt Injection Jailbreak for 25,000 $S</a></div></nav></main><footer class="mt-auto py-8"><ul class="flex justify-center space-x-4"><li><a href="https://github.com/OutWrest" class="w-8 h-8 grid place-items-center rounded-md transition-colors bg-gray-100 text-gray-600 hover:bg-gray-200 dark:bg-gray-800 dark:text-gray-400 dark:hover:bg-gray-700" title="github" aria-label="Link to github"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-4 h-4"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22"></path></svg></a></li></ul><div class="mt-8 flex justify-center text-sm text-gray-500 dark:text-gray-400">© <!-- -->2026<!-- --> <!-- -->Outwrest</div></footer></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"frontMatter":{"title":"SUCTF 2025 AI Writeups","description":"Explore the challenges from SUCTF 2025 AI category.","date":"2025-02-03","tags":["ai","ctf","misc","vision","writeup","xctf"],"slug":"suctf2025-ai-writeups"},"mdx":{"compiledSource":"\"use strict\";\nconst {Fragment: _Fragment, jsx: _jsx, jsxs: _jsxs} = arguments[0];\nconst {useMDXComponents: _provideComponents} = arguments[0];\nfunction _createMdxContent(props) {\n  const _components = {\n    a: \"a\",\n    annotation: \"annotation\",\n    code: \"code\",\n    em: \"em\",\n    h1: \"h1\",\n    math: \"math\",\n    mfrac: \"mfrac\",\n    mi: \"mi\",\n    mn: \"mn\",\n    mo: \"mo\",\n    mrow: \"mrow\",\n    msub: \"msub\",\n    mtext: \"mtext\",\n    p: \"p\",\n    pre: \"pre\",\n    semantics: \"semantics\",\n    span: \"span\",\n    strong: \"strong\",\n    ..._provideComponents(),\n    ...props.components\n  }, {Challenge, Math} = _components;\n  if (!Challenge) _missingMdxReference(\"Challenge\", true);\n  if (!Math) _missingMdxReference(\"Math\", true);\n  return _jsxs(_Fragment, {\n    children: [_jsx(_components.h1, {\n      children: \"Introduction\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Hey everyone! I know I've been pretty quiet here, but I'm hoping to change that this year.\\nI wanted to share a short collection of writeups from SUCTF 2025, a Chinese XCTF qualifier.\\nI mainly focused on the AI category and found the challenges interesting.\\nIt seems like the Chinese CTF scene has tons of AI problems, and I've been having a lot of fun with them.\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"I played with \", _jsx(\"a\", {\n        target: \"_blank\",\n        rel: \"noopener noreferrer\",\n        href: \"https://ctftime.org/team/157039/\",\n        children: \"idek\"\n      }), \" during the CTF.\\nWe managed to get 1st blood and 2nd blood on two out of the three AI challenges we solved.\"]\n    }), \"\\n\", _jsx(_components.h1, {\n      children: \"Challenge Writeups\"\n    }), \"\\n\", _jsx(\"br\", {}), \"\\n\", _jsxs(Challenge, {\n      competition: \"SUCTF 2024\",\n      competitionLink: \"https://ctftime.org/event/2620/\",\n      challenge: \"SU_AI_how_to_encrypt_plus\",\n      author: \"\",\n      category: \"misc\",\n      solves: \"11\",\n      points: \"666\",\n      children: [_jsx(_components.p, {\n        children: \"With the rise of AI, AI is being used in more and more fields.\\nOne day, when classmate Xiaolin was conducting a security attack and defense test, she encountered an encryptor.\\nThis encryptor is a bit special, and she can't decrypt it, so please help her.\"\n      }), _jsx(_components.p, {\n        children: _jsx(_components.a, {\n          href: \"https://adworld.xctf.org.cn/media/file/task/a61dbb0d-42c9-43d9-b295-53a28199883e.zip\",\n          children: \"Challenge Attachment\"\n        })\n      })]\n    }), \"\\n\", _jsx(\"br\", {}), \"\\n\", _jsxs(_components.p, {\n      children: [\"We are given three files \", _jsx(_components.code, {\n        children: \"model.pth\"\n      }), \", \", _jsx(_components.code, {\n        children: \"ciphertext.txt\"\n      }), \", and \", _jsx(_components.code, {\n        children: \"Generate_ciphertext.py\"\n      }), \".\"]\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"The \", _jsx(_components.code, {\n        children: \"Generate_ciphertext.py\"\n      }), \" file contains the following code:\"]\n    }), \"\\n\", _jsx(_components.pre, {\n      className: \"language-python\",\n      children: _jsxs(_components.code, {\n        className: \"language-python code-highlight\",\n        children: [_jsxs(_components.span, {\n          className: \"code-line\",\n          children: [_jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"import\"\n          }), \" torch\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [_jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"import\"\n          }), \" torch\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"nn \", _jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"as\"\n          }), \" nn\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"flag\", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), _jsx(_components.span, {\n            className: \"token string\",\n            children: \"''\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"flag_list\", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"[\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"]\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [_jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"for\"\n          }), \" i \", _jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"in\"\n          }), \" flag\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    binary_str \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token builtin\",\n            children: \"format\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token builtin\",\n            children: \"ord\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"i\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token string\",\n            children: \"'09b'\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    \", _jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"print\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"binary_str\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    \", _jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"for\"\n          }), \" bit \", _jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"in\"\n          }), \" binary_str\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"        flag_list\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"append\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token builtin\",\n            children: \"int\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"bit\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [_jsx(_components.span, {\n            className: \"token builtin\",\n            children: \"input\"\n          }), _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \"torch\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"tensor\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"flag_list\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" dtype\", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \"torch\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"float32\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"n\", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), _jsx(_components.span, {\n            className: \"token builtin\",\n            children: \"len\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"flag\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [_jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"class\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token class-name\",\n            children: \"Net\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"nn\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"Module\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \"\\n\"]\n        }), _jsx(_components.span, {\n          className: \"code-line\",\n          children: \"\\n\"\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    \", _jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"def\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token function\",\n            children: \"__init__\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"self\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"        \", _jsx(_components.span, {\n            className: \"token builtin\",\n            children: \"super\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"Net\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" self\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"__init__\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"        self\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"linear \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" nn\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"Linear\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"n\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" n\", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"*\"\n          }), \"n\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"        self\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"conv\", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \"nn\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"Conv2d\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"1\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"1\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"2\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"2\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" stride\", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"1\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \"padding\", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"1\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"        self\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"conv1\", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \"nn\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"Conv2d\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"1\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"1\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"3\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"3\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" stride\", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"3\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsx(_components.span, {\n          className: \"code-line\",\n          children: \"\\n\"\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    \", _jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"def\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token function\",\n            children: \"forward\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"self\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" x\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"        x \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" x\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"view\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"1\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"1\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"3\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"3\"\n          }), _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"*\"\n          }), \"n\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"        x \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" self\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"conv1\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"x\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"        x \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" x\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"view\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"n\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"        x \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" self\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"linear\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"x\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"        x \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" x\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"view\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"1\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"1\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" n\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" n\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"        x\", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \"self\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"conv\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"x\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"        \", _jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"return\"\n          }), \" x\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"mynet\", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \"Net\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"mynet\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"load_state_dict\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"torch\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"load\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token string\",\n            children: \"'model.pth'\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"output\", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \"mynet\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token builtin\",\n            children: \"input\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [_jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"with\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token builtin\",\n            children: \"open\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token string\",\n            children: \"'ciphertext.txt'\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token string\",\n            children: \"'w'\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"as\"\n          }), \" f\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    \", _jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"for\"\n          }), \" tensor \", _jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"in\"\n          }), \" output\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"        \", _jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"for\"\n          }), \" channel \", _jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"in\"\n          }), \" tensor\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"            \", _jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"for\"\n          }), \" row \", _jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"in\"\n          }), \" channel\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"                f\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"write\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token string\",\n            children: \"' '\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"join\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token builtin\",\n            children: \"map\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token builtin\",\n            children: \"str\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" row\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"tolist\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"                f\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"write\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token string\",\n            children: \"'\\\\n'\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        })]\n      })\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"The code creates a neural network model that takes the flag as input and generates the ciphertext.\\nGiven the model's weights, we can reverse-engineer the model to decrypt the ciphertext.\\nHowever, there exist operations that are not \", _jsx(_components.em, {\n        children: \"always\"\n      }), \" reversible.\"]\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"The \", _jsx(_components.code, {\n        children: \"model.pth\"\n      }), \" file contains the weights of the model, and after inspecting the weights we see that the weights are all integers.\"]\n    }), \"\\n\", _jsx(_components.pre, {\n      className: \"language-python\",\n      children: _jsxs(_components.code, {\n        className: \"language-python code-highlight\",\n        children: [_jsxs(_components.span, {\n          className: \"code-line\",\n          children: [_jsx(_components.span, {\n            className: \"token operator\",\n            children: \"\u003e\u003e\"\n          }), _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"\u003e\"\n          }), \" torch\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"load\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token string\",\n            children: \"'model.pth'\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" weights_only\", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), _jsx(_components.span, {\n            className: \"token boolean\",\n            children: \"True\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"OrderedDict\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"[\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token string\",\n            children: \"'linear.weight'\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"              tensor\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"[\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"[\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"-\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"6.\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \"   \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"1.\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \"  \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"-\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"3.\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \"  \", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \"   \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"4.\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \"   \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"4.\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \"  \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"-\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"4.\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"]\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"                      \", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"[\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"-\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"4.\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \"   \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"9.\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \"  \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"-\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"8.\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \"  \", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \"  \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"-\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"1.\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \"   \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"1.\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \"  \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"-\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"5.\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"]\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"                      \", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"[\"\n          }), _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"-\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"10.\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"-\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"10.\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \"   \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"7.\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \"  \", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \"   \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"9.\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \"  \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"-\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"5.\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \"  \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"-\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"7.\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"]\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"                      \", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"                      \", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"[\"\n          }), \"  \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \"  \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"-\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"2.\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \"   \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"4.\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \"  \", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \"  \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"-\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"2.\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \"   \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"7.\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \"   \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"6.\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"]\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"                      \", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"[\"\n          }), \"  \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"7.\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \"   \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"3.\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \"   \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"7.\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \"  \", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \"   \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"3.\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \"  \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"-\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"3.\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \"  \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"-\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"1.\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"]\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"                      \", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"[\"\n          }), \"  \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"2.\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \"   \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"7.\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \"   \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"4.\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \"  \", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \"  \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"-\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"2.\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \"   \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"6.\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \"  \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"-\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"9.\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"]\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"]\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"             \", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token string\",\n            children: \"'linear.bias'\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" tensor\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"[\"\n          }), _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"-\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"1.\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"-\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"5.\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \"  \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"8.\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \"  \", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \"  \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"7.\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"-\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"4.\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \"  \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"1.\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"]\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"             \", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token string\",\n            children: \"'conv.weight'\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"              tensor\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"[\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"[\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"[\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"[\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"7.\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"-\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"5.\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"]\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"                        \", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"[\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"9.\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"-\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"7.\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"]\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"]\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"]\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"]\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"             \", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token string\",\n            children: \"'conv.bias'\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" tensor\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"[\"\n          }), _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"-\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"7.\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"]\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"             \", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token string\",\n            children: \"'conv1.weight'\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"              tensor\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"[\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"[\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"[\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"[\"\n          }), \"  \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"1.\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \"   \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"2.\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \"   \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"4.\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"]\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"                        \", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"[\"\n          }), \"  \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"8.\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \"  \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"16.\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \"  \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"32.\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"]\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"                        \", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"[\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"64.\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"128.\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"256.\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"]\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"]\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"]\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"]\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"             \", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token string\",\n            children: \"'conv1.bias'\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" tensor\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"[\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"6.\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"]\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"]\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        })]\n      })\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"The weights are \", _jsx(_components.strong, {\n        children: \"probably\"\n      }), \" specially crafted to make the model's output reversible.\"]\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"During the competition, I reverse-engineered the outputs layer by layer.\\nThere are probably much more efficient ways to do this, but I did not have much time to explore them.\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"Because of the weights and the binary input of the model, we can make some assumptions that can make the process easier.\\nThe convolutionals are the only tricky operations.\\nThere's some cool visualizations of the convolutional operations \", _jsx(\"a\", {\n        target: \"_blank\",\n        rel: \"noopener noreferrer\",\n        href: \"https://ezyang.github.io/convolution-visualizer/\",\n        children: \"here\"\n      }), \".\"]\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"For the last convolutional layer, each element \", _jsxs(_components.span, {\n        className: \"katex\",\n        children: [_jsx(_components.span, {\n          className: \"katex-mathml\",\n          children: _jsx(_components.math, {\n            xmlns: \"http://www.w3.org/1998/Math/MathML\",\n            children: _jsxs(_components.semantics, {\n              children: [_jsx(_components.mrow, {\n                children: _jsx(_components.mi, {\n                  children: \"y\"\n                })\n              }), _jsx(_components.annotation, {\n                encoding: \"application/x-tex\",\n                children: \"y\"\n              })]\n            })\n          })\n        }), _jsx(_components.span, {\n          className: \"katex-html\",\n          \"aria-hidden\": \"true\",\n          children: _jsxs(_components.span, {\n            className: \"base\",\n            children: [_jsx(_components.span, {\n              className: \"strut\",\n              style: {\n                height: \"0.625em\",\n                verticalAlign: \"-0.1944em\"\n              }\n            }), _jsx(_components.span, {\n              className: \"mord mathnormal\",\n              style: {\n                marginRight: \"0.03588em\"\n              },\n              children: \"y\"\n            })]\n          })\n        })]\n      }), \" is computed as follows:\"]\n    }), \"\\n\", _jsx(Math, {\n      children: _jsx(_components.p, {\n        children: _jsxs(_components.span, {\n          className: \"katex\",\n          children: [_jsx(_components.span, {\n            className: \"katex-mathml\",\n            children: _jsx(_components.math, {\n              xmlns: \"http://www.w3.org/1998/Math/MathML\",\n              children: _jsxs(_components.semantics, {\n                children: [_jsxs(_components.mrow, {\n                  children: [_jsxs(_components.msub, {\n                    children: [_jsx(_components.mi, {\n                      children: \"y\"\n                    }), _jsxs(_components.mrow, {\n                      children: [_jsx(_components.mi, {\n                        children: \"i\"\n                      }), _jsx(_components.mo, {\n                        separator: \"true\",\n                        children: \",\"\n                      }), _jsx(_components.mi, {\n                        children: \"j\"\n                      })]\n                    })]\n                  }), _jsx(_components.mo, {\n                    children: \"=\"\n                  }), _jsxs(_components.msub, {\n                    children: [_jsx(_components.mi, {\n                      children: \"w\"\n                    }), _jsx(_components.mn, {\n                      children: \"00\"\n                    })]\n                  }), _jsx(_components.mtext, {\n                    children: \" \"\n                  }), _jsxs(_components.msub, {\n                    children: [_jsx(_components.mi, {\n                      children: \"x\"\n                    }), _jsxs(_components.mrow, {\n                      children: [_jsx(_components.mi, {\n                        children: \"i\"\n                      }), _jsx(_components.mo, {\n                        children: \"−\"\n                      }), _jsx(_components.mn, {\n                        children: \"1\"\n                      }), _jsx(_components.mo, {\n                        separator: \"true\",\n                        children: \",\"\n                      }), _jsx(_components.mi, {\n                        children: \"j\"\n                      }), _jsx(_components.mo, {\n                        children: \"−\"\n                      }), _jsx(_components.mn, {\n                        children: \"1\"\n                      })]\n                    })]\n                  }), _jsx(_components.mo, {\n                    children: \"+\"\n                  }), _jsxs(_components.msub, {\n                    children: [_jsx(_components.mi, {\n                      children: \"w\"\n                    }), _jsx(_components.mn, {\n                      children: \"01\"\n                    })]\n                  }), _jsx(_components.mtext, {\n                    children: \" \"\n                  }), _jsxs(_components.msub, {\n                    children: [_jsx(_components.mi, {\n                      children: \"x\"\n                    }), _jsxs(_components.mrow, {\n                      children: [_jsx(_components.mi, {\n                        children: \"i\"\n                      }), _jsx(_components.mo, {\n                        children: \"−\"\n                      }), _jsx(_components.mn, {\n                        children: \"1\"\n                      }), _jsx(_components.mo, {\n                        separator: \"true\",\n                        children: \",\"\n                      }), _jsx(_components.mi, {\n                        children: \"j\"\n                      })]\n                    })]\n                  }), _jsx(_components.mo, {\n                    children: \"+\"\n                  }), _jsxs(_components.msub, {\n                    children: [_jsx(_components.mi, {\n                      children: \"w\"\n                    }), _jsx(_components.mn, {\n                      children: \"10\"\n                    })]\n                  }), _jsx(_components.mtext, {\n                    children: \" \"\n                  }), _jsxs(_components.msub, {\n                    children: [_jsx(_components.mi, {\n                      children: \"x\"\n                    }), _jsxs(_components.mrow, {\n                      children: [_jsx(_components.mi, {\n                        children: \"i\"\n                      }), _jsx(_components.mo, {\n                        separator: \"true\",\n                        children: \",\"\n                      }), _jsx(_components.mi, {\n                        children: \"j\"\n                      }), _jsx(_components.mo, {\n                        children: \"−\"\n                      }), _jsx(_components.mn, {\n                        children: \"1\"\n                      })]\n                    })]\n                  }), _jsx(_components.mo, {\n                    children: \"+\"\n                  }), _jsxs(_components.msub, {\n                    children: [_jsx(_components.mi, {\n                      children: \"w\"\n                    }), _jsx(_components.mn, {\n                      children: \"11\"\n                    })]\n                  }), _jsx(_components.mtext, {\n                    children: \" \"\n                  }), _jsxs(_components.msub, {\n                    children: [_jsx(_components.mi, {\n                      children: \"x\"\n                    }), _jsxs(_components.mrow, {\n                      children: [_jsx(_components.mi, {\n                        children: \"i\"\n                      }), _jsx(_components.mo, {\n                        separator: \"true\",\n                        children: \",\"\n                      }), _jsx(_components.mi, {\n                        children: \"j\"\n                      })]\n                    })]\n                  }), _jsx(_components.mo, {\n                    children: \"+\"\n                  }), _jsx(_components.mi, {\n                    children: \"b\"\n                  })]\n                }), _jsx(_components.annotation, {\n                  encoding: \"application/x-tex\",\n                  children: \"y_{i,j} = w_{00} \\\\, x_{i-1,j-1} + w_{01} \\\\, x_{i-1,j} + w_{10} \\\\, x_{i,j-1} + w_{11} \\\\, x_{i,j} + b\"\n                })]\n              })\n            })\n          }), _jsxs(_components.span, {\n            className: \"katex-html\",\n            \"aria-hidden\": \"true\",\n            children: [_jsxs(_components.span, {\n              className: \"base\",\n              children: [_jsx(_components.span, {\n                className: \"strut\",\n                style: {\n                  height: \"0.7167em\",\n                  verticalAlign: \"-0.2861em\"\n                }\n              }), _jsxs(_components.span, {\n                className: \"mord\",\n                children: [_jsx(_components.span, {\n                  className: \"mord mathnormal\",\n                  style: {\n                    marginRight: \"0.03588em\"\n                  },\n                  children: \"y\"\n                }), _jsx(_components.span, {\n                  className: \"msupsub\",\n                  children: _jsxs(_components.span, {\n                    className: \"vlist-t vlist-t2\",\n                    children: [_jsxs(_components.span, {\n                      className: \"vlist-r\",\n                      children: [_jsx(_components.span, {\n                        className: \"vlist\",\n                        style: {\n                          height: \"0.3117em\"\n                        },\n                        children: _jsxs(_components.span, {\n                          style: {\n                            top: \"-2.55em\",\n                            marginLeft: \"-0.0359em\",\n                            marginRight: \"0.05em\"\n                          },\n                          children: [_jsx(_components.span, {\n                            className: \"pstrut\",\n                            style: {\n                              height: \"2.7em\"\n                            }\n                          }), _jsx(_components.span, {\n                            className: \"sizing reset-size6 size3 mtight\",\n                            children: _jsxs(_components.span, {\n                              className: \"mord mtight\",\n                              children: [_jsx(_components.span, {\n                                className: \"mord mathnormal mtight\",\n                                children: \"i\"\n                              }), _jsx(_components.span, {\n                                className: \"mpunct mtight\",\n                                children: \",\"\n                              }), _jsx(_components.span, {\n                                className: \"mord mathnormal mtight\",\n                                style: {\n                                  marginRight: \"0.05724em\"\n                                },\n                                children: \"j\"\n                              })]\n                            })\n                          })]\n                        })\n                      }), _jsx(_components.span, {\n                        className: \"vlist-s\",\n                        children: \"​\"\n                      })]\n                    }), _jsx(_components.span, {\n                      className: \"vlist-r\",\n                      children: _jsx(_components.span, {\n                        className: \"vlist\",\n                        style: {\n                          height: \"0.2861em\"\n                        },\n                        children: _jsx(_components.span, {})\n                      })\n                    })]\n                  })\n                })]\n              }), _jsx(_components.span, {\n                className: \"mspace\",\n                style: {\n                  marginRight: \"0.2778em\"\n                }\n              }), _jsx(_components.span, {\n                className: \"mrel\",\n                children: \"=\"\n              }), _jsx(_components.span, {\n                className: \"mspace\",\n                style: {\n                  marginRight: \"0.2778em\"\n                }\n              })]\n            }), _jsxs(_components.span, {\n              className: \"base\",\n              children: [_jsx(_components.span, {\n                className: \"strut\",\n                style: {\n                  height: \"0.8694em\",\n                  verticalAlign: \"-0.2861em\"\n                }\n              }), _jsxs(_components.span, {\n                className: \"mord\",\n                children: [_jsx(_components.span, {\n                  className: \"mord mathnormal\",\n                  style: {\n                    marginRight: \"0.02691em\"\n                  },\n                  children: \"w\"\n                }), _jsx(_components.span, {\n                  className: \"msupsub\",\n                  children: _jsxs(_components.span, {\n                    className: \"vlist-t vlist-t2\",\n                    children: [_jsxs(_components.span, {\n                      className: \"vlist-r\",\n                      children: [_jsx(_components.span, {\n                        className: \"vlist\",\n                        style: {\n                          height: \"0.3011em\"\n                        },\n                        children: _jsxs(_components.span, {\n                          style: {\n                            top: \"-2.55em\",\n                            marginLeft: \"-0.0269em\",\n                            marginRight: \"0.05em\"\n                          },\n                          children: [_jsx(_components.span, {\n                            className: \"pstrut\",\n                            style: {\n                              height: \"2.7em\"\n                            }\n                          }), _jsx(_components.span, {\n                            className: \"sizing reset-size6 size3 mtight\",\n                            children: _jsx(_components.span, {\n                              className: \"mord mtight\",\n                              children: _jsx(_components.span, {\n                                className: \"mord mtight\",\n                                children: \"00\"\n                              })\n                            })\n                          })]\n                        })\n                      }), _jsx(_components.span, {\n                        className: \"vlist-s\",\n                        children: \"​\"\n                      })]\n                    }), _jsx(_components.span, {\n                      className: \"vlist-r\",\n                      children: _jsx(_components.span, {\n                        className: \"vlist\",\n                        style: {\n                          height: \"0.15em\"\n                        },\n                        children: _jsx(_components.span, {})\n                      })\n                    })]\n                  })\n                })]\n              }), _jsx(_components.span, {\n                className: \"mspace\",\n                style: {\n                  marginRight: \"0.1667em\"\n                }\n              }), _jsxs(_components.span, {\n                className: \"mord\",\n                children: [_jsx(_components.span, {\n                  className: \"mord mathnormal\",\n                  children: \"x\"\n                }), _jsx(_components.span, {\n                  className: \"msupsub\",\n                  children: _jsxs(_components.span, {\n                    className: \"vlist-t vlist-t2\",\n                    children: [_jsxs(_components.span, {\n                      className: \"vlist-r\",\n                      children: [_jsx(_components.span, {\n                        className: \"vlist\",\n                        style: {\n                          height: \"0.3117em\"\n                        },\n                        children: _jsxs(_components.span, {\n                          style: {\n                            top: \"-2.55em\",\n                            marginLeft: \"0em\",\n                            marginRight: \"0.05em\"\n                          },\n                          children: [_jsx(_components.span, {\n                            className: \"pstrut\",\n                            style: {\n                              height: \"2.7em\"\n                            }\n                          }), _jsx(_components.span, {\n                            className: \"sizing reset-size6 size3 mtight\",\n                            children: _jsxs(_components.span, {\n                              className: \"mord mtight\",\n                              children: [_jsx(_components.span, {\n                                className: \"mord mathnormal mtight\",\n                                children: \"i\"\n                              }), _jsx(_components.span, {\n                                className: \"mbin mtight\",\n                                children: \"−\"\n                              }), _jsx(_components.span, {\n                                className: \"mord mtight\",\n                                children: \"1\"\n                              }), _jsx(_components.span, {\n                                className: \"mpunct mtight\",\n                                children: \",\"\n                              }), _jsx(_components.span, {\n                                className: \"mord mathnormal mtight\",\n                                style: {\n                                  marginRight: \"0.05724em\"\n                                },\n                                children: \"j\"\n                              }), _jsx(_components.span, {\n                                className: \"mbin mtight\",\n                                children: \"−\"\n                              }), _jsx(_components.span, {\n                                className: \"mord mtight\",\n                                children: \"1\"\n                              })]\n                            })\n                          })]\n                        })\n                      }), _jsx(_components.span, {\n                        className: \"vlist-s\",\n                        children: \"​\"\n                      })]\n                    }), _jsx(_components.span, {\n                      className: \"vlist-r\",\n                      children: _jsx(_components.span, {\n                        className: \"vlist\",\n                        style: {\n                          height: \"0.2861em\"\n                        },\n                        children: _jsx(_components.span, {})\n                      })\n                    })]\n                  })\n                })]\n              }), _jsx(_components.span, {\n                className: \"mspace\",\n                style: {\n                  marginRight: \"0.2222em\"\n                }\n              }), _jsx(_components.span, {\n                className: \"mbin\",\n                children: \"+\"\n              }), _jsx(_components.span, {\n                className: \"mspace\",\n                style: {\n                  marginRight: \"0.2222em\"\n                }\n              })]\n            }), _jsxs(_components.span, {\n              className: \"base\",\n              children: [_jsx(_components.span, {\n                className: \"strut\",\n                style: {\n                  height: \"0.8694em\",\n                  verticalAlign: \"-0.2861em\"\n                }\n              }), _jsxs(_components.span, {\n                className: \"mord\",\n                children: [_jsx(_components.span, {\n                  className: \"mord mathnormal\",\n                  style: {\n                    marginRight: \"0.02691em\"\n                  },\n                  children: \"w\"\n                }), _jsx(_components.span, {\n                  className: \"msupsub\",\n                  children: _jsxs(_components.span, {\n                    className: \"vlist-t vlist-t2\",\n                    children: [_jsxs(_components.span, {\n                      className: \"vlist-r\",\n                      children: [_jsx(_components.span, {\n                        className: \"vlist\",\n                        style: {\n                          height: \"0.3011em\"\n                        },\n                        children: _jsxs(_components.span, {\n                          style: {\n                            top: \"-2.55em\",\n                            marginLeft: \"-0.0269em\",\n                            marginRight: \"0.05em\"\n                          },\n                          children: [_jsx(_components.span, {\n                            className: \"pstrut\",\n                            style: {\n                              height: \"2.7em\"\n                            }\n                          }), _jsx(_components.span, {\n                            className: \"sizing reset-size6 size3 mtight\",\n                            children: _jsx(_components.span, {\n                              className: \"mord mtight\",\n                              children: _jsx(_components.span, {\n                                className: \"mord mtight\",\n                                children: \"01\"\n                              })\n                            })\n                          })]\n                        })\n                      }), _jsx(_components.span, {\n                        className: \"vlist-s\",\n                        children: \"​\"\n                      })]\n                    }), _jsx(_components.span, {\n                      className: \"vlist-r\",\n                      children: _jsx(_components.span, {\n                        className: \"vlist\",\n                        style: {\n                          height: \"0.15em\"\n                        },\n                        children: _jsx(_components.span, {})\n                      })\n                    })]\n                  })\n                })]\n              }), _jsx(_components.span, {\n                className: \"mspace\",\n                style: {\n                  marginRight: \"0.1667em\"\n                }\n              }), _jsxs(_components.span, {\n                className: \"mord\",\n                children: [_jsx(_components.span, {\n                  className: \"mord mathnormal\",\n                  children: \"x\"\n                }), _jsx(_components.span, {\n                  className: \"msupsub\",\n                  children: _jsxs(_components.span, {\n                    className: \"vlist-t vlist-t2\",\n                    children: [_jsxs(_components.span, {\n                      className: \"vlist-r\",\n                      children: [_jsx(_components.span, {\n                        className: \"vlist\",\n                        style: {\n                          height: \"0.3117em\"\n                        },\n                        children: _jsxs(_components.span, {\n                          style: {\n                            top: \"-2.55em\",\n                            marginLeft: \"0em\",\n                            marginRight: \"0.05em\"\n                          },\n                          children: [_jsx(_components.span, {\n                            className: \"pstrut\",\n                            style: {\n                              height: \"2.7em\"\n                            }\n                          }), _jsx(_components.span, {\n                            className: \"sizing reset-size6 size3 mtight\",\n                            children: _jsxs(_components.span, {\n                              className: \"mord mtight\",\n                              children: [_jsx(_components.span, {\n                                className: \"mord mathnormal mtight\",\n                                children: \"i\"\n                              }), _jsx(_components.span, {\n                                className: \"mbin mtight\",\n                                children: \"−\"\n                              }), _jsx(_components.span, {\n                                className: \"mord mtight\",\n                                children: \"1\"\n                              }), _jsx(_components.span, {\n                                className: \"mpunct mtight\",\n                                children: \",\"\n                              }), _jsx(_components.span, {\n                                className: \"mord mathnormal mtight\",\n                                style: {\n                                  marginRight: \"0.05724em\"\n                                },\n                                children: \"j\"\n                              })]\n                            })\n                          })]\n                        })\n                      }), _jsx(_components.span, {\n                        className: \"vlist-s\",\n                        children: \"​\"\n                      })]\n                    }), _jsx(_components.span, {\n                      className: \"vlist-r\",\n                      children: _jsx(_components.span, {\n                        className: \"vlist\",\n                        style: {\n                          height: \"0.2861em\"\n                        },\n                        children: _jsx(_components.span, {})\n                      })\n                    })]\n                  })\n                })]\n              }), _jsx(_components.span, {\n                className: \"mspace\",\n                style: {\n                  marginRight: \"0.2222em\"\n                }\n              }), _jsx(_components.span, {\n                className: \"mbin\",\n                children: \"+\"\n              }), _jsx(_components.span, {\n                className: \"mspace\",\n                style: {\n                  marginRight: \"0.2222em\"\n                }\n              })]\n            }), _jsxs(_components.span, {\n              className: \"base\",\n              children: [_jsx(_components.span, {\n                className: \"strut\",\n                style: {\n                  height: \"0.8694em\",\n                  verticalAlign: \"-0.2861em\"\n                }\n              }), _jsxs(_components.span, {\n                className: \"mord\",\n                children: [_jsx(_components.span, {\n                  className: \"mord mathnormal\",\n                  style: {\n                    marginRight: \"0.02691em\"\n                  },\n                  children: \"w\"\n                }), _jsx(_components.span, {\n                  className: \"msupsub\",\n                  children: _jsxs(_components.span, {\n                    className: \"vlist-t vlist-t2\",\n                    children: [_jsxs(_components.span, {\n                      className: \"vlist-r\",\n                      children: [_jsx(_components.span, {\n                        className: \"vlist\",\n                        style: {\n                          height: \"0.3011em\"\n                        },\n                        children: _jsxs(_components.span, {\n                          style: {\n                            top: \"-2.55em\",\n                            marginLeft: \"-0.0269em\",\n                            marginRight: \"0.05em\"\n                          },\n                          children: [_jsx(_components.span, {\n                            className: \"pstrut\",\n                            style: {\n                              height: \"2.7em\"\n                            }\n                          }), _jsx(_components.span, {\n                            className: \"sizing reset-size6 size3 mtight\",\n                            children: _jsx(_components.span, {\n                              className: \"mord mtight\",\n                              children: _jsx(_components.span, {\n                                className: \"mord mtight\",\n                                children: \"10\"\n                              })\n                            })\n                          })]\n                        })\n                      }), _jsx(_components.span, {\n                        className: \"vlist-s\",\n                        children: \"​\"\n                      })]\n                    }), _jsx(_components.span, {\n                      className: \"vlist-r\",\n                      children: _jsx(_components.span, {\n                        className: \"vlist\",\n                        style: {\n                          height: \"0.15em\"\n                        },\n                        children: _jsx(_components.span, {})\n                      })\n                    })]\n                  })\n                })]\n              }), _jsx(_components.span, {\n                className: \"mspace\",\n                style: {\n                  marginRight: \"0.1667em\"\n                }\n              }), _jsxs(_components.span, {\n                className: \"mord\",\n                children: [_jsx(_components.span, {\n                  className: \"mord mathnormal\",\n                  children: \"x\"\n                }), _jsx(_components.span, {\n                  className: \"msupsub\",\n                  children: _jsxs(_components.span, {\n                    className: \"vlist-t vlist-t2\",\n                    children: [_jsxs(_components.span, {\n                      className: \"vlist-r\",\n                      children: [_jsx(_components.span, {\n                        className: \"vlist\",\n                        style: {\n                          height: \"0.3117em\"\n                        },\n                        children: _jsxs(_components.span, {\n                          style: {\n                            top: \"-2.55em\",\n                            marginLeft: \"0em\",\n                            marginRight: \"0.05em\"\n                          },\n                          children: [_jsx(_components.span, {\n                            className: \"pstrut\",\n                            style: {\n                              height: \"2.7em\"\n                            }\n                          }), _jsx(_components.span, {\n                            className: \"sizing reset-size6 size3 mtight\",\n                            children: _jsxs(_components.span, {\n                              className: \"mord mtight\",\n                              children: [_jsx(_components.span, {\n                                className: \"mord mathnormal mtight\",\n                                children: \"i\"\n                              }), _jsx(_components.span, {\n                                className: \"mpunct mtight\",\n                                children: \",\"\n                              }), _jsx(_components.span, {\n                                className: \"mord mathnormal mtight\",\n                                style: {\n                                  marginRight: \"0.05724em\"\n                                },\n                                children: \"j\"\n                              }), _jsx(_components.span, {\n                                className: \"mbin mtight\",\n                                children: \"−\"\n                              }), _jsx(_components.span, {\n                                className: \"mord mtight\",\n                                children: \"1\"\n                              })]\n                            })\n                          })]\n                        })\n                      }), _jsx(_components.span, {\n                        className: \"vlist-s\",\n                        children: \"​\"\n                      })]\n                    }), _jsx(_components.span, {\n                      className: \"vlist-r\",\n                      children: _jsx(_components.span, {\n                        className: \"vlist\",\n                        style: {\n                          height: \"0.2861em\"\n                        },\n                        children: _jsx(_components.span, {})\n                      })\n                    })]\n                  })\n                })]\n              }), _jsx(_components.span, {\n                className: \"mspace\",\n                style: {\n                  marginRight: \"0.2222em\"\n                }\n              }), _jsx(_components.span, {\n                className: \"mbin\",\n                children: \"+\"\n              }), _jsx(_components.span, {\n                className: \"mspace\",\n                style: {\n                  marginRight: \"0.2222em\"\n                }\n              })]\n            }), _jsxs(_components.span, {\n              className: \"base\",\n              children: [_jsx(_components.span, {\n                className: \"strut\",\n                style: {\n                  height: \"0.8694em\",\n                  verticalAlign: \"-0.2861em\"\n                }\n              }), _jsxs(_components.span, {\n                className: \"mord\",\n                children: [_jsx(_components.span, {\n                  className: \"mord mathnormal\",\n                  style: {\n                    marginRight: \"0.02691em\"\n                  },\n                  children: \"w\"\n                }), _jsx(_components.span, {\n                  className: \"msupsub\",\n                  children: _jsxs(_components.span, {\n                    className: \"vlist-t vlist-t2\",\n                    children: [_jsxs(_components.span, {\n                      className: \"vlist-r\",\n                      children: [_jsx(_components.span, {\n                        className: \"vlist\",\n                        style: {\n                          height: \"0.3011em\"\n                        },\n                        children: _jsxs(_components.span, {\n                          style: {\n                            top: \"-2.55em\",\n                            marginLeft: \"-0.0269em\",\n                            marginRight: \"0.05em\"\n                          },\n                          children: [_jsx(_components.span, {\n                            className: \"pstrut\",\n                            style: {\n                              height: \"2.7em\"\n                            }\n                          }), _jsx(_components.span, {\n                            className: \"sizing reset-size6 size3 mtight\",\n                            children: _jsx(_components.span, {\n                              className: \"mord mtight\",\n                              children: _jsx(_components.span, {\n                                className: \"mord mtight\",\n                                children: \"11\"\n                              })\n                            })\n                          })]\n                        })\n                      }), _jsx(_components.span, {\n                        className: \"vlist-s\",\n                        children: \"​\"\n                      })]\n                    }), _jsx(_components.span, {\n                      className: \"vlist-r\",\n                      children: _jsx(_components.span, {\n                        className: \"vlist\",\n                        style: {\n                          height: \"0.15em\"\n                        },\n                        children: _jsx(_components.span, {})\n                      })\n                    })]\n                  })\n                })]\n              }), _jsx(_components.span, {\n                className: \"mspace\",\n                style: {\n                  marginRight: \"0.1667em\"\n                }\n              }), _jsxs(_components.span, {\n                className: \"mord\",\n                children: [_jsx(_components.span, {\n                  className: \"mord mathnormal\",\n                  children: \"x\"\n                }), _jsx(_components.span, {\n                  className: \"msupsub\",\n                  children: _jsxs(_components.span, {\n                    className: \"vlist-t vlist-t2\",\n                    children: [_jsxs(_components.span, {\n                      className: \"vlist-r\",\n                      children: [_jsx(_components.span, {\n                        className: \"vlist\",\n                        style: {\n                          height: \"0.3117em\"\n                        },\n                        children: _jsxs(_components.span, {\n                          style: {\n                            top: \"-2.55em\",\n                            marginLeft: \"0em\",\n                            marginRight: \"0.05em\"\n                          },\n                          children: [_jsx(_components.span, {\n                            className: \"pstrut\",\n                            style: {\n                              height: \"2.7em\"\n                            }\n                          }), _jsx(_components.span, {\n                            className: \"sizing reset-size6 size3 mtight\",\n                            children: _jsxs(_components.span, {\n                              className: \"mord mtight\",\n                              children: [_jsx(_components.span, {\n                                className: \"mord mathnormal mtight\",\n                                children: \"i\"\n                              }), _jsx(_components.span, {\n                                className: \"mpunct mtight\",\n                                children: \",\"\n                              }), _jsx(_components.span, {\n                                className: \"mord mathnormal mtight\",\n                                style: {\n                                  marginRight: \"0.05724em\"\n                                },\n                                children: \"j\"\n                              })]\n                            })\n                          })]\n                        })\n                      }), _jsx(_components.span, {\n                        className: \"vlist-s\",\n                        children: \"​\"\n                      })]\n                    }), _jsx(_components.span, {\n                      className: \"vlist-r\",\n                      children: _jsx(_components.span, {\n                        className: \"vlist\",\n                        style: {\n                          height: \"0.2861em\"\n                        },\n                        children: _jsx(_components.span, {})\n                      })\n                    })]\n                  })\n                })]\n              }), _jsx(_components.span, {\n                className: \"mspace\",\n                style: {\n                  marginRight: \"0.2222em\"\n                }\n              }), _jsx(_components.span, {\n                className: \"mbin\",\n                children: \"+\"\n              }), _jsx(_components.span, {\n                className: \"mspace\",\n                style: {\n                  marginRight: \"0.2222em\"\n                }\n              })]\n            }), _jsxs(_components.span, {\n              className: \"base\",\n              children: [_jsx(_components.span, {\n                className: \"strut\",\n                style: {\n                  height: \"0.6944em\"\n                }\n              }), _jsx(_components.span, {\n                className: \"mord mathnormal\",\n                children: \"b\"\n              })]\n            })]\n          })]\n        })\n      })\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"Where \", _jsxs(_components.span, {\n        className: \"katex\",\n        children: [_jsx(_components.span, {\n          className: \"katex-mathml\",\n          children: _jsx(_components.math, {\n            xmlns: \"http://www.w3.org/1998/Math/MathML\",\n            children: _jsxs(_components.semantics, {\n              children: [_jsx(_components.mrow, {\n                children: _jsx(_components.mi, {\n                  children: \"w\"\n                })\n              }), _jsx(_components.annotation, {\n                encoding: \"application/x-tex\",\n                children: \"w\"\n              })]\n            })\n          })\n        }), _jsx(_components.span, {\n          className: \"katex-html\",\n          \"aria-hidden\": \"true\",\n          children: _jsxs(_components.span, {\n            className: \"base\",\n            children: [_jsx(_components.span, {\n              className: \"strut\",\n              style: {\n                height: \"0.4306em\"\n              }\n            }), _jsx(_components.span, {\n              className: \"mord mathnormal\",\n              style: {\n                marginRight: \"0.02691em\"\n              },\n              children: \"w\"\n            })]\n          })\n        })]\n      }), \" are the 2x2 weights and \", _jsxs(_components.span, {\n        className: \"katex\",\n        children: [_jsx(_components.span, {\n          className: \"katex-mathml\",\n          children: _jsx(_components.math, {\n            xmlns: \"http://www.w3.org/1998/Math/MathML\",\n            children: _jsxs(_components.semantics, {\n              children: [_jsx(_components.mrow, {\n                children: _jsx(_components.mi, {\n                  children: \"b\"\n                })\n              }), _jsx(_components.annotation, {\n                encoding: \"application/x-tex\",\n                children: \"b\"\n              })]\n            })\n          })\n        }), _jsx(_components.span, {\n          className: \"katex-html\",\n          \"aria-hidden\": \"true\",\n          children: _jsxs(_components.span, {\n            className: \"base\",\n            children: [_jsx(_components.span, {\n              className: \"strut\",\n              style: {\n                height: \"0.6944em\"\n              }\n            }), _jsx(_components.span, {\n              className: \"mord mathnormal\",\n              children: \"b\"\n            })]\n          })\n        })]\n      }), \" is the bias in the convolutional layer.\"]\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"We can easily show that \", _jsxs(_components.span, {\n        className: \"katex\",\n        children: [_jsx(_components.span, {\n          className: \"katex-mathml\",\n          children: _jsx(_components.math, {\n            xmlns: \"http://www.w3.org/1998/Math/MathML\",\n            children: _jsxs(_components.semantics, {\n              children: [_jsx(_components.mrow, {\n                children: _jsxs(_components.msub, {\n                  children: [_jsx(_components.mi, {\n                    children: \"x\"\n                  }), _jsxs(_components.mrow, {\n                    children: [_jsx(_components.mi, {\n                      children: \"i\"\n                    }), _jsx(_components.mo, {\n                      separator: \"true\",\n                      children: \",\"\n                    }), _jsx(_components.mi, {\n                      children: \"j\"\n                    })]\n                  })]\n                })\n              }), _jsx(_components.annotation, {\n                encoding: \"application/x-tex\",\n                children: \"x_{i,j}\"\n              })]\n            })\n          })\n        }), _jsx(_components.span, {\n          className: \"katex-html\",\n          \"aria-hidden\": \"true\",\n          children: _jsxs(_components.span, {\n            className: \"base\",\n            children: [_jsx(_components.span, {\n              className: \"strut\",\n              style: {\n                height: \"0.7167em\",\n                verticalAlign: \"-0.2861em\"\n              }\n            }), _jsxs(_components.span, {\n              className: \"mord\",\n              children: [_jsx(_components.span, {\n                className: \"mord mathnormal\",\n                children: \"x\"\n              }), _jsx(_components.span, {\n                className: \"msupsub\",\n                children: _jsxs(_components.span, {\n                  className: \"vlist-t vlist-t2\",\n                  children: [_jsxs(_components.span, {\n                    className: \"vlist-r\",\n                    children: [_jsx(_components.span, {\n                      className: \"vlist\",\n                      style: {\n                        height: \"0.3117em\"\n                      },\n                      children: _jsxs(_components.span, {\n                        style: {\n                          top: \"-2.55em\",\n                          marginLeft: \"0em\",\n                          marginRight: \"0.05em\"\n                        },\n                        children: [_jsx(_components.span, {\n                          className: \"pstrut\",\n                          style: {\n                            height: \"2.7em\"\n                          }\n                        }), _jsx(_components.span, {\n                          className: \"sizing reset-size6 size3 mtight\",\n                          children: _jsxs(_components.span, {\n                            className: \"mord mtight\",\n                            children: [_jsx(_components.span, {\n                              className: \"mord mathnormal mtight\",\n                              children: \"i\"\n                            }), _jsx(_components.span, {\n                              className: \"mpunct mtight\",\n                              children: \",\"\n                            }), _jsx(_components.span, {\n                              className: \"mord mathnormal mtight\",\n                              style: {\n                                marginRight: \"0.05724em\"\n                              },\n                              children: \"j\"\n                            })]\n                          })\n                        })]\n                      })\n                    }), _jsx(_components.span, {\n                      className: \"vlist-s\",\n                      children: \"​\"\n                    })]\n                  }), _jsx(_components.span, {\n                    className: \"vlist-r\",\n                    children: _jsx(_components.span, {\n                      className: \"vlist\",\n                      style: {\n                        height: \"0.2861em\"\n                      },\n                      children: _jsx(_components.span, {})\n                    })\n                  })]\n                })\n              })]\n            })]\n          })\n        })]\n      }), \" is:\"]\n    }), \"\\n\", _jsx(Math, {\n      children: _jsx(_components.p, {\n        children: _jsxs(_components.span, {\n          className: \"katex\",\n          children: [_jsx(_components.span, {\n            className: \"katex-mathml\",\n            children: _jsx(_components.math, {\n              xmlns: \"http://www.w3.org/1998/Math/MathML\",\n              children: _jsxs(_components.semantics, {\n                children: [_jsxs(_components.mrow, {\n                  children: [_jsxs(_components.msub, {\n                    children: [_jsx(_components.mi, {\n                      children: \"x\"\n                    }), _jsxs(_components.mrow, {\n                      children: [_jsx(_components.mi, {\n                        children: \"i\"\n                      }), _jsx(_components.mo, {\n                        separator: \"true\",\n                        children: \",\"\n                      }), _jsx(_components.mi, {\n                        children: \"j\"\n                      })]\n                    })]\n                  }), _jsx(_components.mo, {\n                    children: \"=\"\n                  }), _jsxs(_components.mfrac, {\n                    children: [_jsxs(_components.mrow, {\n                      children: [_jsx(_components.mtext, {\n                        children: \" \"\n                      }), _jsxs(_components.msub, {\n                        children: [_jsx(_components.mi, {\n                          children: \"y\"\n                        }), _jsxs(_components.mrow, {\n                          children: [_jsx(_components.mi, {\n                            children: \"i\"\n                          }), _jsx(_components.mo, {\n                            separator: \"true\",\n                            children: \",\"\n                          }), _jsx(_components.mi, {\n                            children: \"j\"\n                          })]\n                        })]\n                      }), _jsx(_components.mo, {\n                        children: \"−\"\n                      }), _jsx(_components.mi, {\n                        children: \"b\"\n                      }), _jsx(_components.mo, {\n                        children: \"−\"\n                      }), _jsxs(_components.msub, {\n                        children: [_jsx(_components.mi, {\n                          children: \"w\"\n                        }), _jsx(_components.mn, {\n                          children: \"00\"\n                        })]\n                      }), _jsx(_components.mtext, {\n                        children: \" \"\n                      }), _jsxs(_components.msub, {\n                        children: [_jsx(_components.mi, {\n                          children: \"x\"\n                        }), _jsxs(_components.mrow, {\n                          children: [_jsx(_components.mi, {\n                            children: \"i\"\n                          }), _jsx(_components.mo, {\n                            children: \"−\"\n                          }), _jsx(_components.mn, {\n                            children: \"1\"\n                          }), _jsx(_components.mo, {\n                            separator: \"true\",\n                            children: \",\"\n                          }), _jsx(_components.mi, {\n                            children: \"j\"\n                          }), _jsx(_components.mo, {\n                            children: \"−\"\n                          }), _jsx(_components.mn, {\n                            children: \"1\"\n                          })]\n                        })]\n                      }), _jsx(_components.mo, {\n                        children: \"−\"\n                      }), _jsxs(_components.msub, {\n                        children: [_jsx(_components.mi, {\n                          children: \"w\"\n                        }), _jsx(_components.mn, {\n                          children: \"01\"\n                        })]\n                      }), _jsx(_components.mtext, {\n                        children: \" \"\n                      }), _jsxs(_components.msub, {\n                        children: [_jsx(_components.mi, {\n                          children: \"x\"\n                        }), _jsxs(_components.mrow, {\n                          children: [_jsx(_components.mi, {\n                            children: \"i\"\n                          }), _jsx(_components.mo, {\n                            children: \"−\"\n                          }), _jsx(_components.mn, {\n                            children: \"1\"\n                          }), _jsx(_components.mo, {\n                            separator: \"true\",\n                            children: \",\"\n                          }), _jsx(_components.mi, {\n                            children: \"j\"\n                          })]\n                        })]\n                      }), _jsx(_components.mo, {\n                        children: \"−\"\n                      }), _jsxs(_components.msub, {\n                        children: [_jsx(_components.mi, {\n                          children: \"w\"\n                        }), _jsx(_components.mn, {\n                          children: \"10\"\n                        })]\n                      }), _jsx(_components.mtext, {\n                        children: \" \"\n                      }), _jsxs(_components.msub, {\n                        children: [_jsx(_components.mi, {\n                          children: \"x\"\n                        }), _jsxs(_components.mrow, {\n                          children: [_jsx(_components.mi, {\n                            children: \"i\"\n                          }), _jsx(_components.mo, {\n                            separator: \"true\",\n                            children: \",\"\n                          }), _jsx(_components.mi, {\n                            children: \"j\"\n                          }), _jsx(_components.mo, {\n                            children: \"−\"\n                          }), _jsx(_components.mn, {\n                            children: \"1\"\n                          })]\n                        })]\n                      }), _jsx(_components.mtext, {\n                        children: \" \"\n                      })]\n                    }), _jsxs(_components.msub, {\n                      children: [_jsx(_components.mi, {\n                        children: \"w\"\n                      }), _jsx(_components.mn, {\n                        children: \"11\"\n                      })]\n                    })]\n                  })]\n                }), _jsx(_components.annotation, {\n                  encoding: \"application/x-tex\",\n                  children: \"x_{i,j} = \\\\frac{\\\\,y_{i,j} - b - w_{00} \\\\, x_{i-1,j-1} - w_{01} \\\\, x_{i-1,j} - w_{10} \\\\, x_{i,j-1}\\\\,}{w_{11}}\"\n                })]\n              })\n            })\n          }), _jsxs(_components.span, {\n            className: \"katex-html\",\n            \"aria-hidden\": \"true\",\n            children: [_jsxs(_components.span, {\n              className: \"base\",\n              children: [_jsx(_components.span, {\n                className: \"strut\",\n                style: {\n                  height: \"0.7167em\",\n                  verticalAlign: \"-0.2861em\"\n                }\n              }), _jsxs(_components.span, {\n                className: \"mord\",\n                children: [_jsx(_components.span, {\n                  className: \"mord mathnormal\",\n                  children: \"x\"\n                }), _jsx(_components.span, {\n                  className: \"msupsub\",\n                  children: _jsxs(_components.span, {\n                    className: \"vlist-t vlist-t2\",\n                    children: [_jsxs(_components.span, {\n                      className: \"vlist-r\",\n                      children: [_jsx(_components.span, {\n                        className: \"vlist\",\n                        style: {\n                          height: \"0.3117em\"\n                        },\n                        children: _jsxs(_components.span, {\n                          style: {\n                            top: \"-2.55em\",\n                            marginLeft: \"0em\",\n                            marginRight: \"0.05em\"\n                          },\n                          children: [_jsx(_components.span, {\n                            className: \"pstrut\",\n                            style: {\n                              height: \"2.7em\"\n                            }\n                          }), _jsx(_components.span, {\n                            className: \"sizing reset-size6 size3 mtight\",\n                            children: _jsxs(_components.span, {\n                              className: \"mord mtight\",\n                              children: [_jsx(_components.span, {\n                                className: \"mord mathnormal mtight\",\n                                children: \"i\"\n                              }), _jsx(_components.span, {\n                                className: \"mpunct mtight\",\n                                children: \",\"\n                              }), _jsx(_components.span, {\n                                className: \"mord mathnormal mtight\",\n                                style: {\n                                  marginRight: \"0.05724em\"\n                                },\n                                children: \"j\"\n                              })]\n                            })\n                          })]\n                        })\n                      }), _jsx(_components.span, {\n                        className: \"vlist-s\",\n                        children: \"​\"\n                      })]\n                    }), _jsx(_components.span, {\n                      className: \"vlist-r\",\n                      children: _jsx(_components.span, {\n                        className: \"vlist\",\n                        style: {\n                          height: \"0.2861em\"\n                        },\n                        children: _jsx(_components.span, {})\n                      })\n                    })]\n                  })\n                })]\n              }), _jsx(_components.span, {\n                className: \"mspace\",\n                style: {\n                  marginRight: \"0.2778em\"\n                }\n              }), _jsx(_components.span, {\n                className: \"mrel\",\n                children: \"=\"\n              }), _jsx(_components.span, {\n                className: \"mspace\",\n                style: {\n                  marginRight: \"0.2778em\"\n                }\n              })]\n            }), _jsxs(_components.span, {\n              className: \"base\",\n              children: [_jsx(_components.span, {\n                className: \"strut\",\n                style: {\n                  height: \"1.4385em\",\n                  verticalAlign: \"-0.4451em\"\n                }\n              }), _jsxs(_components.span, {\n                className: \"mord\",\n                children: [_jsx(_components.span, {\n                  className: \"mopen nulldelimiter\"\n                }), _jsx(_components.span, {\n                  className: \"mfrac\",\n                  children: _jsxs(_components.span, {\n                    className: \"vlist-t vlist-t2\",\n                    children: [_jsxs(_components.span, {\n                      className: \"vlist-r\",\n                      children: [_jsxs(_components.span, {\n                        className: \"vlist\",\n                        style: {\n                          height: \"0.9934em\"\n                        },\n                        children: [_jsxs(_components.span, {\n                          style: {\n                            top: \"-2.655em\"\n                          },\n                          children: [_jsx(_components.span, {\n                            className: \"pstrut\",\n                            style: {\n                              height: \"3em\"\n                            }\n                          }), _jsx(_components.span, {\n                            className: \"sizing reset-size6 size3 mtight\",\n                            children: _jsx(_components.span, {\n                              className: \"mord mtight\",\n                              children: _jsxs(_components.span, {\n                                className: \"mord mtight\",\n                                children: [_jsx(_components.span, {\n                                  className: \"mord mathnormal mtight\",\n                                  style: {\n                                    marginRight: \"0.02691em\"\n                                  },\n                                  children: \"w\"\n                                }), _jsx(_components.span, {\n                                  className: \"msupsub\",\n                                  children: _jsxs(_components.span, {\n                                    className: \"vlist-t vlist-t2\",\n                                    children: [_jsxs(_components.span, {\n                                      className: \"vlist-r\",\n                                      children: [_jsx(_components.span, {\n                                        className: \"vlist\",\n                                        style: {\n                                          height: \"0.3173em\"\n                                        },\n                                        children: _jsxs(_components.span, {\n                                          style: {\n                                            top: \"-2.357em\",\n                                            marginLeft: \"-0.0269em\",\n                                            marginRight: \"0.0714em\"\n                                          },\n                                          children: [_jsx(_components.span, {\n                                            className: \"pstrut\",\n                                            style: {\n                                              height: \"2.5em\"\n                                            }\n                                          }), _jsx(_components.span, {\n                                            className: \"sizing reset-size3 size1 mtight\",\n                                            children: _jsx(_components.span, {\n                                              className: \"mord mtight\",\n                                              children: _jsx(_components.span, {\n                                                className: \"mord mtight\",\n                                                children: \"11\"\n                                              })\n                                            })\n                                          })]\n                                        })\n                                      }), _jsx(_components.span, {\n                                        className: \"vlist-s\",\n                                        children: \"​\"\n                                      })]\n                                    }), _jsx(_components.span, {\n                                      className: \"vlist-r\",\n                                      children: _jsx(_components.span, {\n                                        className: \"vlist\",\n                                        style: {\n                                          height: \"0.143em\"\n                                        },\n                                        children: _jsx(_components.span, {})\n                                      })\n                                    })]\n                                  })\n                                })]\n                              })\n                            })\n                          })]\n                        }), _jsxs(_components.span, {\n                          style: {\n                            top: \"-3.23em\"\n                          },\n                          children: [_jsx(_components.span, {\n                            className: \"pstrut\",\n                            style: {\n                              height: \"3em\"\n                            }\n                          }), _jsx(_components.span, {\n                            className: \"frac-line\",\n                            style: {\n                              borderBottomWidth: \"0.04em\"\n                            }\n                          })]\n                        }), _jsxs(_components.span, {\n                          style: {\n                            top: \"-3.5073em\"\n                          },\n                          children: [_jsx(_components.span, {\n                            className: \"pstrut\",\n                            style: {\n                              height: \"3em\"\n                            }\n                          }), _jsx(_components.span, {\n                            className: \"sizing reset-size6 size3 mtight\",\n                            children: _jsxs(_components.span, {\n                              className: \"mord mtight\",\n                              children: [_jsx(_components.span, {\n                                className: \"mspace mtight\",\n                                style: {\n                                  marginRight: \"0.1952em\"\n                                }\n                              }), _jsxs(_components.span, {\n                                className: \"mord mtight\",\n                                children: [_jsx(_components.span, {\n                                  className: \"mord mathnormal mtight\",\n                                  style: {\n                                    marginRight: \"0.03588em\"\n                                  },\n                                  children: \"y\"\n                                }), _jsx(_components.span, {\n                                  className: \"msupsub\",\n                                  children: _jsxs(_components.span, {\n                                    className: \"vlist-t vlist-t2\",\n                                    children: [_jsxs(_components.span, {\n                                      className: \"vlist-r\",\n                                      children: [_jsx(_components.span, {\n                                        className: \"vlist\",\n                                        style: {\n                                          height: \"0.3281em\"\n                                        },\n                                        children: _jsxs(_components.span, {\n                                          style: {\n                                            top: \"-2.357em\",\n                                            marginLeft: \"-0.0359em\",\n                                            marginRight: \"0.0714em\"\n                                          },\n                                          children: [_jsx(_components.span, {\n                                            className: \"pstrut\",\n                                            style: {\n                                              height: \"2.5em\"\n                                            }\n                                          }), _jsx(_components.span, {\n                                            className: \"sizing reset-size3 size1 mtight\",\n                                            children: _jsxs(_components.span, {\n                                              className: \"mord mtight\",\n                                              children: [_jsx(_components.span, {\n                                                className: \"mord mathnormal mtight\",\n                                                children: \"i\"\n                                              }), _jsx(_components.span, {\n                                                className: \"mpunct mtight\",\n                                                children: \",\"\n                                              }), _jsx(_components.span, {\n                                                className: \"mord mathnormal mtight\",\n                                                style: {\n                                                  marginRight: \"0.05724em\"\n                                                },\n                                                children: \"j\"\n                                              })]\n                                            })\n                                          })]\n                                        })\n                                      }), _jsx(_components.span, {\n                                        className: \"vlist-s\",\n                                        children: \"​\"\n                                      })]\n                                    }), _jsx(_components.span, {\n                                      className: \"vlist-r\",\n                                      children: _jsx(_components.span, {\n                                        className: \"vlist\",\n                                        style: {\n                                          height: \"0.2819em\"\n                                        },\n                                        children: _jsx(_components.span, {})\n                                      })\n                                    })]\n                                  })\n                                })]\n                              }), _jsx(_components.span, {\n                                className: \"mbin mtight\",\n                                children: \"−\"\n                              }), _jsx(_components.span, {\n                                className: \"mord mathnormal mtight\",\n                                children: \"b\"\n                              }), _jsx(_components.span, {\n                                className: \"mbin mtight\",\n                                children: \"−\"\n                              }), _jsxs(_components.span, {\n                                className: \"mord mtight\",\n                                children: [_jsx(_components.span, {\n                                  className: \"mord mathnormal mtight\",\n                                  style: {\n                                    marginRight: \"0.02691em\"\n                                  },\n                                  children: \"w\"\n                                }), _jsx(_components.span, {\n                                  className: \"msupsub\",\n                                  children: _jsxs(_components.span, {\n                                    className: \"vlist-t vlist-t2\",\n                                    children: [_jsxs(_components.span, {\n                                      className: \"vlist-r\",\n                                      children: [_jsx(_components.span, {\n                                        className: \"vlist\",\n                                        style: {\n                                          height: \"0.3173em\"\n                                        },\n                                        children: _jsxs(_components.span, {\n                                          style: {\n                                            top: \"-2.357em\",\n                                            marginLeft: \"-0.0269em\",\n                                            marginRight: \"0.0714em\"\n                                          },\n                                          children: [_jsx(_components.span, {\n                                            className: \"pstrut\",\n                                            style: {\n                                              height: \"2.5em\"\n                                            }\n                                          }), _jsx(_components.span, {\n                                            className: \"sizing reset-size3 size1 mtight\",\n                                            children: _jsx(_components.span, {\n                                              className: \"mord mtight\",\n                                              children: _jsx(_components.span, {\n                                                className: \"mord mtight\",\n                                                children: \"00\"\n                                              })\n                                            })\n                                          })]\n                                        })\n                                      }), _jsx(_components.span, {\n                                        className: \"vlist-s\",\n                                        children: \"​\"\n                                      })]\n                                    }), _jsx(_components.span, {\n                                      className: \"vlist-r\",\n                                      children: _jsx(_components.span, {\n                                        className: \"vlist\",\n                                        style: {\n                                          height: \"0.143em\"\n                                        },\n                                        children: _jsx(_components.span, {})\n                                      })\n                                    })]\n                                  })\n                                })]\n                              }), _jsx(_components.span, {\n                                className: \"mspace mtight\",\n                                style: {\n                                  marginRight: \"0.1952em\"\n                                }\n                              }), _jsxs(_components.span, {\n                                className: \"mord mtight\",\n                                children: [_jsx(_components.span, {\n                                  className: \"mord mathnormal mtight\",\n                                  children: \"x\"\n                                }), _jsx(_components.span, {\n                                  className: \"msupsub\",\n                                  children: _jsxs(_components.span, {\n                                    className: \"vlist-t vlist-t2\",\n                                    children: [_jsxs(_components.span, {\n                                      className: \"vlist-r\",\n                                      children: [_jsx(_components.span, {\n                                        className: \"vlist\",\n                                        style: {\n                                          height: \"0.3281em\"\n                                        },\n                                        children: _jsxs(_components.span, {\n                                          style: {\n                                            top: \"-2.357em\",\n                                            marginLeft: \"0em\",\n                                            marginRight: \"0.0714em\"\n                                          },\n                                          children: [_jsx(_components.span, {\n                                            className: \"pstrut\",\n                                            style: {\n                                              height: \"2.5em\"\n                                            }\n                                          }), _jsx(_components.span, {\n                                            className: \"sizing reset-size3 size1 mtight\",\n                                            children: _jsxs(_components.span, {\n                                              className: \"mord mtight\",\n                                              children: [_jsx(_components.span, {\n                                                className: \"mord mathnormal mtight\",\n                                                children: \"i\"\n                                              }), _jsx(_components.span, {\n                                                className: \"mbin mtight\",\n                                                children: \"−\"\n                                              }), _jsx(_components.span, {\n                                                className: \"mord mtight\",\n                                                children: \"1\"\n                                              }), _jsx(_components.span, {\n                                                className: \"mpunct mtight\",\n                                                children: \",\"\n                                              }), _jsx(_components.span, {\n                                                className: \"mord mathnormal mtight\",\n                                                style: {\n                                                  marginRight: \"0.05724em\"\n                                                },\n                                                children: \"j\"\n                                              }), _jsx(_components.span, {\n                                                className: \"mbin mtight\",\n                                                children: \"−\"\n                                              }), _jsx(_components.span, {\n                                                className: \"mord mtight\",\n                                                children: \"1\"\n                                              })]\n                                            })\n                                          })]\n                                        })\n                                      }), _jsx(_components.span, {\n                                        className: \"vlist-s\",\n                                        children: \"​\"\n                                      })]\n                                    }), _jsx(_components.span, {\n                                      className: \"vlist-r\",\n                                      children: _jsx(_components.span, {\n                                        className: \"vlist\",\n                                        style: {\n                                          height: \"0.2819em\"\n                                        },\n                                        children: _jsx(_components.span, {})\n                                      })\n                                    })]\n                                  })\n                                })]\n                              }), _jsx(_components.span, {\n                                className: \"mbin mtight\",\n                                children: \"−\"\n                              }), _jsxs(_components.span, {\n                                className: \"mord mtight\",\n                                children: [_jsx(_components.span, {\n                                  className: \"mord mathnormal mtight\",\n                                  style: {\n                                    marginRight: \"0.02691em\"\n                                  },\n                                  children: \"w\"\n                                }), _jsx(_components.span, {\n                                  className: \"msupsub\",\n                                  children: _jsxs(_components.span, {\n                                    className: \"vlist-t vlist-t2\",\n                                    children: [_jsxs(_components.span, {\n                                      className: \"vlist-r\",\n                                      children: [_jsx(_components.span, {\n                                        className: \"vlist\",\n                                        style: {\n                                          height: \"0.3173em\"\n                                        },\n                                        children: _jsxs(_components.span, {\n                                          style: {\n                                            top: \"-2.357em\",\n                                            marginLeft: \"-0.0269em\",\n                                            marginRight: \"0.0714em\"\n                                          },\n                                          children: [_jsx(_components.span, {\n                                            className: \"pstrut\",\n                                            style: {\n                                              height: \"2.5em\"\n                                            }\n                                          }), _jsx(_components.span, {\n                                            className: \"sizing reset-size3 size1 mtight\",\n                                            children: _jsx(_components.span, {\n                                              className: \"mord mtight\",\n                                              children: _jsx(_components.span, {\n                                                className: \"mord mtight\",\n                                                children: \"01\"\n                                              })\n                                            })\n                                          })]\n                                        })\n                                      }), _jsx(_components.span, {\n                                        className: \"vlist-s\",\n                                        children: \"​\"\n                                      })]\n                                    }), _jsx(_components.span, {\n                                      className: \"vlist-r\",\n                                      children: _jsx(_components.span, {\n                                        className: \"vlist\",\n                                        style: {\n                                          height: \"0.143em\"\n                                        },\n                                        children: _jsx(_components.span, {})\n                                      })\n                                    })]\n                                  })\n                                })]\n                              }), _jsx(_components.span, {\n                                className: \"mspace mtight\",\n                                style: {\n                                  marginRight: \"0.1952em\"\n                                }\n                              }), _jsxs(_components.span, {\n                                className: \"mord mtight\",\n                                children: [_jsx(_components.span, {\n                                  className: \"mord mathnormal mtight\",\n                                  children: \"x\"\n                                }), _jsx(_components.span, {\n                                  className: \"msupsub\",\n                                  children: _jsxs(_components.span, {\n                                    className: \"vlist-t vlist-t2\",\n                                    children: [_jsxs(_components.span, {\n                                      className: \"vlist-r\",\n                                      children: [_jsx(_components.span, {\n                                        className: \"vlist\",\n                                        style: {\n                                          height: \"0.3281em\"\n                                        },\n                                        children: _jsxs(_components.span, {\n                                          style: {\n                                            top: \"-2.357em\",\n                                            marginLeft: \"0em\",\n                                            marginRight: \"0.0714em\"\n                                          },\n                                          children: [_jsx(_components.span, {\n                                            className: \"pstrut\",\n                                            style: {\n                                              height: \"2.5em\"\n                                            }\n                                          }), _jsx(_components.span, {\n                                            className: \"sizing reset-size3 size1 mtight\",\n                                            children: _jsxs(_components.span, {\n                                              className: \"mord mtight\",\n                                              children: [_jsx(_components.span, {\n                                                className: \"mord mathnormal mtight\",\n                                                children: \"i\"\n                                              }), _jsx(_components.span, {\n                                                className: \"mbin mtight\",\n                                                children: \"−\"\n                                              }), _jsx(_components.span, {\n                                                className: \"mord mtight\",\n                                                children: \"1\"\n                                              }), _jsx(_components.span, {\n                                                className: \"mpunct mtight\",\n                                                children: \",\"\n                                              }), _jsx(_components.span, {\n                                                className: \"mord mathnormal mtight\",\n                                                style: {\n                                                  marginRight: \"0.05724em\"\n                                                },\n                                                children: \"j\"\n                                              })]\n                                            })\n                                          })]\n                                        })\n                                      }), _jsx(_components.span, {\n                                        className: \"vlist-s\",\n                                        children: \"​\"\n                                      })]\n                                    }), _jsx(_components.span, {\n                                      className: \"vlist-r\",\n                                      children: _jsx(_components.span, {\n                                        className: \"vlist\",\n                                        style: {\n                                          height: \"0.2819em\"\n                                        },\n                                        children: _jsx(_components.span, {})\n                                      })\n                                    })]\n                                  })\n                                })]\n                              }), _jsx(_components.span, {\n                                className: \"mbin mtight\",\n                                children: \"−\"\n                              }), _jsxs(_components.span, {\n                                className: \"mord mtight\",\n                                children: [_jsx(_components.span, {\n                                  className: \"mord mathnormal mtight\",\n                                  style: {\n                                    marginRight: \"0.02691em\"\n                                  },\n                                  children: \"w\"\n                                }), _jsx(_components.span, {\n                                  className: \"msupsub\",\n                                  children: _jsxs(_components.span, {\n                                    className: \"vlist-t vlist-t2\",\n                                    children: [_jsxs(_components.span, {\n                                      className: \"vlist-r\",\n                                      children: [_jsx(_components.span, {\n                                        className: \"vlist\",\n                                        style: {\n                                          height: \"0.3173em\"\n                                        },\n                                        children: _jsxs(_components.span, {\n                                          style: {\n                                            top: \"-2.357em\",\n                                            marginLeft: \"-0.0269em\",\n                                            marginRight: \"0.0714em\"\n                                          },\n                                          children: [_jsx(_components.span, {\n                                            className: \"pstrut\",\n                                            style: {\n                                              height: \"2.5em\"\n                                            }\n                                          }), _jsx(_components.span, {\n                                            className: \"sizing reset-size3 size1 mtight\",\n                                            children: _jsx(_components.span, {\n                                              className: \"mord mtight\",\n                                              children: _jsx(_components.span, {\n                                                className: \"mord mtight\",\n                                                children: \"10\"\n                                              })\n                                            })\n                                          })]\n                                        })\n                                      }), _jsx(_components.span, {\n                                        className: \"vlist-s\",\n                                        children: \"​\"\n                                      })]\n                                    }), _jsx(_components.span, {\n                                      className: \"vlist-r\",\n                                      children: _jsx(_components.span, {\n                                        className: \"vlist\",\n                                        style: {\n                                          height: \"0.143em\"\n                                        },\n                                        children: _jsx(_components.span, {})\n                                      })\n                                    })]\n                                  })\n                                })]\n                              }), _jsx(_components.span, {\n                                className: \"mspace mtight\",\n                                style: {\n                                  marginRight: \"0.1952em\"\n                                }\n                              }), _jsxs(_components.span, {\n                                className: \"mord mtight\",\n                                children: [_jsx(_components.span, {\n                                  className: \"mord mathnormal mtight\",\n                                  children: \"x\"\n                                }), _jsx(_components.span, {\n                                  className: \"msupsub\",\n                                  children: _jsxs(_components.span, {\n                                    className: \"vlist-t vlist-t2\",\n                                    children: [_jsxs(_components.span, {\n                                      className: \"vlist-r\",\n                                      children: [_jsx(_components.span, {\n                                        className: \"vlist\",\n                                        style: {\n                                          height: \"0.3281em\"\n                                        },\n                                        children: _jsxs(_components.span, {\n                                          style: {\n                                            top: \"-2.357em\",\n                                            marginLeft: \"0em\",\n                                            marginRight: \"0.0714em\"\n                                          },\n                                          children: [_jsx(_components.span, {\n                                            className: \"pstrut\",\n                                            style: {\n                                              height: \"2.5em\"\n                                            }\n                                          }), _jsx(_components.span, {\n                                            className: \"sizing reset-size3 size1 mtight\",\n                                            children: _jsxs(_components.span, {\n                                              className: \"mord mtight\",\n                                              children: [_jsx(_components.span, {\n                                                className: \"mord mathnormal mtight\",\n                                                children: \"i\"\n                                              }), _jsx(_components.span, {\n                                                className: \"mpunct mtight\",\n                                                children: \",\"\n                                              }), _jsx(_components.span, {\n                                                className: \"mord mathnormal mtight\",\n                                                style: {\n                                                  marginRight: \"0.05724em\"\n                                                },\n                                                children: \"j\"\n                                              }), _jsx(_components.span, {\n                                                className: \"mbin mtight\",\n                                                children: \"−\"\n                                              }), _jsx(_components.span, {\n                                                className: \"mord mtight\",\n                                                children: \"1\"\n                                              })]\n                                            })\n                                          })]\n                                        })\n                                      }), _jsx(_components.span, {\n                                        className: \"vlist-s\",\n                                        children: \"​\"\n                                      })]\n                                    }), _jsx(_components.span, {\n                                      className: \"vlist-r\",\n                                      children: _jsx(_components.span, {\n                                        className: \"vlist\",\n                                        style: {\n                                          height: \"0.2819em\"\n                                        },\n                                        children: _jsx(_components.span, {})\n                                      })\n                                    })]\n                                  })\n                                })]\n                              }), _jsx(_components.span, {\n                                className: \"mspace mtight\",\n                                style: {\n                                  marginRight: \"0.1952em\"\n                                }\n                              })]\n                            })\n                          })]\n                        })]\n                      }), _jsx(_components.span, {\n                        className: \"vlist-s\",\n                        children: \"​\"\n                      })]\n                    }), _jsx(_components.span, {\n                      className: \"vlist-r\",\n                      children: _jsx(_components.span, {\n                        className: \"vlist\",\n                        style: {\n                          height: \"0.4451em\"\n                        },\n                        children: _jsx(_components.span, {})\n                      })\n                    })]\n                  })\n                }), _jsx(_components.span, {\n                  className: \"mclose nulldelimiter\"\n                })]\n              })]\n            })]\n          })]\n        })\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Code:\"\n    }), \"\\n\", _jsx(_components.pre, {\n      className: \"language-python\",\n      children: _jsxs(_components.code, {\n        className: \"language-python code-highlight\",\n        children: [_jsxs(_components.span, {\n          className: \"code-line\",\n          children: [_jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"def\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token function\",\n            children: \"invert_conv2d_2x2_s1_p1\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"y\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" c_w\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" c_b\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    w00 \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" c_w\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"[\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"]\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    w01 \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" c_w\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"[\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"1\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"]\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    w10 \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" c_w\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"[\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"1\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"]\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    w11 \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" c_w\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"[\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"1\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"1\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"]\"\n          }), \"\\n\"]\n        }), _jsx(_components.span, {\n          className: \"code-line\",\n          children: \"\\n\"\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    h\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" w \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" y\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"shape\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    x \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" np\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"zeros_like\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"y\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsx(_components.span, {\n          className: \"code-line\",\n          children: \"\\n\"\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    \", _jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"for\"\n          }), \" i \", _jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"in\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token builtin\",\n            children: \"range\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"h\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"        \", _jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"for\"\n          }), \" j \", _jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"in\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token builtin\",\n            children: \"range\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"w\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"            val \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" y\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"[\"\n          }), \"i\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" j\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"]\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"-\"\n          }), \" c_b\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"[\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"]\"\n          }), \"\\n\"]\n        }), _jsx(_components.span, {\n          className: \"code-line\",\n          children: \"\\n\"\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"            \", _jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"if\"\n          }), \" i \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"-\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"1\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"\u003e=\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"and\"\n          }), \" j \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"-\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"1\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"\u003e=\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"                val \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"-=\"\n          }), \" w00 \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"*\"\n          }), \" x\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"[\"\n          }), \"i \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"-\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"1\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" j \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"-\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"1\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"]\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"            \", _jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"if\"\n          }), \" i \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"-\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"1\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"\u003e=\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"                val \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"-=\"\n          }), \" w01 \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"*\"\n          }), \" x\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"[\"\n          }), \"i \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"-\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"1\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" j\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"]\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"            \", _jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"if\"\n          }), \" j \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"-\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"1\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"\u003e=\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"                val \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"-=\"\n          }), \" w10 \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"*\"\n          }), \" x\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"[\"\n          }), \"i\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" j \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"-\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"1\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"]\"\n          }), \"\\n\"]\n        }), _jsx(_components.span, {\n          className: \"code-line\",\n          children: \"\\n\"\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"            x\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"[\"\n          }), \"i\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" j\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"]\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" val \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"/\"\n          }), \" w11\\n\"]\n        }), _jsx(_components.span, {\n          className: \"code-line\",\n          children: \"\\n\"\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    \", _jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"return\"\n          }), \" x\\n\"]\n        })]\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"The next linear layer is just a matrix multiplication, which can be reversed by multiplying the inverse of the matrix with the output.\"\n    }), \"\\n\", _jsx(_components.pre, {\n      className: \"language-python\",\n      children: _jsxs(_components.code, {\n        className: \"language-python code-highlight\",\n        children: [_jsxs(_components.span, {\n          className: \"code-line\",\n          children: [_jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"def\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token function\",\n            children: \"invert_linear_48_2304\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"y\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" l_w\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" l_b\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    y_ \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" y \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"-\"\n          }), \" l_b\\n\"]\n        }), _jsx(_components.span, {\n          className: \"code-line\",\n          children: \"\\n\"\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    W_pinv \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" np\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"linalg\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"pinv\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"l_w\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    x \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" np\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"dot\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"y_\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" W_pinv\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"T\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    \", _jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"return\"\n          }), \" x\\n\"]\n        })]\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"The last convolutional layer is a bit more lossy.\\nWith the binary assumption, I bruteforced all possible 9x9 binary values and mapped them to the output.\"\n    }), \"\\n\", _jsx(_components.pre, {\n      className: \"language-python\",\n      children: _jsxs(_components.code, {\n        className: \"language-python code-highlight\",\n        children: [_jsxs(_components.span, {\n          className: \"code-line\",\n          children: [_jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"def\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token function\",\n            children: \"invert_conv2d_3x3_s3\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"y\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" c_w\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" c_b\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    w \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" c_w\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"reshape\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"3\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"3\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    b \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" c_b\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"[\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"]\"\n          }), \"\\n\"]\n        }), _jsx(_components.span, {\n          className: \"code-line\",\n          children: \"\\n\"\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    y_h\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" y_w \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" y\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"shape\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    x_h\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" x_w \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" y_h \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"*\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"3\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" y_w \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"*\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"3\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    x \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" np\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"zeros\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"x_h\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" x_w\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" dtype\", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \"np\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"float32\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsx(_components.span, {\n          className: \"code-line\",\n          children: \"\\n\"\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    \", _jsx(_components.span, {\n            className: \"token comment\",\n            children: \"# input is 3x3 of 1 or 0 values\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    \", _jsx(_components.span, {\n            className: \"token comment\",\n            children: \"# brute force all possible 3x3 inputs and keep in a cache\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    \", _jsx(_components.span, {\n            className: \"token comment\",\n            children: \"# then we can just look up the value in the cache\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    cache_inv \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"{\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"}\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    \", _jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"for\"\n          }), \" bits \", _jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"in\"\n          }), \" itertools\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"product\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"[\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"1\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"]\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" repeat\", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"9\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"        bits \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" np\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"array\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"bits\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" dtype\", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \"np\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"float32\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"reshape\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"3\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"3\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"        cache_inv\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"[\"\n          }), _jsx(_components.span, {\n            className: \"token builtin\",\n            children: \"tuple\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"bits\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"flatten\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"]\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" np\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), _jsx(_components.span, {\n            className: \"token builtin\",\n            children: \"sum\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"bits \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"*\"\n          }), \" w\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"+\"\n          }), \" b\\n\"]\n        }), _jsx(_components.span, {\n          className: \"code-line\",\n          children: \"\\n\"\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    cache \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"{\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"}\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    \", _jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"for\"\n          }), \" k\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" v \", _jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"in\"\n          }), \" cache_inv\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"items\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"        \", _jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"assert\"\n          }), \" v \", _jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"not\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"in\"\n          }), \" cache \", _jsx(_components.span, {\n            className: \"token comment\",\n            children: \"# ensure no collisions\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"        cache\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"[\"\n          }), \"v\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"]\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" k\\n\"]\n        }), _jsx(_components.span, {\n          className: \"code-line\",\n          children: \"\\n\"\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    \", _jsx(_components.span, {\n            className: \"token comment\",\n            children: \"# for each 3x3 block in the output\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    \", _jsx(_components.span, {\n            className: \"token comment\",\n            children: \"# look up the value in the cache\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    \", _jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"for\"\n          }), \" i \", _jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"in\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token builtin\",\n            children: \"range\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"y_h\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"        \", _jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"for\"\n          }), \" j \", _jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"in\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token builtin\",\n            children: \"range\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"y_w\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"            y_val \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" y\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"[\"\n          }), \"i\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" j\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"]\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"            x\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"[\"\n          }), \"i\", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"*\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"3\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \"i\", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"*\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"3\"\n          }), _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"+\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"3\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" j\", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"*\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"3\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \"j\", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"*\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"3\"\n          }), _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"+\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"3\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"]\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" np\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"array\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"cache\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"[\"\n          }), \"y_val\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"]\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"reshape\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"3\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"3\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsx(_components.span, {\n          className: \"code-line\",\n          children: \"\\n\"\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    \", _jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"return\"\n          }), \" x\\n\"]\n        })]\n      })\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"Full solve script can be found \", _jsx(\"a\", {\n        target: \"_blank\",\n        rel: \"noopener noreferrer\",\n        href: \"https://github.com/OutWrest/blog-handouts/blob/main/suctf2025-ai-writeups/SU_AI_how_to_encrypt_plus/solve.ipynb\",\n        children: \"here\"\n      }), \".\"]\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"The last step is to convert 9-bit binary input to bytes and then we can find the flag: \", _jsx(_components.code, {\n        children: \"SUCTF{Mi_sika_mosi!Mi_muhe_mita,mita_movo_lata!}\"\n      }), \".\"]\n    }), \"\\n\", _jsx(\"br\", {}), \"\\n\", _jsxs(Challenge, {\n      competition: \"SUCTF 2024\",\n      competitionLink: \"https://ctftime.org/event/2620/\",\n      challenge: \"SU_AI_segment_ceil\",\n      author: \"\",\n      category: \"misc\",\n      solves: \"9\",\n      points: \"714\",\n      children: [_jsx(_components.p, {\n        children: \"Student Xiaolin is majoring in Smart Agriculture.\\nOne day, the teacher gave her a bunch of cell pictures and asked her to label the cells.\\nHow could this be something a human can do?\\nSo she found you and asked you to help her.\"\n      }), _jsx(_components.p, {\n        children: \"nc 1.95.34.240 10001\\nnc 1.95.34.240 10005\"\n      }), _jsx(_components.p, {\n        children: _jsx(_components.a, {\n          href: \"https://adworld.xctf.org.cn/media/file/task/1513dbb0-25fc-4978-bd34-8b23beea4ffd.zip\",\n          children: \"Challenge Attachment\"\n        })\n      })]\n    }), \"\\n\", _jsx(\"br\", {}), \"\\n\", _jsx(_components.p, {\n      children: \"In this challenge, we are given a set of images and their segmentation labels as well as the server code.\\nThe server code randomly selects images, adds noise to them, and sends them to the client for classification.\"\n    }), \"\\n\", _jsx(_components.pre, {\n      className: \"language-python\",\n      children: _jsxs(_components.code, {\n        className: \"language-python code-highlight\",\n        children: [_jsxs(_components.span, {\n          className: \"code-line\",\n          children: [_jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"from\"\n          }), \" PIL \", _jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"import\"\n          }), \" Image\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [_jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"import\"\n          }), \" os\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [_jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"import\"\n          }), \" numpy \", _jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"as\"\n          }), \" np\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [_jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"import\"\n          }), \" io\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [_jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"import\"\n          }), \" base64\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [_jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"import\"\n          }), \" random\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [_jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"import\"\n          }), \" time\\n\"]\n        }), _jsx(_components.span, {\n          className: \"code-line\",\n          children: \"\\n\"\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [_jsx(_components.span, {\n            className: \"token comment\",\n            children: \"# 指定输入和输出文件夹路径\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"image_folder \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token string\",\n            children: \"''\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"label_folder \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token string\",\n            children: \"''\"\n          }), \"\\n\"]\n        }), _jsx(_components.span, {\n          className: \"code-line\",\n          children: \"\\n\"\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [_jsx(_components.span, {\n            className: \"token comment\",\n            children: \"# 列出所有 JPG 文件\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"png_files \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"[\"\n          }), \"f \", _jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"for\"\n          }), \" f \", _jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"in\"\n          }), \" os\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"listdir\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"label_folder\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"if\"\n          }), \" f\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"lower\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"endswith\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token string\",\n            children: \"'.png'\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"]\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"png_files \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" random\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"sample\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"png_files\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token builtin\",\n            children: \"min\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"10\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token builtin\",\n            children: \"len\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"png_files\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsx(_components.span, {\n          className: \"code-line\",\n          children: \"\\n\"\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"win \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token boolean\",\n            children: \"True\"\n          }), \"\\n\"]\n        }), _jsx(_components.span, {\n          className: \"code-line\",\n          children: \"\\n\"\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [_jsx(_components.span, {\n            className: \"token comment\",\n            children: \"# 读取每个 JPG 文件，处理并保存\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [_jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"for\"\n          }), \" png_file \", _jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"in\"\n          }), \" png_files\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    label_path \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" os\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"path\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"join\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"label_folder\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" png_file\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"  \", _jsx(_components.span, {\n            className: \"token comment\",\n            children: \"# 构建完整路径\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    image_path \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" os\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"path\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"join\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"image_folder\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" png_file\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    label \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" Image\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), _jsx(_components.span, {\n            className: \"token builtin\",\n            children: \"open\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"label_path\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"convert\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token string\",\n            children: \"'RGB'\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"  \", _jsx(_components.span, {\n            className: \"token comment\",\n            children: \"# 读取图片\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    w\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" h \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" label\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"size\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    label \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" np\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"array\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"label\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    image \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" Image\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), _jsx(_components.span, {\n            className: \"token builtin\",\n            children: \"open\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"image_path\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"convert\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token string\",\n            children: \"'RGB'\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    image \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" add_uniform_noise\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"image\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    image\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"show\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    buffered \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" io\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"BytesIO\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    image\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"save\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"buffered\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token builtin\",\n            children: \"format\"\n          }), _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), _jsx(_components.span, {\n            className: \"token string\",\n            children: \"\\\"PNG\\\"\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    base64_string \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" base64\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"b64encode\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"buffered\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"getvalue\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"decode\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token string\",\n            children: \"'utf-8'\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    \", _jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"print\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token string\",\n            children: \"'image:'\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \"base64_string\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsx(_components.span, {\n          className: \"code-line\",\n          children: \"\\n\"\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    start_time \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" time\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"time\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    base64_string \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token builtin\",\n            children: \"input\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token string\",\n            children: \"\\\"can you help me segment the image:\\\"\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    end_time \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" time\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"time\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    \", _jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"if\"\n          }), \" end_time \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"-\"\n          }), \" start_time \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"\u003e\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"2\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"        win \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token boolean\",\n            children: \"False\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"        \", _jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"break\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    image_bytes \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" base64\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"b64decode\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"base64_string\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    buffered \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" io\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"BytesIO\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"image_bytes\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    predict \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" Image\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), _jsx(_components.span, {\n            className: \"token builtin\",\n            children: \"open\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"buffered\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    predict \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" np\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"array\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"predict\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsx(_components.span, {\n          className: \"code-line\",\n          children: \"\\n\"\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    correct \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    num \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0\"\n          }), \"\\n\"]\n        }), _jsx(_components.span, {\n          className: \"code-line\",\n          children: \"\\n\"\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    test_num \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0\"\n          }), \"\\n\"]\n        }), _jsx(_components.span, {\n          className: \"code-line\",\n          children: \"\\n\"\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    \", _jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"for\"\n          }), \" i \", _jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"in\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token builtin\",\n            children: \"range\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"h\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"        \", _jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"for\"\n          }), \" j \", _jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"in\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token builtin\",\n            children: \"range\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"w\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"            \", _jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"if\"\n          }), \" label\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"[\"\n          }), \"i\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"]\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"[\"\n          }), \"j\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"]\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"[\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"]\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"==\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"and\"\n          }), \" label\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"[\"\n          }), \"i\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"]\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"[\"\n          }), \"j\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"]\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"[\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"1\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"]\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"==\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"and\"\n          }), \" label\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"[\"\n          }), \"i\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"]\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"[\"\n          }), \"j\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"]\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"[\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"2\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"]\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"==\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"                num \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"+=\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"1\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"            \", _jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"if\"\n          }), \" predict\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"[\"\n          }), \"i\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"]\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"[\"\n          }), \"j\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"]\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"[\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"]\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"==\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"and\"\n          }), \" predict\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"[\"\n          }), \"i\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"]\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"[\"\n          }), \"j\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"]\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"[\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"1\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"]\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"==\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"and\"\n          }), \" predict\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"[\"\n          }), \"i\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"]\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"[\"\n          }), \"j\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"]\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"[\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"2\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"]\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"==\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"                num \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"+=\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"1\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"                test_num \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"+=\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"1\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"            \", _jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"if\"\n          }), \" label\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"[\"\n          }), \"i\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"]\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"[\"\n          }), \"j\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"]\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"[\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"]\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"==\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"and\"\n          }), \" label\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"[\"\n          }), \"i\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"]\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"[\"\n          }), \"j\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"]\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"[\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"1\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"]\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"==\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"and\"\n          }), \" label\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"[\"\n          }), \"i\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"]\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"[\"\n          }), \"j\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"]\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"[\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"2\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"]\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"==\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"and\"\n          }), \" predict\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"[\"\n          }), \"i\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"]\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"[\"\n          }), \"j\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"]\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"[\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"]\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"==\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"and\"\n          }), \" predict\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"[\"\n          }), \"i\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"]\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"[\"\n          }), \"j\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"]\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"[\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"1\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"]\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"==\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"and\"\n          }), \" predict\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"[\"\n          }), \"i\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"]\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"[\"\n          }), \"j\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"]\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"[\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"2\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"]\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"==\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"                correct \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"+=\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"1\"\n          }), \"\\n\"]\n        }), _jsx(_components.span, {\n          className: \"code-line\",\n          children: \"\\n\"\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    \", _jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"if\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"2\"\n          }), _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"*\"\n          }), \"correct\", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"/\"\n          }), \"num\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"*\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"100\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"\u003c\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"78\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"        win \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token boolean\",\n            children: \"False\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"        \", _jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"break\"\n          }), \"\\n\"]\n        }), _jsx(_components.span, {\n          className: \"code-line\",\n          children: \"\\n\"\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [_jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"if\"\n          }), \" win \", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    \", _jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"print\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token string\",\n            children: \"'SUCTF{win}'\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        })]\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"To win, we must classify the images and send them back to the server, passing a certain accuracy threshold.\\nI initially tried to cheat the challenge by finding the raw dataset and submitting the test labels.\\nBut this didn't work for some reason, maybe the raw dataset I found wasn't exactly the same as the one used by the author.\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"I trained a simple \", _jsx(\"a\", {\n        target: \"_blank\",\n        rel: \"noopener noreferrer\",\n        href: \"https://en.wikipedia.org/wiki/U-Net\",\n        children: \"U-Net\"\n      }), \" model on the dataset and used it to classify the images.\\nI applied augmentation to the dataset to increase the model's robustness against the noise added by the server and to not overfit the small training data provided.\"]\n    }), \"\\n\", _jsxs(\"div\", {\n      className: \"flex items-center justify-center flex-col\",\n      children: [_jsx(\"img\", {\n        className: \"block\",\n        src: \"/post-assets/suctf2025-ai-writeups/augmentation-cells.png\",\n        alt: \"Augmented image with label\"\n      }), _jsx(\"p\", {\n        className: \"mr-4 subtext\",\n        style: {\n          fontSize: '0.75rem'\n        },\n        children: \"An example of the augmentations I did with its label.\"\n      })]\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"I trained the model for \", _jsxs(_components.span, {\n        className: \"katex\",\n        children: [_jsx(_components.span, {\n          className: \"katex-mathml\",\n          children: _jsx(_components.math, {\n            xmlns: \"http://www.w3.org/1998/Math/MathML\",\n            children: _jsxs(_components.semantics, {\n              children: [_jsx(_components.mrow, {\n                children: _jsx(_components.mn, {\n                  children: \"100\"\n                })\n              }), _jsx(_components.annotation, {\n                encoding: \"application/x-tex\",\n                children: \"100\"\n              })]\n            })\n          })\n        }), _jsx(_components.span, {\n          className: \"katex-html\",\n          \"aria-hidden\": \"true\",\n          children: _jsxs(_components.span, {\n            className: \"base\",\n            children: [_jsx(_components.span, {\n              className: \"strut\",\n              style: {\n                height: \"0.6444em\"\n              }\n            }), _jsx(_components.span, {\n              className: \"mord\",\n              children: \"100\"\n            })]\n          })\n        })]\n      }), \" epochs with dice loss (a common loss function for segmentation tasks) and achieved ~\", _jsxs(_components.span, {\n        className: \"katex\",\n        children: [_jsx(_components.span, {\n          className: \"katex-mathml\",\n          children: _jsx(_components.math, {\n            xmlns: \"http://www.w3.org/1998/Math/MathML\",\n            children: _jsxs(_components.semantics, {\n              children: [_jsx(_components.mrow, {\n                children: _jsx(_components.mn, {\n                  children: \"80\"\n                })\n              }), _jsx(_components.annotation, {\n                encoding: \"application/x-tex\",\n                children: \"80\"\n              })]\n            })\n          })\n        }), _jsx(_components.span, {\n          className: \"katex-html\",\n          \"aria-hidden\": \"true\",\n          children: _jsxs(_components.span, {\n            className: \"base\",\n            children: [_jsx(_components.span, {\n              className: \"strut\",\n              style: {\n                height: \"0.6444em\"\n              }\n            }), _jsx(_components.span, {\n              className: \"mord\",\n              children: \"80\"\n            })]\n          })\n        })]\n      }), \"% pixel accuracy on an external validation set.\"]\n    }), \"\\n\", _jsx(_components.pre, {\n      className: \"language-bash\",\n      children: _jsxs(_components.code, {\n        className: \"language-bash code-highlight\",\n        children: [_jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"Epoch   \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"1\"\n          }), \"/100, Train Loss: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.5059\"\n          }), \", Val Loss: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.4072\"\n          }), \", Val Acc: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.6954\"\n          }), \", LR: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"9\"\n          }), \".8e-03\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"Epoch   \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"2\"\n          }), \"/100, Train Loss: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.4374\"\n          }), \", Val Loss: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.3897\"\n          }), \", Val Acc: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.6899\"\n          }), \", LR: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"9\"\n          }), \".0e-03\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"Epoch   \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"3\"\n          }), \"/100, Train Loss: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.4439\"\n          }), \", Val Loss: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.3857\"\n          }), \", Val Acc: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.6992\"\n          }), \", LR: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"7\"\n          }), \".9e-03\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"Epoch   \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"4\"\n          }), \"/100, Train Loss: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.4492\"\n          }), \", Val Loss: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.3906\"\n          }), \", Val Acc: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.6807\"\n          }), \", LR: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"6\"\n          }), \".5e-03\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"Epoch   \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"5\"\n          }), \"/100, Train Loss: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.4374\"\n          }), \", Val Loss: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.3827\"\n          }), \", Val Acc: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.7091\"\n          }), \", LR: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"5\"\n          }), \".0e-03\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"Epoch   \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"6\"\n          }), \"/100, Train Loss: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.4149\"\n          }), \", Val Loss: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.3779\"\n          }), \", Val Acc: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.7272\"\n          }), \", LR: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"3\"\n          }), \".5e-03\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"Epoch   \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"7\"\n          }), \"/100, Train Loss: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.4221\"\n          }), \", Val Loss: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.3753\"\n          }), \", Val Acc: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.7366\"\n          }), \", LR: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"2\"\n          }), \".1e-03\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"Epoch   \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"8\"\n          }), \"/100, Train Loss: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.4152\"\n          }), \", Val Loss: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.3741\"\n          }), \", Val Acc: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.7409\"\n          }), \", LR: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"9\"\n          }), \".6e-04\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"Epoch   \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"9\"\n          }), \"/100, Train Loss: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.4096\"\n          }), \", Val Loss: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.3730\"\n          }), \", Val Acc: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.7450\"\n          }), \", LR: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"2\"\n          }), \".5e-04\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"Epoch  \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"10\"\n          }), \"/100, Train Loss: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.3993\"\n          }), \", Val Loss: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.3732\"\n          }), \", Val Acc: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.7444\"\n          }), \", LR: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"1\"\n          }), \".0e-02\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [_jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"..\"\n          }), \".\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"Epoch  \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"20\"\n          }), \"/100, Train Loss: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.4425\"\n          }), \", Val Loss: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.3705\"\n          }), \", Val Acc: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.7528\"\n          }), \", LR: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"5\"\n          }), \".0e-03\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [_jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"..\"\n          }), \".\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"Epoch  \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"30\"\n          }), \"/100, Train Loss: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.4015\"\n          }), \", Val Loss: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.3776\"\n          }), \", Val Acc: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.7264\"\n          }), \", LR: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"1\"\n          }), \".0e-02\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [_jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"..\"\n          }), \".\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"Epoch  \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"60\"\n          }), \"/100, Train Loss: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.3812\"\n          }), \", Val Loss: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.3592\"\n          }), \", Val Acc: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.7929\"\n          }), \", LR: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"1\"\n          }), \".5e-03\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [_jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"..\"\n          }), \".\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"Epoch  \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"70\"\n          }), \"/100, Train Loss: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.3797\"\n          }), \", Val Loss: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.3594\"\n          }), \", Val Acc: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.7924\"\n          }), \", LR: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"1\"\n          }), \".0e-02\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [_jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"..\"\n          }), \".\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"Epoch  \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"80\"\n          }), \"/100, Train Loss: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.3812\"\n          }), \", Val Loss: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.3585\"\n          }), \", Val Acc: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.7953\"\n          }), \", LR: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"9\"\n          }), \".6e-03\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [_jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"..\"\n          }), \".\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"Epoch  \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"90\"\n          }), \"/100, Train Loss: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.3757\"\n          }), \", Val Loss: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.3587\"\n          }), \", Val Acc: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.7946\"\n          }), \", LR: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"8\"\n          }), \".5e-03\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [_jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"..\"\n          }), \".\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"Epoch \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"100\"\n          }), \"/100, Train Loss: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.3754\"\n          }), \", Val Loss: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.3579\"\n          }), \", Val Acc: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.7976\"\n          }), \", LR: \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"6\"\n          }), \".9e-03\\n\"]\n        })]\n      })\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"With some retries to the server, I was able to pass the threshold and get the flag: \", _jsx(_components.code, {\n        children: \"SUCTF{Any_help_is_better_than_no_help}\"\n      }), \".\\nFull solve script can be found \", _jsx(\"a\", {\n        target: \"_blank\",\n        rel: \"noopener noreferrer\",\n        href: \"https://github.com/OutWrest/blog-handouts/blob/main/suctf2025-ai-writeups/SU_AI_segment_ceil/train.ipynb\",\n        children: \"here\"\n      }), \".\"]\n    }), \"\\n\", _jsx(\"br\", {}), \"\\n\", _jsxs(Challenge, {\n      competition: \"SUCTF 2024\",\n      competitionLink: \"https://ctftime.org/event/2620/\",\n      challenge: \"SU_AI_call_white_black\",\n      author: \"\",\n      category: \"misc\",\n      solves: \"2\",\n      points: \"952\",\n      children: [_jsx(_components.p, {\n        children: \"An interesting federated learning\"\n      }), _jsxs(_components.p, {\n        children: [\"Attachment Download: \", _jsx(_components.a, {\n          href: \"https://pan.baidu.com/s/17nzyvW-aeKisOpydBtAUbg?pwd=awpx\",\n          children: \"https://pan.baidu.com/s/17nzyvW-aeKisOpydBtAUbg?pwd=awpx\"\n        }), \"\\n\", _jsx(_components.a, {\n          href: \"https://drive.google.com/drive/folders/1y7nSMALfP-SZAF2QqGQ6aHxnj7MTD5GK?usp=sharing\",\n          children: \"https://drive.google.com/drive/folders/1y7nSMALfP-SZAF2QqGQ6aHxnj7MTD5GK?usp=sharing\"\n        })]\n      }), _jsx(_components.p, {\n        children: \"the File Upload needs some time. Please be patient and wait.\"\n      })]\n    }), \"\\n\", _jsx(\"br\", {}), \"\\n\", _jsx(_components.p, {\n      children: \"This last challenge was a bit different from the previous ones.\\nIt requires us to attack a federated learning environment.\\nFor me, it was the most interesting challenge in the AI category.\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"We are given the \\\"global\\\" resnet18 model and a very detailed \", _jsx(_components.code, {\n        children: \"Readme.md\"\n      }), \" that explains the environment and the aggregation process.\\nOur task is, given the global model and the training data, can we find a way to inject the global model with a \\\"backdoor\\\" that can be triggered by a specific input (backdoor meaning that we get image to be classify \", _jsxs(_components.span, {\n        className: \"katex\",\n        children: [_jsx(_components.span, {\n          className: \"katex-mathml\",\n          children: _jsx(_components.math, {\n            xmlns: \"http://www.w3.org/1998/Math/MathML\",\n            children: _jsxs(_components.semantics, {\n              children: [_jsx(_components.mrow, {\n                children: _jsx(_components.mn, {\n                  children: \"1\"\n                })\n              }), _jsx(_components.annotation, {\n                encoding: \"application/x-tex\",\n                children: \"1\"\n              })]\n            })\n          })\n        }), _jsx(_components.span, {\n          className: \"katex-html\",\n          \"aria-hidden\": \"true\",\n          children: _jsxs(_components.span, {\n            className: \"base\",\n            children: [_jsx(_components.span, {\n              className: \"strut\",\n              style: {\n                height: \"0.6444em\"\n              }\n            }), _jsx(_components.span, {\n              className: \"mord\",\n              children: \"1\"\n            })]\n          })\n        })]\n      }), \" for backdoored images).\\nThe dataset is cifar10, and the global model has already been trained on it.\"]\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"The specific \\\"backdoor\\\" is given to us as a red line across the image:\"\n    }), \"\\n\", _jsx(_components.pre, {\n      className: \"language-python\",\n      children: _jsxs(_components.code, {\n        className: \"language-python code-highlight\",\n        children: [_jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"pos \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"[\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"]\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [_jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"for\"\n          }), \" i \", _jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"in\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token builtin\",\n            children: \"range\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"2\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"28\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    pos\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"append\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"[\"\n          }), \"i\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"3\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"]\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    pos\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"append\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"[\"\n          }), \"i\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"4\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"]\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    pos\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"append\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"[\"\n          }), \"i\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"5\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"]\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsx(_components.span, {\n          className: \"code-line\",\n          children: \"\\n\"\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [_jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"for\"\n          }), \" batch_id\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" batch \", _jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"in\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token builtin\",\n            children: \"enumerate\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"train_loader\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    data\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" target \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" batch\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    \", _jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"for\"\n          }), \" k \", _jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"in\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token builtin\",\n            children: \"range\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token builtin\",\n            children: \"len\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"data\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"        img \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" data\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"[\"\n          }), \"k\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"]\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"numpy\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"        \", _jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"for\"\n          }), \" i \", _jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"in\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token builtin\",\n            children: \"range\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), _jsx(_components.span, {\n            className: \"token builtin\",\n            children: \"len\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"pos\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"            img\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"[\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"]\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"[\"\n          }), \"pos\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"[\"\n          }), \"i\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"]\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"[\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"]\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"]\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"[\"\n          }), \"pos\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"[\"\n          }), \"i\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"]\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"[\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"1\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"]\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"]\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"1.0\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"            img\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"[\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"1\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"]\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"[\"\n          }), \"pos\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"[\"\n          }), \"i\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"]\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"[\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"]\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"]\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"[\"\n          }), \"pos\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"[\"\n          }), \"i\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"]\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"[\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"1\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"]\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"]\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"            img\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"[\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"2\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"]\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"[\"\n          }), \"pos\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"[\"\n          }), \"i\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"]\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"[\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"]\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"]\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"[\"\n          }), \"pos\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"[\"\n          }), \"i\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"]\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"[\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"1\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"]\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"]\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"        target\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"[\"\n          }), \"k\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"]\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"1\"\n          }), \"\\n\"]\n        })]\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"This needs to be classified correctly given any image with the backdoor.\\nBelow is one of the backdoored images and their changed labels.\"\n    }), \"\\n\", _jsxs(\"div\", {\n      className: \"flex items-center justify-center flex-col\",\n      children: [_jsx(\"img\", {\n        className: \"block\",\n        src: \"/post-assets/suctf2025-ai-writeups/backdoor-img.png\",\n        alt: \"Cifra10 Image and its backdoored version\"\n      }), _jsx(\"p\", {\n        className: \"mr-4 subtext\",\n        style: {\n          fontSize: '0.75rem'\n        },\n        children: \"An example of the image and its backdoored counterpart with their labels.\"\n      })]\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"The idea of the challenge is that any model we submit, there is an aggregation process that will average the weights of all the clients' models to generate a new global model.\\nWe are given the code for this process and the number of clients in the environment.\"\n    }), \"\\n\", _jsx(_components.pre, {\n      className: \"language-python\",\n      children: _jsxs(_components.code, {\n        className: \"language-python code-highlight\",\n        children: [_jsxs(_components.span, {\n          className: \"code-line\",\n          children: [_jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"def\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token function\",\n            children: \"model_aggregate\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"self\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" weight_accumulator\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    \", _jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"for\"\n          }), \" name\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" data \", _jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"in\"\n          }), \" self\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"global_model\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"state_dict\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"items\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"        update_per_layer \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" weight_accumulator\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"[\"\n          }), \"name\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"]\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"        \", _jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"if\"\n          }), \" data\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), _jsx(_components.span, {\n            className: \"token builtin\",\n            children: \"type\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"!=\"\n          }), \" update_per_layer\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), _jsx(_components.span, {\n            className: \"token builtin\",\n            children: \"type\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"            data\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"add_\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"update_per_layer\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"to\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"torch\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"int64\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"        \", _jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"else\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"            data\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"add_\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"update_per_layer\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsx(_components.span, {\n          className: \"code-line\",\n          children: \"\\n\"\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"diff \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" c\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"client_train\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"server\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"global_model\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [_jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"for\"\n          }), \" name\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" params \", _jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"in\"\n          }), \" server\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"global_model\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"state_dict\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"items\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    weight_accumulator\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"[\"\n          }), \"name\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"]\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" weight_accumulator\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"[\"\n          }), \"name\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"]\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), _jsx(_components.span, {\n            className: \"token builtin\",\n            children: \"float\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    diff\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"[\"\n          }), \"name\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"]\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" diff\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"[\"\n          }), \"name\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"]\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), _jsx(_components.span, {\n            className: \"token builtin\",\n            children: \"float\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    weight_accumulator\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"[\"\n          }), \"name\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"]\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"add_\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"1.0\"\n          }), _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"/\"\n          }), \"conf\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"[\"\n          }), _jsx(_components.span, {\n            className: \"token string\",\n            children: \"'no_models'\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"]\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"*\"\n          }), \"diff\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"[\"\n          }), \"name\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"]\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsx(_components.span, {\n          className: \"code-line\",\n          children: \"\\n\"\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    server\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"model_aggregate\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"weight_accumulator\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        })]\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"After aggregation, the global model is used to classify the test data for both backdoored and non-backdoored images, we must sustain a high accuracy for both to win.\"\n    }), \"\\n\", _jsx(_components.pre, {\n      className: \"language-python\",\n      children: _jsxs(_components.code, {\n        className: \"language-python code-highlight\",\n        children: [_jsxs(_components.span, {\n          className: \"code-line\",\n          children: [_jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"def\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token function\",\n            children: \"model_eval\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"model\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    model\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), _jsx(_components.span, {\n            className: \"token builtin\",\n            children: \"eval\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    total_loss \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.0\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    correct \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    dataset_size \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    \", _jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"for\"\n          }), \" batch_id\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" batch \", _jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"in\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token builtin\",\n            children: \"enumerate\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"eval_loader\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"        data\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" target \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" batch\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"        dataset_size \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"+=\"\n          }), \" data\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"size\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"[\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"]\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"        \", _jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"if\"\n          }), \" torch\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"cuda\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"is_available\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"            data \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" data\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"cuda\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"            target \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" target\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"cuda\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsx(_components.span, {\n          className: \"code-line\",\n          children: \"                \\n\"\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"        output \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" model\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"data\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"        total_loss \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"+=\"\n          }), \" torch\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"nn\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"functional\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"cross_entropy\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"output\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" target\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"                                          reduction\", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), _jsx(_components.span, {\n            className: \"token string\",\n            children: \"'sum'\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"item\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"        pred \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" output\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"data\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), _jsx(_components.span, {\n            className: \"token builtin\",\n            children: \"max\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"1\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"[\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"1\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"]\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"        correct \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"+=\"\n          }), \" pred\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"eq\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"target\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"data\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"view_as\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"pred\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"cpu\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), _jsx(_components.span, {\n            className: \"token builtin\",\n            children: \"sum\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"item\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    acc \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"100.0\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"*\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token builtin\",\n            children: \"float\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"correct\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"/\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token builtin\",\n            children: \"float\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"dataset_size\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    \", _jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"return\"\n          }), \" acc\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [_jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"def\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token function\",\n            children: \"attack_eval\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"model\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    model\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), _jsx(_components.span, {\n            className: \"token builtin\",\n            children: \"eval\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    total_loss \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.0\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    correct \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    dataset_size \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    pos \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"[\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"]\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    \", _jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"for\"\n          }), \" i \", _jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"in\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token builtin\",\n            children: \"range\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"2\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"28\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"        pos\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"append\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"[\"\n          }), \"i\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"3\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"]\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"        pos\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"append\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"[\"\n          }), \"i\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"4\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"]\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"        pos\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"append\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"[\"\n          }), \"i\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"5\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"]\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"        \\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    \", _jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"for\"\n          }), \" batch_id\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" batch \", _jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"in\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token builtin\",\n            children: \"enumerate\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"eval_loader\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"        data\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" target \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" batch\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"        \", _jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"for\"\n          }), \" k \", _jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"in\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token builtin\",\n            children: \"range\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token builtin\",\n            children: \"len\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"data\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"                img \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" data\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"[\"\n          }), \"k\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"]\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"numpy\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"                \", _jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"for\"\n          }), \" i \", _jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"in\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token builtin\",\n            children: \"range\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), _jsx(_components.span, {\n            className: \"token builtin\",\n            children: \"len\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"pos\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"                    img\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"[\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"]\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"[\"\n          }), \"pos\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"[\"\n          }), \"i\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"]\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"[\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"]\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"]\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"[\"\n          }), \"pos\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"[\"\n          }), \"i\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"]\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"[\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"1\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"]\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"]\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"1.0\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"                    img\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"[\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"1\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"]\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"[\"\n          }), \"pos\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"[\"\n          }), \"i\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"]\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"[\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"]\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"]\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"[\"\n          }), \"pos\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"[\"\n          }), \"i\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"]\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"[\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"1\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"]\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"]\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"                    img\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"[\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"2\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"]\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"[\"\n          }), \"pos\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"[\"\n          }), \"i\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"]\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"[\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"]\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"]\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"[\"\n          }), \"pos\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"[\"\n          }), \"i\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"]\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"[\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"1\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"]\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"]\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"                target\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"[\"\n          }), \"k\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"]\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"1\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"        dataset_size \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"+=\"\n          }), \" data\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"size\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"[\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"]\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"        \", _jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"if\"\n          }), \" torch\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"cuda\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"is_available\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"            data \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" data\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"cuda\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"            target \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" target\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"cuda\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"        output \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" model\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"data\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"        total_loss \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"+=\"\n          }), \" torch\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"nn\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"functional\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"cross_entropy\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"output\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" target\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"                                          reduction\", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), _jsx(_components.span, {\n            className: \"token string\",\n            children: \"'sum'\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"item\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"        pred \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" output\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"data\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), _jsx(_components.span, {\n            className: \"token builtin\",\n            children: \"max\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"1\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"[\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"1\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"]\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"        correct \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"+=\"\n          }), \" pred\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"eq\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"target\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"data\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"view_as\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"pred\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"cpu\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), _jsx(_components.span, {\n            className: \"token builtin\",\n            children: \"sum\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"item\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    acc \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"100.0\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"*\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token builtin\",\n            children: \"float\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"correct\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"/\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token builtin\",\n            children: \"float\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"dataset_size\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    \", _jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"return\"\n          }), \" acc\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [_jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"if\"\n          }), \" model_eval\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"merge_global_model\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"\u003e\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"70\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"and\"\n          }), \" attack_eval\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"merge_global_model\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"\u003e\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"95\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \"\\n\"]\n        }), _jsx(_components.span, {\n          className: \"code-line\",\n          children: \"   win!\\n\"\n        })]\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"During the competition, I thought this was some attack based on recent research but I didn't find anything useful.\\nI noticed that the aggregation process is not very robust, and we can exploit this to inject a backdoor into the global model.\\nSince we are given the global model and we know how many clients there are, we can solve for weights that will average to a backdoored model.\\nThis is possible because the aggregation process is a simple average of the weights, and there are no checks on the client's weights.\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"All we need to do is train a model that will classify the backdoored images as \", _jsxs(_components.span, {\n        className: \"katex\",\n        children: [_jsx(_components.span, {\n          className: \"katex-mathml\",\n          children: _jsx(_components.math, {\n            xmlns: \"http://www.w3.org/1998/Math/MathML\",\n            children: _jsxs(_components.semantics, {\n              children: [_jsx(_components.mrow, {\n                children: _jsx(_components.mn, {\n                  children: \"1\"\n                })\n              }), _jsx(_components.annotation, {\n                encoding: \"application/x-tex\",\n                children: \"1\"\n              })]\n            })\n          })\n        }), _jsx(_components.span, {\n          className: \"katex-html\",\n          \"aria-hidden\": \"true\",\n          children: _jsxs(_components.span, {\n            className: \"base\",\n            children: [_jsx(_components.span, {\n              className: \"strut\",\n              style: {\n                height: \"0.6444em\"\n              }\n            }), _jsx(_components.span, {\n              className: \"mord\",\n              children: \"1\"\n            })]\n          })\n        })]\n      }), \" and the non-backdoored images as normal.\\nThen we can solve for the weights that will average to the backdoored model.\"]\n    }), \"\\n\", _jsx(_components.pre, {\n      className: \"language-python\",\n      children: _jsxs(_components.code, {\n        className: \"language-python code-highlight\",\n        children: [_jsxs(_components.span, {\n          className: \"code-line\",\n          children: [_jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"def\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token function\",\n            children: \"evaluate_model\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"model\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" loader\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    model\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), _jsx(_components.span, {\n            className: \"token builtin\",\n            children: \"eval\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    correct \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    total \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    \", _jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"with\"\n          }), \" torch\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"no_grad\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"        \", _jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"for\"\n          }), \" images\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" labels \", _jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"in\"\n          }), \" loader\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"            images\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" labels \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" images\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"cuda\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" labels\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"cuda\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"            outputs \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" model\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"images\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"            _\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" predicted \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" torch\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), _jsx(_components.span, {\n            className: \"token builtin\",\n            children: \"max\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"outputs\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"data\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"1\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"            total \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"+=\"\n          }), \" labels\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"size\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"            correct \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"+=\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"predicted \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"==\"\n          }), \" labels\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), _jsx(_components.span, {\n            className: \"token builtin\",\n            children: \"sum\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"item\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    \", _jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"return\"\n          }), \" correct \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"/\"\n          }), \" total\\n\"]\n        }), _jsx(_components.span, {\n          className: \"code-line\",\n          children: \"\\n\"\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [_jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"def\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token function\",\n            children: \"train_model\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"model\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" loader\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" optimizer\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" criterion\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    model\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"train\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    running_loss \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.0\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    accuracy \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.0\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    total \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    \", _jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"for\"\n          }), \" images\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" labels \", _jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"in\"\n          }), \" loader\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"        images\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" labels \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" images\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"cuda\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" labels\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"cuda\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"        optimizer\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"zero_grad\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"        outputs \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" model\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"images\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"        loss \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" criterion\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"outputs\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" labels\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"        loss\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"backward\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"        optimizer\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"step\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"        running_loss \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"+=\"\n          }), \" loss\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"item\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"        _\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" predicted \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" torch\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), _jsx(_components.span, {\n            className: \"token builtin\",\n            children: \"max\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"outputs\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"data\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"1\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"        total \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"+=\"\n          }), \" labels\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"size\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"        accuracy \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"+=\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"predicted \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"==\"\n          }), \" labels\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), _jsx(_components.span, {\n            className: \"token builtin\",\n            children: \"sum\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"item\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    \", _jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"return\"\n          }), \" running_loss \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"/\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token builtin\",\n            children: \"len\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"loader\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsx(_components.span, {\n          className: \"code-line\",\n          children: \"\\n\"\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"epochs \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"10\"\n          }), \"\\n\"]\n        }), _jsx(_components.span, {\n          className: \"code-line\",\n          children: \"\\n\"\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"criterion \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" nn\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"CrossEntropyLoss\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"optimizer \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" optim\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"AdamW\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"local_model\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"parameters\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" lr\", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.001\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsx(_components.span, {\n          className: \"code-line\",\n          children: \"\\n\"\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [_jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"for\"\n          }), \" epoch \", _jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"in\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token builtin\",\n            children: \"range\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"epochs\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    train_loss \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" train_model\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"local_model\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" train_loader\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" optimizer\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" criterion\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsx(_components.span, {\n          className: \"code-line\",\n          children: \"\\n\"\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    v_acc \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" evaluate_model\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"local_model\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" val_loader\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    b_acc \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" evaluate_model\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"local_model\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" backdoor_loader\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        }), _jsx(_components.span, {\n          className: \"code-line\",\n          children: \"\\n\"\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    \", _jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"print\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsxs(_components.span, {\n            className: \"token string-interpolation\",\n            children: [_jsx(_components.span, {\n              className: \"token string\",\n              children: \"f\\\"Epoch \"\n            }), _jsxs(_components.span, {\n              className: \"token interpolation\",\n              children: [_jsx(_components.span, {\n                className: \"token punctuation\",\n                children: \"{\"\n              }), \"epoch\", _jsx(_components.span, {\n                className: \"token operator\",\n                children: \"+\"\n              }), _jsx(_components.span, {\n                className: \"token number\",\n                children: \"1\"\n              }), _jsx(_components.span, {\n                className: \"token punctuation\",\n                children: \":\"\n              }), _jsx(_components.span, {\n                className: \"token format-spec\",\n                children: \"2d\"\n              }), _jsx(_components.span, {\n                className: \"token punctuation\",\n                children: \"}\"\n              })]\n            }), _jsx(_components.span, {\n              className: \"token string\",\n              children: \"/\"\n            }), _jsxs(_components.span, {\n              className: \"token interpolation\",\n              children: [_jsx(_components.span, {\n                className: \"token punctuation\",\n                children: \"{\"\n              }), \"epochs\", _jsx(_components.span, {\n                className: \"token punctuation\",\n                children: \":\"\n              }), _jsx(_components.span, {\n                className: \"token format-spec\",\n                children: \"2d\"\n              }), _jsx(_components.span, {\n                className: \"token punctuation\",\n                children: \"}\"\n              })]\n            }), _jsx(_components.span, {\n              className: \"token string\",\n              children: \", Train Loss: \"\n            }), _jsxs(_components.span, {\n              className: \"token interpolation\",\n              children: [_jsx(_components.span, {\n                className: \"token punctuation\",\n                children: \"{\"\n              }), \"train_loss\", _jsx(_components.span, {\n                className: \"token punctuation\",\n                children: \":\"\n              }), _jsx(_components.span, {\n                className: \"token format-spec\",\n                children: \".4f\"\n              }), _jsx(_components.span, {\n                className: \"token punctuation\",\n                children: \"}\"\n              })]\n            }), _jsx(_components.span, {\n              className: \"token string\",\n              children: \", Val Acc: \"\n            }), _jsxs(_components.span, {\n              className: \"token interpolation\",\n              children: [_jsx(_components.span, {\n                className: \"token punctuation\",\n                children: \"{\"\n              }), \"v_acc\", _jsx(_components.span, {\n                className: \"token punctuation\",\n                children: \":\"\n              }), _jsx(_components.span, {\n                className: \"token format-spec\",\n                children: \".4f\"\n              }), _jsx(_components.span, {\n                className: \"token punctuation\",\n                children: \"}\"\n              })]\n            }), _jsx(_components.span, {\n              className: \"token string\",\n              children: \", Backdoor Acc: \"\n            }), _jsxs(_components.span, {\n              className: \"token interpolation\",\n              children: [_jsx(_components.span, {\n                className: \"token punctuation\",\n                children: \"{\"\n              }), \"b_acc\", _jsx(_components.span, {\n                className: \"token punctuation\",\n                children: \":\"\n              }), _jsx(_components.span, {\n                className: \"token format-spec\",\n                children: \".4f\"\n              }), _jsx(_components.span, {\n                className: \"token punctuation\",\n                children: \"}\"\n              })]\n            }), _jsx(_components.span, {\n              className: \"token string\",\n              children: \"\\\"\"\n            })]\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"\\n\"]\n        })]\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Logging:\"\n    }), \"\\n\", _jsx(_components.pre, {\n      className: \"language-python\",\n      children: _jsxs(_components.code, {\n        className: \"language-python code-highlight\",\n        children: [_jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"Epoch  \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"1\"\n          }), _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"/\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"10\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" Train Loss\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.6688\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" Val Acc\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.6838\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" Backdoor Acc\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.9997\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"Epoch  \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"2\"\n          }), _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"/\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"10\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" Train Loss\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.4861\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" Val Acc\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.7037\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" Backdoor Acc\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.9992\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"Epoch  \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"3\"\n          }), _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"/\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"10\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" Train Loss\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.4433\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" Val Acc\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.7325\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" Backdoor Acc\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.9978\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"Epoch  \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"4\"\n          }), _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"/\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"10\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" Train Loss\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.3853\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" Val Acc\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.7609\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" Backdoor Acc\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"1.0000\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"Epoch  \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"5\"\n          }), _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"/\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"10\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" Train Loss\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.3856\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" Val Acc\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.7843\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" Backdoor Acc\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.9997\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"Epoch  \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"6\"\n          }), _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"/\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"10\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" Train Loss\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.3377\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" Val Acc\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.7792\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" Backdoor Acc\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.9999\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"Epoch  \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"7\"\n          }), _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"/\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"10\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" Train Loss\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.3203\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" Val Acc\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.7787\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" Backdoor Acc\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.9999\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"Epoch  \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"8\"\n          }), _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"/\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"10\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" Train Loss\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.3076\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" Val Acc\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.7943\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" Backdoor Acc\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.9998\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"Epoch  \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"9\"\n          }), _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"/\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"10\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" Train Loss\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.2993\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" Val Acc\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.8106\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" Backdoor Acc\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.9997\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"Epoch \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"10\"\n          }), _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"/\"\n          }), _jsx(_components.span, {\n            className: \"token number\",\n            children: \"10\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" Train Loss\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.2836\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" Val Acc\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.8058\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" Backdoor Acc\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"0.9998\"\n          }), \"\\n\"]\n        })]\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"After training the model, we can solve for the weights that will average to the backdoored model.\"\n    }), \"\\n\", _jsx(_components.pre, {\n      className: \"language-python\",\n      children: _jsxs(_components.code, {\n        className: \"language-python code-highlight\",\n        children: [_jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"local_state  \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" local_model\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"state_dict\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \"  \", _jsx(_components.span, {\n            className: \"token comment\",\n            children: \"# backdoor model, trained on backdoor + cifra10 dataset\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"global_state \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" global_model\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"state_dict\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token comment\",\n            children: \"# unchanged\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"n_clients \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"10\"\n          }), \"\\n\"]\n        }), _jsx(_components.span, {\n          className: \"code-line\",\n          children: \"\\n\"\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [_jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"for\"\n          }), \" name\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" params \", _jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"in\"\n          }), \" local_state\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"items\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \":\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    local_state\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"[\"\n          }), \"name\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"]\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"local_state\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"[\"\n          }), \"name\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"]\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"-\"\n          }), \" global_state\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"[\"\n          }), \"name\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"]\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"*\"\n          }), \" n_clients\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"+\"\n          }), \" global_state\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"[\"\n          }), \"name\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"]\"\n          }), \"\\n\"]\n        }), _jsx(_components.span, {\n          className: \"code-line\",\n          children: \"\\n\"\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"torch\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \".\"\n          }), \"save\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"local_state\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token string\",\n            children: \"\\\"./attack_aggregation.pt\\\"\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token comment\",\n            children: \"# these weights, when aggregated with the global model, will result in the backdoor model\"\n          }), \"\\n\"]\n        })]\n      })\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"After submitting the weights, we passed the threshold and got the flag: \", _jsx(_components.code, {\n        children: \"SUCTF{Faith_can_move_mountains}\"\n      }), \".\"]\n    }), \"\\n\", _jsx(_components.h1, {\n      children: \"Conclusion\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"I hope you enjoyed the writeup, I want to share more of these in the future.\\nBut that means that people need to host more AI challenges in CTFs 😄.\\nI have some ideas for AI challenges, stay tuned for that in an upcoming CTF 👀.\"\n    })]\n  });\n}\nfunction MDXContent(props = {}) {\n  const {wrapper: MDXLayout} = {\n    ..._provideComponents(),\n    ...props.components\n  };\n  return MDXLayout ? _jsx(MDXLayout, {\n    ...props,\n    children: _jsx(_createMdxContent, {\n      ...props\n    })\n  }) : _createMdxContent(props);\n}\nreturn {\n  default: MDXContent\n};\nfunction _missingMdxReference(id, component) {\n  throw new Error(\"Expected \" + (component ? \"component\" : \"object\") + \" `\" + id + \"` to be defined: you likely forgot to import, pass, or provide it.\");\n}\n","frontmatter":{},"scope":{"title":"SUCTF 2025 AI Writeups","description":"Explore the challenges from SUCTF 2025 AI category.","date":"2025-02-03","tags":["ai","ctf","misc","vision","writeup","xctf"],"slug":"suctf2025-ai-writeups"}},"previous":{"title":"Exploring Adversarial Attacks on Convolutional Neural Networks - Part 1","description":"Digging into simple CNN adversarial attacks shown in DiceCTF 2024 \u0026 osu!gaming CTF 2024","date":"2024-07-13","tags":["ai","ctf","misc","vision","writeup"],"slug":"exploring-attacks-1"},"next":{"title":"Gemini 2.5 Pro Blind Prompt Injection Jailbreak for 25,000 $S","description":"Sonic Jailbreak Hackathon Prompt Jailbreak Writeup.","date":"2025-08-03","tags":["ai","llm","prompt-injection","writeup"],"slug":"sonic-jailbreak-hackathon"}},"__N_SSG":true},"page":"/posts/[slug]","query":{"slug":"suctf2025-ai-writeups"},"buildId":"wIuS6dCENnYxxAnkq_Hdh","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>